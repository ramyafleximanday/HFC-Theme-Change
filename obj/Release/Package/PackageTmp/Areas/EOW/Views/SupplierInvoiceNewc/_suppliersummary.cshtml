<script src="~/Scripts/asms/jQuery1.alert.js"></script>
<script type="text/javascript">
    function testDecimals(currentval) {
        var count;
        currentval.match(/\./g) === null ? count = 0 : count = currentval.match(/\./g);
        return count;
    }
    function replaceCommas(yourNumber) {
        var components = yourNumber.toString().split(".");
        if (components.length === 1)
            components[0] = yourNumber;
        components[0] = components[0].replace(/\D/g, "").replace(/(\d)(?=(\d\d)+\d$)/g, "$1,");
        if (components.length === 2)
            components[1] = components[1].replace(/\D/g, "");
        return components.join(".");
    }
    var currentTab = 0;
    $(function () {
        $("#tabs").tabs({
            select: function (e, i) {
                currentTab = i.index;
            }
        });
    });
    $(document).ready(function () {
        $("#txtInvoicedate").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd-mm-yy',
            maxDate: '-id',
            onSelect: function (selected) {
                $("#txtInvoicedate").addClass('valid');
                var resultr = invoicedatecheck($("#txtInvoicedate").val());
            }
        });
    });
    $(function () {
        $('.monthYearPicker').datepicker({
            changeMonth: true,
            changeYear: true,
            showButtonPanel: true,
            maxDate: '-id',
            dateFormat: 'MM-yy'
        }).focus(function () {
            var thisCalendar = $(this);
            $('.ui-datepicker-calendar').detach();
            $('.ui-datepicker-close').click(function () {
                var month = $("#ui-datepicker-div .ui-datepicker-month :selected").val();
                var year = $("#ui-datepicker-div .ui-datepicker-year :selected").val();
                thisCalendar.datepicker('setDate', new Date(year, month, 1));
                $("#txtsermonth").removeClass('required');
                $("#txtsermonth").addClass('valid');
            });
        });
    });
    //$(document).ready(function () {
    //    $("#txtsermonth").datepicker({
    //        changeMonth: true,
    //        changeYear: true,
    //        dateFormat: 'MM-yy',
    //        maxDate: '-id',
    //        onSelect: function (selected) {
    //            $("#txtsermonth").addClass('valid');
    //        }
    //    });
    //});
    $(document).ready(function () {
        $("#txtrelasedate").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd-mm-yy',
            maxDate: '-id',
            maxDate: '+90d',
            onSelect: function (selected) {
                $("#txtrelasedate").addClass('valid');
            }
        });
    });
    function invoicedatecheck(date) {
        if (date.length == 10) {
            var Student =
            {
                "InvoiceDate": date
            };
            $.ajax({
                url: '../SupplierInvoiceNewc/invoicedatevat/',
                data: JSON.stringify(Student),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    if (data == "Deviation") {
                        jAlert("The Invoive Date Greather Than 90 Days Please Atach Deviation Approval Document", "Message");
                        return true;
                    }
                },
                error: function (result) {
                    jAlert("Error.", "Error");
                    return false;
                }
            });
        }
    }
</script>

<div class="table-responsive" id="Invoicenewadd">
    <br />
    <div class="well table-responsive" style="width: 99%;border-color: #43B6F5;border-width: 1px;padding: 0px;">
        <table class="myTableStyleTab" style="width: 99%;">
            <tr>
                <td style="padding-left: 15px;">
                    <span>Invoice Date</span><br />
                    <input class="textboxStyle required" type="text"  id="txtInvoicedate" maxlength="10" placeholder="dd-mm-yyyy" />
                </td>
                <td>
                    <span>Invoice No</span><br />
                    <input class="textboxStyle required" type="text"  id="txtInvoiceno" maxlength="64" />
                </td>
                <td>
                    <span>Service Month</span><br />
                    <input class="textboxStyle required monthYearPicker" type="text"  id="txtsermonth" maxlength="10" placeholder="dd-mm-yyyy" />
                </td>
                <td>
                    <span>Invoice Amount</span><br />
                    <input type="hidden" id="hdinvoiceamt" value="0" />
                    <input class="textboxStyle required" type="text"  id="txtInvoiceamount" onkeypress="return isAmount(event);" onkeyup="compare(this)" maxlength="15" />
                </td>
                <td style="padding-bottom: 10px;width:20%;">
                    <span>Provision Flag</span><br />
                    <input type="radio" name="rblProvisionflg" id="rblYesp" value="Yes" />&nbsp;Yes
                    &nbsp;&nbsp;
                    <input type="radio" name="rblProvisionflg" id="rblNop" value="No">&nbsp;No
                </td>
            </tr>
            <tr>
                <td style="padding-left: 15px;" colspan="4">
                    <span>Invoice Description</span><br />
                    <textarea id="tctInvoicedec" maxlength="125" class="textboxStyle" style="height:30px;resize:none;width:97.6%"></textarea>
                </td>
                <td style="padding-bottom: 10px;">
                    <span>Retention Flag</span><br />
                    <input type="radio" name="rblRetentionflg" id="rblYesr" value="Yes" />&nbsp;Yes
                    &nbsp;&nbsp;
                    <input type="radio" name="rblRetentionflg" id="rblNor" value="No">&nbsp;No
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <table style="width: 100%;">
                        <tr>
                            <td id="Retentionflgg" style="display:none;padding-left: 15px;">
                                <span>Retention %</span><br />
                                <input class="textboxStyle" type="text" id="txtRetentionper" onkeypress="return isAmount(event);" maxlength="5" />
                            </td>
                            <td id="Retentionflgg1" style="display:none">
                                <span>Retention Amount</span><br />
                                <input class="textboxStyle" type="text" id="txtRetentionamount"  onkeypress="return isAmount(event);" maxlength="15" />
                            </td>
                            <td id="Retentionflgg2" style="display:none">
                                <span>Release Date</span><br />
                                <input class="textboxStyle" type="text" id="txtrelasedate"  maxlength="10" placeholder="dd-mm-yyyy" />
                            </td>
                        </tr>
                    </table>
                </td>
                <td></td>
                <td align="right">
                    <button type="button" title="Addinvoice" name="Addinvoice" id="idAddinvoice" class="btn btn-primary" onclick="NewAddinvoice()" style="width: 50%;"> Save </button>
                </td>
            </tr>
        </table>
        <br />
    </div>
    <br />
    <div style="padding:0;margin:0; width:99%">
        <div id="tabs">
            <ul>
                @if (@ViewBag.POStatus == "PO" || @ViewBag.POStatus == "WO")
                {
                    <li><a href="#tabs-4"> Purchase Order </a></li>
                }
                <li><a href="#tabs-1">Tax Details</a></li>
                <li><a href="#tabs-2"> Debit Line </a></li>
                <li><a href="#tabs-3">Payment</a></li>

                <li><a href="#tabs-5">Invoice Attachments</a></li>
            </ul>
            @if (@ViewBag.POStatus == "PO" || @ViewBag.POStatus == "WO")
            {
                <div id="tabs-4">
                    @Html.Partial("_TabPOmapping")
                </div>
            }
            <div id="tabs-1">
                @Html.Partial("_TabTaxDetails")
                <br />
            </div>
            <div id="tabs-2">
                @Html.Partial("_Tabdebitline")
                <br />
            </div>
            <div id="tabs-3">
                @Html.Partial("_SupplierPaymentDetails")
                <br />
            </div>
            <div id="tabs-5">
                @Html.Partial("_TabIAttachments")
                <br />
            </div>

        </div>

    </div>
    <br />
    <div>
        <center>
            <button type="button" id="newinvoiceadds" class="btn btn-success" value="Save" onclick="Newsupplieeinvoicecreate()"><span class="glyphicon glyphicon-ok" style="color:white;font-size: small;"></span> Save</button>
            &nbsp; &nbsp;
            <button type="button" id="newinvoiceaddscal" value="Cancel" class="btn btn-warning" onclick="Newsupplieeinvoicecancel()"><span style="color:white;font-size: small;" class="glyphicon glyphicon-remove-sign"></span> Cancel</button>
        </center>
    </div>
</div>
<div id="summaryhd1" style="padding-right: 10px;">
    @Html.Partial("_supplierGridDetails")
</div>



<script>
    $(document).ready(function () {
        $("#txtRetentionper,#txtInvoiceamount").keyup(function () {

            var curramountexrates = $("#txtInvoiceamount").val();
            var curramounts = $("#txtRetentionper").val();

            if (curramounts != null || curramounts != "" || curramountexrates != null || curramountexrates != "") {

                var tol = $('#txtRetentionper').val() * ($('#txtInvoiceamount').val() / 100);
                $('#txtRetentionamount').val(tol.toFixed(2));
                $("#txtRetentionamount").removeClass('required');
                $("#txtRetentionamount").addClass('valid');
            }
            else {
                $("#txtRetentionamount").removeClass('valid');
                $("#txtRetentionamount").addClass('required');
            }
        });
    });
    $(document).ready(function () {
        $("#Invoicenewadd").hide();
        var doctypeNames = $("#doctypeNames option:selected").text();
        if (doctypeNames == "PO" || doctypeNames == "WO") {
            $("#rblYesr").attr('disabled', false);
            $("#rblNor").attr('disabled', false);
        }
        else {
            $("#rblYesr").attr('disabled', true);
            $("#rblNor").attr('disabled', true);
        }
    });

    $(document).ready(function () {

        var stylesSelect = $('#txtRetentionper');
        stylesSelect.attr('disabled', true);

        var stylesSelect = $('#txtRetentionamount');
        stylesSelect.attr('disabled', true);

        var stylesSelect = $('#txtrelasedate');
        stylesSelect.attr('disabled', true);

        $('input[type=radio][name=rblRetentionflg]').change(function () {

            if (this.value == 'Yes') {
                $("#Retentionflgg").fadeIn();
                $("#Retentionflgg1").fadeIn();
                $("#Retentionflgg2").fadeIn();
                $("#txtRetentionper").val('');
                $("#txtRetentionamount").val('');
                $("#txtrelasedate").val('');

                var stylesSelect = $('#txtRetentionper');
                stylesSelect.attr('disabled', false);

                var stylesSelect = $('#txtRetentionamount');
                stylesSelect.attr('disabled', false);

                var stylesSelect = $('#txtrelasedate');
                stylesSelect.attr('disabled', false);

                $("#txtRetentionper").addClass('required');
                $("#txtRetentionamount").addClass('required');
                $("#txtrelasedate").addClass('required');
            }
            else {
                $("#Retentionflgg").fadeOut();
                $("#Retentionflgg1").fadeOut();
                $("#Retentionflgg2").fadeOut();
                $("#txtRetentionper").val('');
                $("#txtRetentionamount").val('');
                $("#txtrelasedate").val('');

                var stylesSelect = $('#txtRetentionper');
                stylesSelect.attr('disabled', true);

                var stylesSelect = $('#txtRetentionamount');
                stylesSelect.attr('disabled', true);

                var stylesSelect = $('#txtrelasedate');
                stylesSelect.attr('disabled', true);
                $("#txtRetentionper").removeClass('required');
                $("#txtRetentionamount").removeClass('required');
                $("#txtrelasedate").removeClass('required');
                $("#txtRetentionper").removeClass('valid');
                $("#txtRetentionamount").removeClass('valid');
                $("#txtrelasedate").removeClass('valid');
            }
        });
    });
</script>

<script>

    function NewAddinvoice() {

        var doctypeNames = $("#doctypeNames option:selected").text();

        var Invoicedate = $("#txtInvoicedate").val();
        var Invoiceno = $("#txtInvoiceno").val();
        var Invoicedec = $("#tctInvoicedec").val();
        //var Invoiceamount = $("#txtInvoiceamount").val();
        var Invoiceamount = $("#txtInvoiceamount").val().replace(/,/g, "");
        var sermonth = $("#txtsermonth").val();
        var Retentionper = $("#txtRetentionper").val();
        //var Retentionamount = $("#txtRetentionamount").val();
        var Retentionamount = $("#txtRetentionamount").val().replace(/,/g, "");
        var relasedate = $("#txtrelasedate").val();
        var Provision = $("input[name=rblProvisionflg]:checked").val();
        var rodio = $("input[name=rblRetentionflg]:checked").val();


        if (Invoicedate == "" || Invoicedate == null) {
            jAlert("Please Select Invoice Date", "Message");
            return false;
        }
        if (Invoiceno == "" || Invoiceno == null) {
            jAlert("Please Enter Invoice No", "Message");
            return false;
        }
        if (Invoicedec == "" || Invoicedec == null) {
            jAlert("Please Enter Invoice Description", "Message");
            return false;
        }

        if (Invoiceamount == "" || Invoiceamount == null) {
            jAlert("Please Enter Invoice Amount", "Message");
            return false;
        }
        if (sermonth == "" || sermonth == null) {
            jAlert("Please Select Service Month", "Message");
            return false;
        }

        if (rodio == 'undefined' || rodio == null) {
            jAlert("Please Select Retention", "Message");
            return false;
        }

        if (Provision == 'undefined' || Provision == null) {
            jAlert("Please Select Provision", "Message");
            return false;
        }
        if (rodio == "Yes") {
            if (Retentionper == "" || Retentionper == null) {
                jAlert("Please Enter Retention %", "Message");
                return true;
            }
            if (Retentionamount == "" || Retentionamount == null) {
                jAlert("Please Enter Retention Amount", "Message");
                return true;
            }
            if (relasedate == "" || relasedate == null) {
                jAlert(" Please Select Release Date", "Message");
                return true;
            }
        }

        var NewAttmodel = {
            "InvoiceDate": Invoicedate,
            "InvoiceNo": Invoiceno,
            "Description": Invoicedec,
            "Amount": Invoiceamount,
            "SerMonth": Invoicedate,
            "Retensionflg": rodio,
            "Retensionper": Retentionper,
            "Retensionamount": Retentionamount,
            "Retensionrelse": relasedate,
            "potype": doctypeNames,
            "Provision": Provision
        };
        $.post('../SupplierInvoiceNewc/_suppliserinvoiceadd', NewAttmodel,
        function (data) {
            if (data == "Error") {
                jAlert('Error..........', "Message");
                return false;
            }
            else {
                jAlert("Saved Sucessfully", "Message", function (u) {
                    if (u == true) {
                        var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
                        var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
                        var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
                        var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewc")?' + new Date().getTime();

                        $("#wgempposupplier").load(pourl);
                        $("#wgempTaxsupplier").load(taxurl);
                        $("#wgTravelmodeotab2").load(traurl);
                        $("#wgempPaymensupplier").load(payurl);

                        var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
                        $("#wgAttachmentsupplierinv").load(invatturl);

                        var stylesSelect = $('#newinvoiceadds');
                        stylesSelect.attr('disabled', false);
                        var stylesSelect = $('#btndebitlieinvo');
                        stylesSelect.attr('disabled', false);
                        var stylesSelect = $('#btnpaymentinvo');
                        stylesSelect.attr('disabled', false);
                        var stylesSelect = $('#btntaxdinvo');
                        stylesSelect.attr('disabled', false);
                        var stylesSelect = $('#btndebitlieinvoexcel');
                        stylesSelect.attr('disabled', false);
                        var stylesSelect = $('#btntaxdinvopo');
                        stylesSelect.attr('disabled', false);

                        var stylesSelect = $('#btnInvoiceattmt');
                        stylesSelect.attr('disabled', false);

                        var stylesSelect = $('#idAddinvoice');
                        stylesSelect.attr('disabled', false);
                        var stylesSelect = $('#btnempNewExpensddetr');
                        stylesSelect.attr('disabled', true);
                        var stylesSelect = $('#viewlastthree');
                        stylesSelect.attr('disabled', true);

                        var doctypeNames = $("#doctypeNames option:selected").text();
                        if (doctypeNames == "PO" || doctypeNames == "WO") {
                            $("#rblYesr").attr('disabled', false);
                            $("#rblNor").attr('disabled', false);
                            $("#rblYesp").attr('disabled', true);
                            $("#rblNop").attr('disabled', true);
                        }
                        else {
                            $("#rblYesp").attr('disabled', false);
                            $("#rblNop").attr('disabled', false);
                            $("#rblYesr").attr('disabled', true);
                            $("#rblNor").attr('disabled', true);
                            $("#hdinvoiceamt").val('0');
                        }
                    }
                });
            }
        }, 'json');
    }


    function compare(e) {
        //var hdinvoiceamt = $("#hdinvoiceamt").val();
        //var ecfamont = $("#txtecfamont").val();
        //var tolinvoiceamt = $("#suppliertolamt").text();

        //var invoamt = e.value;
        var tolinvoiceamt = $("#suppliertolamt").text().replace(/,/g, "");
        var hdinvoiceamt = $("#hdinvoiceamt").val().replace(/,/g, "");
        var ecfamont = $("#txtecfamont").val().replace(/,/g, "");

        var invoamt = $("#txtInvoiceamount").val().replace(/,/g, "");

        var incuramt = parseFloat(tolinvoiceamt) - parseFloat(hdinvoiceamt);
        var tolecfval = parseFloat(incuramt) + parseFloat(invoamt);
        //var tolecfval = parseFloat(invoamt);

        var val1 = parseFloat(ecfamont);
        var val2 = parseFloat(tolecfval);
        if (parseFloat(val1) < parseFloat(val2)) {
            jAlert("Invoice Total Amount Should Be Equal To ECF Total Amount", "Message");
            $("#txtInvoiceamount").val(invoamt.slice(0, -1))
            return false;
        }
    }
    function Newsupplieeinvoicecancel() {

        $("#summaryhd1").show();
        var Provision = "N";
        var NewAttmodel = {
            "Provision": Provision
        };
        $.post('../SupplierInvoiceNewc/_suppliserinvoiceclear', NewAttmodel,
        function (data) {
            if (data == "Error") {
                alert('Error..........');
                return false;
            }
            else {

                $("#Invoicenewadd").slideToggle(500);
                @*var url = "@(Html.Raw(Url.Action("_supplierGridDetails", "SupplierInvoiceNewc")))";
                $("#wgSuppliersuppliermain").load(url);*@
                var url = '@Url.Action("_supplierGridDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
                $("#wgSuppliersuppliermain").load(url);
                //$("#wgSuppliersuppliermain").load('../SupplierInvoiceNewc/_supplierGridDetails');
                var stylesSelect = $('#btnempNewExpensddetr');
                stylesSelect.attr('disabled', false);
                var stylesSelect = $('#viewlastthree');
                stylesSelect.attr('disabled', false);

                var stylesSelect = $('#btnSubmitfinal');
                stylesSelect.attr('disabled', false);
                var stylesSelect = $('#btnCancelfinal');
                stylesSelect.attr('disabled', false);
            }
        }, 'json');
    }

    function Newsupplieeinvoicecreate() {

        var Invoicedate = $("#txtInvoicedate").val();
        var Invoiceno = $("#txtInvoiceno").val();
        var Invoicedec = $("#tctInvoicedec").val();
        //var Invoiceamount = $("#txtInvoiceamount").val();
        var Invoiceamount = $("#txtInvoiceamount").val().replace(/,/g, "");
        var sermonth = $("#txtsermonth").val();
        var Retentionper = $("#txtRetentionper").val();
        //var Retentionamount = $("#txtRetentionamount").val();
        var Retentionamount = $("#txtRetentionamount").val().replace(/,/g, "");
        var relasedate = $("#txtrelasedate").val();
        var Provision = $("input[name=rblProvisionflg]:checked").val();
        var rodio = $("input[name=rblRetentionflg]:checked").val();

        //var supplierdetlineamt = $("#supplierdetlineamtr").text();
        var supplierdetlineamt = $("#supplierdetlineamtr").text().replace(/,/g, "");
        //var supplierpoamt = $("#supplierpomapamt").text();
        var supplierpoamt = $("#supplierpomapamt").text().replace(/,/g, "");
        //var supplierpaymentd = $("#supplierpaymentd").text();
        var supplierpaymentd = $("#supplierpaymentd").text().replace(/,/g, "");
        //var suppliertaxd = $("#suppliertaxd").text();
        var suppliertaxd = $("#suppliertaxd").text().replace(/,/g, "");
        // alert(suppliertaxd);
        var hdtolattachment = $("#hdtolattachment").val();

        if (Invoicedate == "" || Invoicedate == null) {
            jAlert("Please Select Invoice Date", "Message");
            return false;
        }
        if (Invoiceno == "" || Invoiceno == null) {
            jAlert("Please Enter Invoice No", "Message");
            return false;
        }
        if (Invoicedec == "" || Invoicedec == null) {
            jAlert("Please Enter Invoice Description", "Message");
            return false;
        }

        if (Invoiceamount == "" || Invoiceamount == null) {
            jAlert("Please Enter Invoice Amount", "Message");
            return false;
        }
        if (sermonth == "" || sermonth == null) {
            jAlert("Please Select Service Month", "Message");
            return false;
        }

        if (rodio == 'undefined' || rodio == null) {
            jAlert("Please Select Retention", "Message");
            return false;
        }

        if (Provision == 'undefined' || Provision == null) {
            jAlert("Please Select Provision", "Message");
            return false;
        }
        if (rodio == "Yes") {
            if (Retentionper == "" || Retentionper == null) {
                jAlert("Please Enter Retention %", "Message");
                return true;
            }
            if (Retentionamount == "" || Retentionamount == null) {
                jAlert("Please Enter Retention Amount", "Message");
                return true;
            }
            if (relasedate == "" || relasedate == null) {
                jAlert(" Please Select Release Date", "Message");
                return true;
            }
        }
        var val1 = parseFloat(Invoiceamount);
        var val2 = parseFloat(supplierdetlineamt);
        var val3 = parseFloat(supplierpaymentd);
        var val4 = parseFloat(supplierdetlineamt) + parseFloat(suppliertaxd);
        var val5 = parseFloat(supplierpoamt);

        if (parseFloat(val1) != parseFloat(val2)) {
            jAlert("Please Check DebitLine Details : The DebitLine Total Amount Should Be Equal To Invoice Amount", "Message");
            return false;
        }
        if (parseFloat(val1) != parseFloat(val3)) {
            jAlert("Please Check Payment Details or Tax Details : The Payment Should Be Equal To Invoice Amount", "Message");
            return false;
        }
        var doctypeNames = $("#doctypeNames option:selected").text();
        var hdtolpogridcount = $("#hdtolpogridcount").text();

        if (doctypeNames == "PO" || doctypeNames == "WO") {
            if (hdtolpogridcount == 'undefined' || hdtolpogridcount == null || hdtolpogridcount == '0') {
                jAlert('Please Add PO details ', "Message");
                return false;
            }
            if (supplierpoamt.trim() == "0" || supplierpoamt.trim() == "0.00") {
                jAlert('Please Map PO details ', "Message");
                return false;
            }
        }
        if (hdtolattachment == 'undefined' || hdtolattachment == null) {
            jAlert('Please Attach Atleast one Attachment ', "Message");
            return false;
        }
        //if (doctypeNames == "PO" || doctypeNames == "WO") {
        //    if (parseFloat(val1) != parseFloat(val4)) {
        //        jAlert("Please Check PO Mapped Details : The Total PO Mapped Amount Should Be Equal To Invoice Amount", "Message");
        //        return false;
        //    }
        //}
        var EmpPaymentmodel = { "Amount": Invoiceamount, }
        $.post('../SupplierInvoiceNew/_suppliserinvoicechkppx', EmpPaymentmodel,
      function (data) {
          if (data == "PPX") {
              //jYesNo(result, "Information", function (j) {
              jYesNo("PPX are Available...Do you want add PPX Adjustment?..", "Information", function (u) {
                  if (u == true) {
                      return false;
                  }
                  else {
                      var NewAttmodel = {
                          "InvoiceDate": Invoicedate,
                          "InvoiceNo": Invoiceno,
                          "Description": Invoicedec,
                          "Amount": Invoiceamount,
                          "SerMonth": Invoicedate,
                          "Retensionflg": rodio,
                          "Retensionper": Retentionper,
                          "Retensionamount": Retentionamount,
                          "Retensionrelse": relasedate,
                          "potype": doctypeNames,
                          "TaxableAmount": val5,
                          "Provision": Provision
                      };
                      $.post('../SupplierInvoiceNewc/_suppliserinvoiceCreateb', NewAttmodel,
                      function (data) {
                          if (data == "Debit") {
                              jAlert("Please Check DebitLine Details : The DebitLine Total Amount Should Be Equal To Invoice Amount", "Message");
                              return false;
                          }
                          else if (data == "Payment") {
                              jAlert("Please Check Payment Details or Tax Details : The Payment Should Be Equal To Invoice Amount", "Message");
                              return false;
                          }
                          else if (data == "POAmt") {
                              jAlert("Please Check PO Mapped Details : The Total PO Mapped Amount Should Be Equal To Invoice Amount", "Message");
                              return false;
                          }
                          else if (data == "Error") {
                              jAlert('Error..........', "Message");
                              return false;
                          }
                          else {
                              $("#summaryhd1").show();
                              jAlert("Saved Sucessfully", "Message", function (u) {
                                  if (u == true) {
                                      $("#Invoicenewadd").slideToggle(500);
                                      var url = '@Url.Action("_supplierGridDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
                                      $("#wgSuppliersuppliermain").load(url);
                                      $("#txtRetentionper").val('');
                                      $("#txtRetentionamount").val('');
                                      $("#txtrelasedate").val('');
                                      $("#hdinvoiceamt").val('0');
                                      $("#txtInvoicedate").val('');
                                      $("#txtInvoiceno").val('');
                                      $("#tctInvoicedec").val('');
                                      $("#txtInvoiceamount").val('');
                                      $("#txtsermonth").val('');
                                      $("#Retentionflgg").fadeOut();
                                      $("#Retentionflgg1").fadeOut();
                                      $("#Retentionflgg2").fadeOut();
                                      $("#txtInvoicedate").addClass('required');
                                      $("#txtInvoiceno").addClass('required');
                                      $("#tctInvoicedec").addClass('required');
                                      $("#txtInvoiceamount").addClass('required');
                                      $("#txtsermonth").addClass('required');

                                      var $rblrblRetention = $('input:radio[name=rblRetentionflg]');
                                      $rblrblRetention.filter('[value=Yes]').prop('checked', false);
                                      $rblrblRetention.filter('[value=No]').prop('checked', true);

                                      var stylesSelect = $('#btnempNewExpensddetr');
                                      stylesSelect.attr('disabled', false);
                                      var stylesSelect = $('#viewlastthree');
                                      stylesSelect.attr('disabled', false);

                                      var stylesSelect = $('#btnSubmitfinal');
                                      stylesSelect.attr('disabled', false);
                                      var stylesSelect = $('#btnCancelfinal');
                                      stylesSelect.attr('disabled', false);
                                      //$("#wgSuppliersuppliermain").load('../SupplierInvoiceNewc/_supplierGridDetails');
                                  }
                              });
                          }
                      }, 'json');
                  }
              });
          }
          else {
              var NewAttmodel = {
                  "InvoiceDate": Invoicedate,
                  "InvoiceNo": Invoiceno,
                  "Description": Invoicedec,
                  "Amount": Invoiceamount,
                  "SerMonth": Invoicedate,
                  "Retensionflg": rodio,
                  "Retensionper": Retentionper,
                  "Retensionamount": Retentionamount,
                  "Retensionrelse": relasedate,
                  "potype": doctypeNames,
                  "TaxableAmount": val5,
                  "Provision": Provision
              };
              $.post('../SupplierInvoiceNewc/_suppliserinvoiceCreateb', NewAttmodel,
              function (data) {
                  if (data == "Debit") {
                      jAlert("Please Check DebitLine Details : The DebitLine Total Amount Should Be Equal To Invoice Amount", "Message");
                      return false;
                  }
                  else if (data == "Payment") {
                      jAlert("Please Check Payment Details or Tax Details : The Payment Should Be Equal To Invoice Amount", "Message");
                      return false;
                  }
                  else if (data == "POAmt") {
                      jAlert("Please Check PO Mapped Details : The Total PO Mapped Amount Should Be Equal To Invoice Amount", "Message");
                      return false;
                  }
                  else if (data == "Error") {
                      jAlert('Error..........', "Message");
                      return false;
                  }
                  else {
                      $("#summaryhd1").show();
                      jAlert("Saved Sucessfully", "Message", function (u) {
                          if (u == true) {
                              $("#Invoicenewadd").slideToggle(500);
                              var url = '@Url.Action("_supplierGridDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
                              $("#wgSuppliersuppliermain").load(url);
                              $("#txtRetentionper").val('');
                              $("#txtRetentionamount").val('');
                              $("#txtrelasedate").val('');
                              $("#hdinvoiceamt").val('0');
                              $("#txtInvoicedate").val('');
                              $("#txtInvoiceno").val('');
                              $("#tctInvoicedec").val('');
                              $("#txtInvoiceamount").val('');
                              $("#txtsermonth").val('');
                              $("#Retentionflgg").fadeOut();
                              $("#Retentionflgg1").fadeOut();
                              $("#Retentionflgg2").fadeOut();
                              $("#txtInvoicedate").addClass('required');
                              $("#txtInvoiceno").addClass('required');
                              $("#tctInvoicedec").addClass('required');
                              $("#txtInvoiceamount").addClass('required');
                              $("#txtsermonth").addClass('required');

                              var $rblrblRetention = $('input:radio[name=rblRetentionflg]');
                              $rblrblRetention.filter('[value=Yes]').prop('checked', false);
                              $rblrblRetention.filter('[value=No]').prop('checked', true);

                              var stylesSelect = $('#btnempNewExpensddetr');
                              stylesSelect.attr('disabled', false);
                              var stylesSelect = $('#viewlastthree');
                              stylesSelect.attr('disabled', false);

                              var stylesSelect = $('#btnSubmitfinal');
                              stylesSelect.attr('disabled', false);
                              var stylesSelect = $('#btnCancelfinal');
                              stylesSelect.attr('disabled', false);
                              //$("#wgSuppliersuppliermain").load('../SupplierInvoiceNewc/_supplierGridDetails');
                          }
                      });
                  }
              }, 'json');
          }
      }, 'json');
    }

    function Newsupplieeinvoice() {

        $("#txtRetentionper").val('');
        $("#txtRetentionamount").val('');
        $("#txtrelasedate").val('');
        $("#txtInvoicedate").val('');
        $("#txtInvoiceno").val('');
        $("#tctInvoicedec").val('');
        $("#txtInvoiceamount").val('');
        $("#txtsermonth").val('');
        $("#hdinvoiceamt").val('0');
        $("#txtRetentionper").removeClass('valid');
        $("#txtRetentionamount").removeClass('valid');
        $("#txtrelasedate").removeClass('valid');

        $("#txtInvoicedate").removeClass('valid');
        $("#txtInvoiceno").removeClass('valid');
        $("#tctInvoicedec").removeClass('valid');
        $("#txtInvoiceamount").removeClass('valid');
        $("#txtsermonth").removeClass('valid');

        $("#txtInvoicedate").addClass('required');
        $("#txtInvoiceno").addClass('required');
        $("#tctInvoicedec").addClass('required');
        $("#txtInvoiceamount").addClass('required');
        $("#txtsermonth").addClass('required');

        var stylesSelect = $('#txtRetentionper');
        stylesSelect.attr('disabled', true);

        var stylesSelect = $('#txtRetentionamount');
        stylesSelect.attr('disabled', true);

        var stylesSelect = $('#txtrelasedate');
        stylesSelect.attr('disabled', true);

        var id = "";
        var EmpPaymentmodel = { "Invoicegid": id }
        $.post('../SupplierInvoiceNewc/createSupplierinvoice', EmpPaymentmodel,
      function (data) {
          if (data == 0) { location = location.href; } else {
              $("#Invoicenewadd").slideToggle(500);
              var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
              var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
              var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewc")?' + new Date().getTime();

              var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
              $("#wgempposupplier").load(pourl);

              $("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);

              var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
              $("#wgAttachmentsupplierinv").load(invatturl);

              $("#txtInvoicedate").addClass('required');
              $("#txtInvoiceno").addClass('required');
              $("#tctInvoicedec").addClass('required');
              $("#txtInvoiceamount").addClass('required');
              $("#txtsermonth").addClass('required');

              var $rblProvision = $('input:radio[name=rblProvisionflg]');
              $rblProvision.filter('[value=Yes]').prop('checked', false);
              $rblProvision.filter('[value=No]').prop('checked', true);
              $("#Retentionflgg").fadeOut();
              $("#Retentionflgg1").fadeOut();
              $("#Retentionflgg2").fadeOut();
              var $rblrblRetention = $('input:radio[name=rblRetentionflg]');
              $rblrblRetention.filter('[value=Yes]').prop('checked', false);
              $rblrblRetention.filter('[value=No]').prop('checked', true);


              //var stylesSelect = $('#txtInvoicedate');
              //stylesSelect.attr('disabled', false);
              //var stylesSelect = $('#txtInvoiceno');
              //stylesSelect.attr('disabled', false);
              var stylesSelect = $('#tctInvoicedec');
              stylesSelect.attr('disabled', false);
              //var stylesSelect = $('#txtInvoiceamount');
              //stylesSelect.attr('disabled', false);
              //var stylesSelect = $('#txtsermonth');
              //stylesSelect.attr('disabled', false);

              $("#rblYesp").attr('disabled', false);
              $("#rblNop").attr('disabled', false);
              $("#rblYesr").attr('disabled', false);
              $("#rblNor").attr('disabled', false);

              $("#txtInvoicedate").addClass('required');
              $("#txtInvoiceno").addClass('required');
              $("#tctInvoicedec").addClass('required');
              $("#txtInvoiceamount").addClass('required');
              $("#txtsermonth").addClass('required');

              var stylesSelect = $('#newinvoiceadds');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btndebitlieinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnpaymentinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btntaxdinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btndebitlieinvoexcel');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btntaxdinvopo');
              stylesSelect.attr('disabled', true);

              var stylesSelect = $('#btnInvoiceattmt');
              stylesSelect.attr('disabled', true);

              var stylesSelect = $('#idAddinvoice');
              stylesSelect.attr('disabled', false);

              var stylesSelect = $('#btnempNewExpensddetr');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#viewlastthree');
              stylesSelect.attr('disabled', true);

              var doctypeNames = $("#doctypeNames option:selected").text();
              if (doctypeNames == "PO" || doctypeNames == "WO") {
                  $("#rblYesr").attr('disabled', false);
                  $("#rblNor").attr('disabled', false);
                  $("#rblYesp").attr('disabled', true);
                  $("#rblNop").attr('disabled', true);
              }
              else {
                  $("#rblYesp").attr('disabled', false);
                  $("#rblNop").attr('disabled', false);
                  $("#rblYesr").attr('disabled', true);
                  $("#rblNor").attr('disabled', true);
              }
              var stylesSelect = $('#btnSubmitfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinal');
              stylesSelect.attr('disabled', true);
          }
      }, 'json');
    }
    function SupplierInvoiceEdit(id) {
        $("#summaryhd1").hide();
        var EmpPaymentmodel = {
            "Invoicegid": id,
            "Provision": "Edit"
        }
        $.post('../SupplierInvoiceNewc/ViewSupplierinvoice', EmpPaymentmodel,
      function (data) {
          if (data == 0) { location = location.href; } else {
              $("#Invoicenewadd").slideToggle(500);

              @*var taxurl = "@(Html.Raw(Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewc")))";
              var traurl = "@(Html.Raw(Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewc")))";
              var payurl = "@(Html.Raw(Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewc")))";

              $("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);*@
              var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
              var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
              var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
              var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
              $("#wgempposupplier").load(pourl);

              $("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);

              var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
              $("#wgAttachmentsupplierinv").load(invatturl);

              $("#txtInvoicedate").val(data[0].InvoiceDate);
              $("#txtInvoiceno").val(data[0].InvoiceNo);
              $("#tctInvoicedec").val(data[0].Description);

              var currentval = data[0].Amount;
              var testDecimal = testDecimals(currentval);
              if (testDecimal.length > 1) {
                  currentval = currentval.slice(0, -1);
              }
              var tolnew = replaceCommas(currentval);
              $('#txtInvoiceamount').val(tolnew);

              //$("#txtInvoiceamount").val(data[0].Amount);
              $("#txtsermonth").val(data[0].SerMonth);
              $("#hdinvoiceamt").val(data[0].Amount);
              var txtsermonthnew = $("#txtInvoicedate").val();
              if (txtsermonthnew.trim() != "") {
                  $("#txtsermonth").addClass('valid');
                  getmonth(txtsermonthnew);
              }
              else {
                  $("#txtsermonth").addClass('required');
              }


              var renflg = data[0].Retensionflg;

              $("#txtInvoicedate").addClass('valid');
              $("#txtInvoiceno").addClass('valid');
              $("#tctInvoicedec").addClass('valid');
              $("#txtInvoiceamount").addClass('valid');
              $("#txtsermonth").addClass('valid');

              //var stylesSelect = $('#txtInvoicedate');
              //stylesSelect.attr('disabled', false);
              //var stylesSelect = $('#txtInvoiceno');
              //stylesSelect.attr('disabled', false);
              var stylesSelect = $('#tctInvoicedec');
              stylesSelect.attr('disabled', false);
              //var stylesSelect = $('#txtInvoiceamount');
              //stylesSelect.attr('disabled', false);
              //var stylesSelect = $('#txtsermonth');
              //stylesSelect.attr('disabled', false);

              $("#rblYesp").attr('disabled', false);
              $("#rblNop").attr('disabled', false);
              $("#rblYesr").attr('disabled', false);
              $("#rblNor").attr('disabled', false);

              var $radios = $('input:radio[name=rblRetentionflg]');
              if (renflg == "Y") {
                  $("#Retentionflgg").fadeIn();
                  $("#Retentionflgg1").fadeIn();
                  $("#Retentionflgg2").fadeIn();
                  $radios.filter('[value=Yes]').prop('checked', true);
                  $("#txtRetentionper").val(data[0].Retensionper);
                  //$("#txtRetentionamount").val(data[0].Retensionamount);

                  var currentval = data[0].Retensionamount;
                  var testDecimal = testDecimals(currentval);
                  if (testDecimal.length > 1) {
                      currentval = currentval.slice(0, -1);
                  }
                  var tolnew = replaceCommas(currentval);
                  $('#txtRetentionamount').val(tolnew);

                  $("#txtrelasedate").val(data[0].Retensionrelse);
                  var stylesSelect = $('#txtRetentionper');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#txtRetentionamount');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#txtrelasedate');
                  stylesSelect.attr('disabled', false);
                  $("#txtRetentionper").removeClass('valid');
                  $("#txtRetentionamount").removeClass('valid');
                  $("#txtrelasedate").removeClass('valid');

              }
              else {
                  $radios.filter('[value=No]').prop('checked', true);
                  $("#Retentionflgg").fadeOut();
                  $("#Retentionflgg1").fadeOut();
                  $("#Retentionflgg2").fadeOut();
                  $("#txtRetentionper").val('');
                  $("#txtRetentionamount").val('');
                  $("#txtrelasedate").val('');
                  var stylesSelect = $('#txtRetentionper');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtRetentionamount');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtrelasedate');
                  stylesSelect.attr('disabled', true);
                  $("#txtRetentionper").removeClass('required');
                  $("#txtRetentionamount").removeClass('required');
                  $("#txtRetentionper").removeClass('valid');
                  $("#txtRetentionamount").removeClass('valid');
                  $("#txtrelasedate").removeClass('required');
                  $("#txtrelasedate").removeClass('valid');
              }
              var renflg = data[0].Provision;

              var $rblProvision = $('input:radio[name=rblProvisionflg]');
              if (renflg == "Y") {
                  $rblProvision.filter('[value=Yes]').prop('checked', true);
              }
              else {
                  $rblProvision.filter('[value=No]').prop('checked', true);
              }
              var stylesSelect = $('#newinvoiceadds');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btndebitlieinvo');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btnpaymentinvo');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btntaxdinvo');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btndebitlieinvoexcel');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btntaxdinvopo');
              stylesSelect.attr('disabled', false);

              var stylesSelect = $('#btnInvoiceattmt');
              stylesSelect.attr('disabled', false);

              var stylesSelect = $('#idAddinvoice');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btnempNewExpensddetr');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#viewlastthree');
              stylesSelect.attr('disabled', true);

              var doctypeNames = $("#doctypeNames option:selected").text();
              if (doctypeNames == "PO" || doctypeNames == "WO") {
                  $("#rblYesr").attr('disabled', false);
                  $("#rblNor").attr('disabled', false);
                  $("#rblYesp").attr('disabled', true);
                  $("#rblNop").attr('disabled', true);
              }
              else {
                  $("#rblYesp").attr('disabled', false);
                  $("#rblNop").attr('disabled', false);
                  $("#rblYesr").attr('disabled', true);
                  $("#rblNor").attr('disabled', true);
              }

              var stylesSelect = $('#btnSubmitfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinal');
              stylesSelect.attr('disabled', true);
          }
      }, 'json');
    }

    function getmonth(date) {
        if (date.length == 10) {
            var ddd = isgetmonthyear(date);
            if (ddd == "Error") {
                $("#txtsermonth").val('')
            }
            else {
                $("#txtsermonth").val(ddd)
            }
        }
        else {
            $("#txtsermonth").val('')
        }
    }
    function isgetmonthyear(evt) {
        var retnval;
        var str = evt;
        var array = str.split('-');

        if (array[1] == "01") {
            retnval = "January-" + array[2];
            return retnval;
        }
        if (array[1] == "02") {
            retnval = "February-" + array[2]; return retnval;
        }
        if (array[1].trim() == "03") {
            retnval = "March-" + array[2]; return retnval;
        }
        if (array[1].trim() == "04") {
            retnval = "April-" + array[2]; return retnval;
        }
        if (array[1].trim() == "05") {
            retnval = "May-" + array[2]; return retnval;
        }
        if (array[1].trim() == "06") {
            retnval = "June-" + array[2]; return retnval;
        }
        if (array[1].trim() == "07") {
            retnval = "July-" + array[2]; return retnval;
        }
        if (array[1].trim() == "08") {
            retnval = "August-" + array[2]; return retnval;
        }
        if (array[1].trim() == "09") {
            retnval = "September-" + array[2]; return retnval;
        }
        if (array[1].trim() == "10") {
            retnval = "October-" + array[2]; return retnval;
        }
        if (array[1].trim() == "11") {
            retnval = "November-" + array[2]; return retnval;
        }
        if (array[1].trim() == "12") {
            retnval = "December-" + array[2]; return retnval;
        }
        else {
            retnval = "Error"; return retnval;
        }
        return retnval;
    }
    function SupplierInvoiceViewm(id) {
        $("#summaryhd1").hide();
        var EmpPaymentmodel = {
            "Invoicegid": id,
            "Provision": "View"
        }
        $.post('../SupplierInvoiceNewc/ViewSupplierinvoice', EmpPaymentmodel,
      function (data) {
          if (data == 0) { location = location.href; } else {
              $("#Invoicenewadd").slideToggle(500);
              @*var taxurl = "@(Html.Raw(Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewc")))";
              var traurl = "@(Html.Raw(Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewc")))";
              var payurl = "@(Html.Raw(Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewc")))";

              $("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);*@
              var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
              var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
              var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
              var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewc")?' + new Date().getTime();
              $("#wgempposupplier").load(pourl);

              $("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);

              var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
              $("#wgAttachmentsupplierinv").load(invatturl);

              $("#txtInvoicedate").val(data[0].InvoiceDate);
              $("#txtInvoiceno").val(data[0].InvoiceNo);
              $("#tctInvoicedec").val(data[0].Description);

              var currentval = data[0].Amount;
              var testDecimal = testDecimals(currentval);
              if (testDecimal.length > 1) {
                  currentval = currentval.slice(0, -1);
              }
              var tolnew = replaceCommas(currentval);
              $('#txtInvoiceamount').val(tolnew);

              //$("#txtInvoiceamount").val(data[0].Amount);
              $("#txtsermonth").val(data[0].SerMonth);
              $("#hdinvoiceamt").val(data[0].Amount);
              var txtsermonthnew = $("#txtInvoicedate").val();
              if (txtsermonthnew.trim() != "") {
                  $("#txtsermonth").addClass('valid');
                  getmonth(txtsermonthnew);
              }
              else {
                  $("#txtsermonth").addClass('required');
              }

              $("#txtInvoicedate").addClass('valid');
              $("#txtInvoiceno").addClass('valid');
              $("#tctInvoicedec").addClass('valid');
              $("#txtInvoiceamount").addClass('valid');
              $("#txtsermonth").addClass('valid');

              var renflg = data[0].Retensionflg;
              //var stylesSelect = $('#txtInvoicedate');
              //stylesSelect.attr('disabled', true);
              //var stylesSelect = $('#txtInvoiceno');
              //stylesSelect.attr('disabled', true);
              //var renflg = data[0].Retensionflg;
              var stylesSelect = $('#tctInvoicedec');
              stylesSelect.attr('disabled', true);
              //var stylesSelect = $('#txtInvoiceamount');
              //stylesSelect.attr('disabled', true);
              //var stylesSelect = $('#txtsermonth');
              //stylesSelect.attr('disabled', true);

              //var stylesSelect = $('#rblYes');
              //stylesSelect.attr('disabled', true);
              //var stylesSelect = $('#rblNo');
              //stylesSelect.attr('disabled', true);
              $("#rblYesp").attr('disabled', true);
              $("#rblNop").attr('disabled', true);
              $("#rblYesr").attr('disabled', true);
              $("#rblNor").attr('disabled', true);

              var $radios = $('input:radio[name=rblRetentionflg]');
              if (renflg == "Y") {
                  $radios.filter('[value=Yes]').prop('checked', true);
                  $("#Retentionflgg").fadeIn();
                  $("#Retentionflgg1").fadeIn();
                  $("#Retentionflgg2").fadeIn();
                  $("#txtRetentionper").val(data[0].Retensionper);
                  //$("#txtRetentionamount").val(data[0].Retensionamount);

                  var currentval = data[0].Retensionamount;
                  var testDecimal = testDecimals(currentval);
                  if (testDecimal.length > 1) {
                      currentval = currentval.slice(0, -1);
                  }
                  var tolnew = replaceCommas(currentval);
                  $('#txtRetentionamount').val(tolnew);

                  $("#txtrelasedate").val(data[0].Retensionrelse);
                  var stylesSelect = $('#txtRetentionper');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtRetentionamount');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtrelasedate');
                  stylesSelect.attr('disabled', true);
                  $("#txtRetentionper").removeClass('valid');
                  $("#txtRetentionamount").removeClass('valid');
                  $("#txtrelasedate").removeClass('valid');
              }
              else {
                  $radios.filter('[value=No]').prop('checked', true);
                  $("#Retentionflgg").fadeOut();
                  $("#Retentionflgg1").fadeOut();
                  $("#Retentionflgg2").fadeOut();
                  $("#txtRetentionper").val('');
                  $("#txtRetentionamount").val('');
                  $("#txtrelasedate").val('');
                  var stylesSelect = $('#txtRetentionper');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtRetentionamount');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtrelasedate');
                  stylesSelect.attr('disabled', true);
                  $("#txtRetentionper").removeClass('required');
                  $("#txtRetentionamount").removeClass('required');
                  $("#txtRetentionper").removeClass('valid');
                  $("#txtRetentionamount").removeClass('valid');
                  $("#txtrelasedate").removeClass('required');
                  $("#txtrelasedate").removeClass('valid');
              }
              var renflg = data[0].Provision;

              var $rblProvision = $('input:radio[name=rblProvisionflg]');
              if (renflg == "Y") {
                  $rblProvision.filter('[value=Yes]').prop('checked', true);
              }
              else {
                  $rblProvision.filter('[value=No]').prop('checked', true);
              }
              var stylesSelect = $('#newinvoiceadds');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btndebitlieinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnpaymentinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btntaxdinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btndebitlieinvoexcel');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btntaxdinvopo');
              stylesSelect.attr('disabled', true);

              var stylesSelect = $('#btnInvoiceattmt');
              stylesSelect.attr('disabled', true);

              var stylesSelect = $('#idAddinvoice');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnempNewExpensddetr');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#viewlastthree');
              stylesSelect.attr('disabled', true);

              var stylesSelect = $('#btnSubmitfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinal');
              stylesSelect.attr('disabled', true);
          }
      }, 'json');
    }

    function SupplierInvoiceDeleteMAIN(id) {
        jConfirm("Do you want to delete Invoice...? ", "Message", function (u) {
            if (u == true) {
                var EmpExpensemodel = { "TravelMode_GID": id }
                $.post('../SupplierInvoiceNewc/DeleteSupppersdExpense', EmpExpensemodel,
                function (data) {
                    if (data == 0) { location = location.href; } else {

                        var url = '@Url.Action("_supplierGridDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
                        $("#wgSuppliersuppliermain").load(url);

                        var urlatt = '@Url.Action("_supplierAttachmentDetails", "SupplierInvoiceNewc")?' + new Date().getTime();
                        $("#wgAttachmentsupplier").load(urlatt);
                    }
                }, 'json');
            }
        });
    }
    function Newsupplieeinvoicelast() {
        alert('View Last Three Month Invoice');
    }

    $(document).ready(function () {

        $("#txtInvoicedate").keyup(function () {
            var txtContractFrom = $("#txtInvoicedate").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoicedate").removeClass('required');
                $("#txtInvoicedate").addClass('valid');
            }
            else {
                $("#txtInvoicedate").removeClass('valid');
                $("#txtInvoicedate").addClass('required');
            }
        });
        $("#txtInvoicedate").change(function () {
            var txtContractFrom = $("#txtInvoicedate").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoicedate").removeClass('required');
                $("#txtInvoicedate").addClass('valid');
            }
            else {
                $("#txtInvoicedate").removeClass('valid');
                $("#txtInvoicedate").addClass('required');
            }
        });

        $("#txtInvoiceno").keyup(function () {
            var txtContractFrom = $("#txtInvoiceno").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoiceno").removeClass('required');
                $("#txtInvoiceno").addClass('valid');
            }
            else {
                $("#txtInvoiceno").removeClass('valid');
                $("#txtInvoiceno").addClass('required');
            }
        });
        $("#txtInvoiceno").change(function () {
            var txtContractFrom = $("#txtInvoiceno").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoiceno").removeClass('required');
                $("#txtInvoiceno").addClass('valid');
            }
            else {
                $("#txtInvoiceno").removeClass('valid');
                $("#txtInvoiceno").addClass('required');
            }
        });

        $("#tctInvoicedec").keyup(function () {
            var txtContractFrom = $("#tctInvoicedec").val();
            if (txtContractFrom.trim() != "0") {
                $("#tctInvoicedec").removeClass('required');
                $("#tctInvoicedec").addClass('valid');
            }
            else {
                $("#tctInvoicedec").removeClass('valid');
                $("#tctInvoicedec").addClass('required');
            }
        });
        $("#tctInvoicedec").change(function () {
            var txtContractFrom = $("#tctInvoicedec").val();
            if (txtContractFrom.trim() != "0") {
                $("#tctInvoicedec").removeClass('required');
                $("#tctInvoicedec").addClass('valid');
            }
            else {
                $("#tctInvoicedec").removeClass('valid');
                $("#tctInvoicedec").addClass('required');
            }
        });

        $("#txtInvoiceamount").keyup(function () {
            var txtContractFrom = $("#txtInvoiceamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoiceamount").removeClass('required');
                $("#txtInvoiceamount").addClass('valid');
            }
            else {
                $("#txtInvoiceamount").removeClass('valid');
                $("#txtInvoiceamount").addClass('required');
            }
        });
        $("#txtInvoiceamount").change(function () {
            var txtContractFrom = $("#txtInvoiceamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoiceamount").removeClass('required');
                $("#txtInvoiceamount").addClass('valid');
            }
            else {
                $("#txtInvoiceamount").removeClass('valid');
                $("#txtInvoiceamount").addClass('required');
            }
        });

        $("#txtsermonth").keyup(function () {
            var txtContractFrom = $("#txtsermonth").val();
            if (txtContractFrom.trim() != "") {
                $("#txtsermonth").removeClass('required');
                $("#txtsermonth").addClass('valid');
            }
            else {
                $("#txtsermonth").removeClass('valid');
                $("#txtsermonth").addClass('required');
            }
        });
        $("#txtsermonth").change(function () {
            var txtContractFrom = $("#txtsermonth").val();
            if (txtContractFrom.trim() != "") {
                $("#txtsermonth").removeClass('required');
                $("#txtsermonth").addClass('valid');
            }
            else {
                $("#txtsermonth").removeClass('valid');
                $("#txtsermonth").addClass('required');
            }
        });


        var rodio = $("input[name=rblRetentionflg]:checked").val()
        if (rodio == 'undefined' || rodio == null) {
            $("#txtRetentionper").removeClass('required');
            $("#txtRetentionamount").removeClass('required');
            $("#txtRetentionper").removeClass('valid');
            $("#txtRetentionamount").removeClass('valid');

            $("#txtrelasedate").removeClass('valid');
            $("#txtrelasedate").removeClass('required');
        }
        else if (rodio == "Yes") {
            $("#Retentionflgg").fadeIn();
            $("#Retentionflgg1").fadeIn();
            $("#Retentionflgg2").fadeIn();
            var txtContractFrom = $("#txtRetentionper").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionper").removeClass('required');
                $("#txtRetentionper").addClass('valid');
            }
            else {
                $("#txtRetentionper").removeClass('valid');
                $("#txtRetentionper").addClass('required');
            }
            var txtContractFrom = $("#txtRetentionamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionamount").removeClass('required');
                $("#txtRetentionamount").addClass('valid');
            }
            else {
                $("#txtRetentionamount").removeClass('valid');
                $("#txtRetentionamount").addClass('required');
            }
            var txtContractFrom = $("#txtrelasedate").val();
            if (txtContractFrom.trim() != "") {
                $("#txtrelasedate").removeClass('required');
                $("#txtrelasedate").addClass('valid');
            }
            else {
                $("#txtrelasedate").removeClass('valid');
                $("#txtrelasedate").addClass('required');
            }
        }
        else if (rodio == "No") {
            $("#Retentionflgg").fadeOut();
            $("#Retentionflgg1").fadeOut();
            $("#Retentionflgg2").fadeOut();
            $("#txtRetentionper").removeClass('required');
            $("#txtRetentionamount").removeClass('required');
            $("#txtRetentionper").removeClass('valid');
            $("#txtRetentionamount").removeClass('valid');
            $("#txtrelasedate").removeClass('required');
            $("#txtrelasedate").removeClass('valid');
        }




        $("#txtRetentionper").keyup(function () {
            var txtContractFrom = $("#txtRetentionper").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionper").removeClass('required');
                $("#txtRetentionper").addClass('valid');
            }
            else {
                $("#txtRetentionper").removeClass('valid');
                $("#txtRetentionper").addClass('required');
            }
        });
        $("#txtRetentionper").change(function () {
            var txtContractFrom = $("#txtRetentionper").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionper").removeClass('required');
                $("#txtRetentionper").addClass('valid');
            }
            else {
                $("#txtRetentionper").removeClass('valid');
                $("#txtRetentionper").addClass('required');
            }
        });

        $("#txtRetentionamount").keyup(function () {
            var txtContractFrom = $("#txtRetentionamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionamount").removeClass('required');
                $("#txtRetentionamount").addClass('valid');
            }
            else {
                $("#txtRetentionamount").removeClass('valid');
                $("#txtRetentionamount").addClass('required');
            }
        });
        $("#txtRetentionamount").change(function () {
            var txtContractFrom = $("#txtRetentionamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionamount").removeClass('required');
                $("#txtRetentionamount").addClass('valid');
            }
            else {
                $("#txtRetentionamount").removeClass('valid');
                $("#txtRetentionamount").addClass('required');
            }
        });
        $("#txtrelasedate").keyup(function () {
            var txtContractFrom = $("#txtrelasedate").val();
            if (txtContractFrom.trim() != "") {
                $("#txtrelasedate").removeClass('required');
                $("#txtrelasedate").addClass('valid');
            }
            else {
                $("#txtrelasedate").removeClass('valid');
                $("#txtrelasedate").addClass('required');
            }
        });
        $("#txtrelasedate").change(function () {
            var txtContractFrom = $("#txtRetentionamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtrelasedate").removeClass('required');
                $("#txtrelasedate").addClass('valid');
            }
            else {
                $("#txtrelasedate").removeClass('valid');
                $("#txtrelasedate").addClass('required');
            }
        });

    });
</script>