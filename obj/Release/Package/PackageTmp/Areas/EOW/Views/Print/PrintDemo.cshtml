@model  IEM.Areas.EOW.Models.printdatamodel
@using IEM.Areas.EOW.Models
@{
    printdatamodel sh = (printdatamodel)Session["data"];
    ViewBag.Title = "PrintDemo";
    Layout = null;

    var base64 = Convert.ToBase64String(sh.Ecf_nobarcode);
    var imgSrc = String.Format("data:image/gif;base64,{0}", base64);
}

<link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<link href="~/Content/bootstrap.css" rel="stylesheet" />
<link href="~/Content/jquery.dataTables.min.css" rel="stylesheet" />
<script src="~/Scripts/angular.min.js"></script>
<script src="~/Scripts/asms/ui-bootstrap-tpls-0.11.0.js"></script>
<div ng-app="ECFapp1">
    <table align="center" style="font-size: 12px;width:95%" cellspacing="0" border="0">
        <tbody>
            <tr><td colspan="10"><br /></td></tr>
            <tr>
                <td bgcolor="#C6D9F1" colspan="6" align="center" rowspan="2" height="44"><b><font size="2">EXPENSE CLAIM FORM / ASSET CAPITALISATION FORM</font></b></td>
                <td bgcolor="#C6D9F1" align="right" colspan="4" rowspan="2">
                    <img src="~/Content/images/Fullerton.bmp" width="300" height="60" hspace="2" vspace="2">
                </td>
            </tr>
            <tr>
                <td colspan="10"><br /></td>
            </tr>
            <tr>
                <td colspan="3" rowspan="6" valign="middle" align="center" height="120">
                    <div align="center">
                        <font size="4.5">
                            <b>
                                @sh.Ecf_No
                            </b>
                        </font>
                        <br>
                        <div>
                            <div style="width: 270px;padding-left: 3px;padding-top: 6px;padding-bottom: 0px;border: 1px solid;border-radius: 1px;">
                                <img src="@imgSrc" width="250" height="55" />
                                <br />
                                <font size="2">
                                    <b> @sh.Ecf_No </b>
                                </font>
                            </div>
                        </div>
                    </div>
                </td>
                <td valign="top" style="padding-top:10px;"><font> Employee ID </font></td>
                <td valign="top" colspan="2" style="padding-top:10px;" align="left"><font>@sh.EmployeeId</font></td>
                <td valign="top" style="padding-top:10px;"><font> Invoice Type </font></td>
                <td valign="top" style="padding-top:10px;"><font> @sh.Invoice_type </font></td>
                <td align="right" style="padding-top:10px;" colspan="2" rowspan="2"><b><font size="2">@sh.Ecf_Date</font></b></td>
            </tr>
            <tr>
                <td valign="top"><font> Name </font></td>
                <td colspan="2"><font>@sh.EmployeeName</font></td>
                <td valign="top"><font> Expense Type </font></td>
                <td valign="top"><font>@sh.Expense_type</font></td>
            </tr>
            <tr>
                <td valign="top"><font> Title </font></td>
                <td valign="top" colspan="2"><font>@sh.Title</font></td>
                <td valign="top"><font> Amort </font></td>
                <td valign="top"><font>@sh.Ecf_Amort</font></td>
                <td align="right" colspan="2" rowspan="4"><b><font size="2">@sh.Ecf_Amount</font></b></td>
            </tr>
            <tr>
                <td valign="top"><font> Department </font></td>
                <td valign="top" colspan="2"><font>@sh.Department</font></td>
                <td valign="top"><font> For Ex </font></td>
                <td valign="top"><font>@sh.Ecf_forex</font></td>
            </tr>
            <tr>
                <td valign="top"><font> Location Code </font></td>
                <td valign="top" colspan="2"><font>@sh.LocationCode</font></td>
                <td valign="top"><font> Utility </font></td>
                <td valign="top"><font>@sh.Ecf_Utility</font></td>
            </tr>
            <tr>
                <td style="padding-bottom:10px;" valign="top"><font> PO / WO No. </font></td>
                <td style="padding-bottom:10px;" colspan="2" valign="top"><font>@sh.Invoice_powono</font></td>
                <td style="padding-bottom:10px;" valign="top"><font> Payment Adjst </font></td>
                <td style="padding-bottom:10px;" valign="top"><font>@sh.Ecf_PaymentAdjst</font></td>
            </tr>
            <tr>
                <td align="center" colspan="10" bgcolor="#C6D9F1"><b><font>Invoice Details</font></b></td>
            </tr>
            <tr>
                <td colspan="10">
                    <font>
                        @Html.Partial("Invoicedetails")
                    </font>
                </td>
            </tr>
            <tr>
                <td colspan="10"><br /></td>
            </tr>
            <tr>
                <td align="center" colspan="10" bgcolor="#C6D9F1"><b><font>Expense / Asset Details</font></b></td>
            </tr>
            <tr>
                <td colspan="10">
                    <font>
                        @Html.Partial("Assetdetails")
                    </font>
                </td>
            </tr>
            <tr>
                <td colspan="10"><br /></td>
            </tr>
            <tr>
                <td align="center" colspan="10" bgcolor="#C6D9F1"><b><font>Payment Details</font></b></td>
            </tr>
            <tr>
                <td colspan="10">
                    <font>
                        @Html.Partial("PaymentDetails")
                    </font>
                </td>
            </tr>
            <tr>
                <td colspan="10"><br /></td>
            </tr>
            <tr>
                <td colspan="5"><b><font>Amount in Words</font></b></td>
                <td colspan="5"><b><font>ECF / ACF Description</font></b></td>
            </tr>
            <tr>
                <td style="padding-bottom:10px;" colspan="5"><font>@sh.Ecf_Amountinword</font></td>
                <td style="padding-bottom:10px;" colspan="5"><font>@sh.Ecf_dcsc</font></td>
            </tr>
            <tr>
                <td align="center" colspan="10" height="20" bgcolor="#C6D9F1"><b><font>Declaration <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> </font></b></td>
            </tr>
            <tr>
                <td colspan="4" valign="top"><font>Raiser Declaration<br>I confirm that I have incurred the expenditure wholly and exclusively for business purposes only</font></td>
                <td></td>
                <td colspan="5" valign="top"><font>Verifier Declaration<br>I have verified the expense claim and Approve in the basis this is incurred wholly and exclusively for Business Purposes</font></td>
            </tr>
            <tr>
                <td colspan="10"><br /></td>
            </tr>
            <tr>
                <td align="center" colspan="10" bgcolor="#C6D9F1"><b><font>Signatures<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> </font></b></td>
            </tr>
            <tr>
                <td colspan="4" valign="bottom"><font> </font></td>
                <td colspan="2" align="center"><font><br />EPU Authentication<br></font></td>
                <td colspan="4" valign="bottom"><font></font></td>
            </tr>
            <tr>
                <td colspan="3" align="left" valign="bottom"><font><br />Emp ID &amp; Emp Name </font></td>
                <td colspan="1"><font><br />Maker ID </font></td>
                <td colspan="2"></td>
                <td colspan="1"><font><br /> Authoriser ID</font></td>
                <td></td>
                <td colspan="2" align="right" valign="bottom"><font><br />Verifier ID &amp; Name</font></td>
            </tr>
            <tr>
                <td colspan="10"><br /><br /></td>
            </tr>
            <tr>
                <td colspan="10"><b><i><font color="#FF0000">* This is an electronically generated form and does not require signature. The IDs mentioned there in tantamounts to signature of the relevant employees</font></i></b></td>
            </tr>
            <tr>
                <td colspan="10" align="center">
                    <br />
                    <input type="button" value="  Print  " onclick="getviewsupplier()" id="btnPrint" class="glyphicon glyphicon-print" />
                </td>
            </tr>
            <tr>
                <td colspan="10">
                    <br /><br />
                </td>
            </tr>

        </tbody>
    </table>
</div>
<script type="text/javascript">
    function getviewsupplier() {
        var url = '@Url.Action("index", "print")?' + new Date().getTime();
        window.open(url, 'Page', 'scrollbars=1,height=800,width=1200');
    }
    var myApp = angular.module('ECFapp1', ['ui.bootstrap']);
    myApp.filter('startFrom', function () {
        return function (input, start) {
            if (input) {
                start = +start;
                return input.slice(start);
            }
            return [];
        };
    });

    myApp.service("ecfService", function ($http) {
        this.getECFDetailsList = function () {
            return $http.get("../Print/ToGetInvoicedetails?" + new Date().getTime());
        };
        this.getECFDetailsLista = function () {
            return $http.get("../Print/ToGetdebitlinedeails?" + new Date().getTime());
        };
        this.getECFDetailsListctchkr = function () {
            return $http.get("../Print/ToGetpaymentdeails?" + new Date().getTime());
        };
    });
    myApp.controller('ecfController', function ($scope, ecfService) {
        GetECFDetails();
        function GetECFDetails() {
            var getData = ecfService.getECFDetailsList();
            getData.then(function (emp) {
                $scope.ecfdetails = emp.data;
                $scope.getTotal = function () {
                    var total = 0;
                    for (var i = 0; i < $scope.ecfdetails.length; i++) {
                        var ecfdetailst = $scope.ecfdetails[i];
                        total = parseFloat(total) + parseFloat(ecfdetailst.Amount);
                    }
                    return total.toFixed(2);
                }

            }, function () {
                alert('Error');
            });
        }

        GetECFDetailsa();
        function GetECFDetailsa() {
            var getDataa = ecfService.getECFDetailsLista();
            getDataa.then(function (emp) {
                $scope.ecfdetailsa = emp.data;

                $scope.getTotala = function () {
                    var total = 0;
                    for (var i = 0; i < $scope.ecfdetailsa.length; i++) {
                        var ecfdetailst = $scope.ecfdetailsa[i];
                        total = parseFloat(total) + parseFloat(ecfdetailst.Amount);
                    }
                    return total.toFixed(2);
                }

            }, function () {
                alert('Error');
            });
        }

        GetECFDetailsctchkr();
        function GetECFDetailsctchkr() {
            var getDatactchkt = ecfService.getECFDetailsListctchkr();
            getDatactchkt.then(function (emp) {
                $scope.ecfdetailsctchkr = emp.data;
                $scope.getTotalchkr = function () {
                    var total = 0;
                    for (var i = 0; i < $scope.ecfdetailsctchkr.length; i++) {
                        var ecfdetailst = $scope.ecfdetailsctchkr[i];
                        total = parseFloat(total) + parseFloat(ecfdetailst.PaymentAmount);
                    }
                    return total.toFixed(2);
                }

            }, function () {
                alert('Error');
            });
        }
    });
</script>

