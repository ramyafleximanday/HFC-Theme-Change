@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/Rmax_Site.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.24.min.js")" type="text/javascript"></script>
<style>
    table, th, td {
        white-space: nowrap;
    }
</style>

<script type="text/javascript">
    var _currDTTab = 0;
    $(function () {
        $("#DTtabs").tabs({
            select: function (e, i) {
                _currDTTab = i.index;
            }
        });
    });
</script> 
<div class="pageHeadingLayout">
    <span class="pageHeading">Reports</span>
</div>
<div class="well">
    <div id="DTtabs" style="height:500px; font-size:12px;">
        <ul>
            <li><a style="font-size: 11px;" href="#tabs-1">Local Conveyance</a></li> 
            <li><a style="font-size: 11px;" href="#tabs-2">Invoice Report</a></li>
            <li><a style="font-size: 11px;" href="#tabs-3">MSME Report</a></li>
        </ul>
        <div id="tabs-1">
            <table class="myTableStyleTabNew" style="width:100%;">
                <tr>
                    <td width="20%" style="padding: 0px 10px 0px 3px;">
                        <span>Date From </span>
                        <br />
                        <input type="text"
                               id="txtDateFrom"
                               onkeypress="return isEvent(event)"
                               class="fstextbox fsDatePicker glEntry required" />
                    </td>
                    <td width="20%" style="padding: 0px 10px">
                        <span>Date To </span>
                        <br />
                        <input type="text"
                               id="txtDateTo"
                               onkeypress="return isEvent(event)"
                               class="fstextbox fsDatePicker glEntry required" />
                    </td>
                    <td style="width:40%; padding:0px; vertical-align:bottom;">

                        <button class="btn btn-primary" accesskey="e" type="button" style="margin-top:10px;  color:white;" data-bind="click: function() { $root.DownloadLocalConveyanceDateWise(); }, visible: LocalConveyanceArray().length > 0">
                            <span style="color:white;" class="glyphicon glyphicon-download-alt"></span>
                            Export Excel
                        </button>

                        <button class="btn btn-primary" accesskey="q" id="btnsearch" type="button" data-bind="click: $root.Search" style="margin-top:10px;  color:white;">
                            <span style="color:white;" class="glyphicon glyphicon-search"></span>
                            Search
                        </button>
                        <button class="btn btn-primary" accesskey="c" data-bind="click: $root.Clear" type="button" style="margin-top:10px;  color:white;">
                            <span style="color:white;" class="glyphicon glyphicon-refresh"></span>
                            Clear
                        </button>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <div id="loadingImg" style="display:none;" class="pageHeading">
                            Please Wait...
                        </div>
                    </td>
                </tr>
            </table>
            <div class="table-responsive" style="margin-top: 15px;">
                <table class="tableSmall table-bordered table-hover" data-bind="visible: LocalConveyanceArray().length > 0">
                    <thead>
                        <tr data-bind="foreach: columnNames">
                            <th style="min-width:80px; " class="nosort">
                                <span data-bind="text: $data"></span>
                            </th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: LocalConveyanceArray, visible: LocalConveyanceArray().length > 0">
                        <tr data-bind="foreach: $parent.columnNames">
                            <td style="padding:5px;">
                                <span data-bind="text: $parent[$data]"></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div id="tabs-2">
            <table class="myTableStyleTabQuery" style="width:100%;">
                <tr>
                    <td width="20%" style="padding: 0px 10px 0px 3px;">
                        <span>Date From </span>
                        <br />
                        <input type="text"
                               id="txtDateFromQ"
                               onkeypress="return isEvent(event)"
                               class="fstextbox fsDatePicker glQEntry required" />
                    </td>
                    <td width="20%" style="padding: 0px 10px">
                        <span>Date To </span>
                        <br />
                        <input type="text"
                               id="txtDateToQ"
                               onkeypress="return isEvent(event)"
                               class="fstextbox fsDatePicker glQEntry required" />
                    </td>
                    <td style="width:40%; padding:0px; vertical-align:bottom;">

                        <button class="btn btn-primary" accesskey="e" type="button" style="margin-top:10px;  color:white;" data-bind="click: function() { $root.DownloadQueryInvoiceDateWise(); }, visible: QueryInvoiceArray().length > 0">
                            <span style="color:white;" class="glyphicon glyphicon-download-alt"></span>
                            Export Excel
                        </button>

                        <button class="btn btn-primary" accesskey="q" id="btnsearchQ" type="button" data-bind="click: $root.SearchQuery" style="margin-top:10px;  color:white;">
                            <span style="color:white;" class="glyphicon glyphicon-search"></span>
                            Search
                        </button>
                        <button class="btn btn-primary" accesskey="c" data-bind="click: $root.ClearQ" type="button" style="margin-top:10px;  color:white;">
                            <span style="color:white;" class="glyphicon glyphicon-refresh"></span>
                            Clear
                        </button>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <div id="loadingImg" style="display:none;" class="pageHeading">
                            Please Wait...
                        </div>
                    </td>
                </tr>
            </table>
            <div class="table-responsive" style="margin-top: 15px;">
                <table class="tableSmall table-bordered table-hover" data-bind="visible: QueryInvoiceArray().length > 0">
                    <thead>
                        <tr data-bind="foreach: columnNamesQ">
                            <th style="min-width:80px; " class="nosort">
                                <span data-bind="text: $data"></span>
                            </th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: QueryInvoiceArray, visible: QueryInvoiceArray().length > 0">
                        <tr data-bind="foreach: $parent.columnNamesQ">
                            <td style="padding:5px;">
                                <span data-bind="text: $parent[$data]"></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div id="tabs-3">
            <table class="myTableStyleTabMSME" style="width:100%;">
                <tr>
                    <td width="20%" style="padding: 0px 10px 0px 3px;">
                        <span>Date From </span>
                        <br />
                        <input type="text"
                               id="txtDateFromM"
                               onkeypress="return isEvent(event)"
                               class="fstextbox fsDatePicker glMEntry required" />
                    </td>
                    <td width="20%" style="padding: 0px 10px">
                        <span>Date To </span>
                        <br />
                        <input type="text"
                               id="txtDateToM"
                               onkeypress="return isEvent(event)"
                               class="fstextbox fsDatePicker glMEntry required" />
                    </td>
                    <td style="width:40%; padding:0px; vertical-align:bottom;">

                        <button class="btn btn-primary" accesskey="e" type="button" style="margin-top:10px;  color:white;" data-bind="click: function() { $root.DownloadMSMEReportDateWise(); }, visible: MSMEReportArray().length > 0">
                            <span style="color:white;" class="glyphicon glyphicon-download-alt"></span>
                            Export Excel
                        </button>

                        <button class="btn btn-primary" accesskey="q" id="btnsearchM" type="button" data-bind="click: $root.SearchM" style="margin-top:10px;  color:white;">
                            <span style="color:white;" class="glyphicon glyphicon-search"></span>
                            Search
                        </button>
                        <button class="btn btn-primary" accesskey="c" data-bind="click: $root.ClearM" type="button" style="margin-top:10px;  color:white;">
                            <span style="color:white;" class="glyphicon glyphicon-refresh"></span>
                            Clear
                        </button>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <div id="loadingImg" style="display:none;" class="pageHeading">
                            Please Wait...
                        </div>
                    </td>
                </tr>
            </table>
            @*<div class="table-responsive" style="margin-top: 15px;">
                <table class="tableSmall table-bordered table-hover" data-bind="visible: MSMEReportArray().length > 0">
                    <thead>
                        <tr data-bind="foreach: columnNamesM">
                            <th style="min-width:80px; " class="nosort">
                                <span data-bind="text: $data"></span>
                            </th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: MSMEReportArray, visible: MSMEReportArray().length > 0">
                        <tr data-bind="foreach: $parent.columnNamesM">
                            <td style="padding:5px;">
                                <span data-bind="text: $parent[$data]"></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>*@
            <div class="table-responsive" style="margin-top: 15px;">
                <table id="gMsmeReport" class="tableSmall table-bordered table-hover" data-bind="visible: MSMEReportArray().length > 0">
                    <thead>
                        <tr>
                            <th align="center" style="padding-right:20px;">
                                Sl No
                            </th>
                            <th style="padding-right:20px;">
                                Raiser ID
                            </th>
                            <th style="padding-right:20px;">
                                Raiser Name
                            </th>
                            <th style="padding-right:20px;">
                                Raiser Department
                            </th>
                            <th style="padding-right:20px;">
                                Vendor Code
                            </th>
                            <th style="padding-right:20px;">
                                Vendor Name
                            </th>
                            <th style="padding-right:20px;">
                                Invoice No
                            </th>
                            <th style="padding-right:20px;">
                                ECF Status
                            </th>
                            <th style="padding-right:20px;">
                                Invoice Date
                            </th>
                            <th style="padding-right:20px;">
                                Invoice Receipt Date
                            </th>
                            <th style="padding-right:20px;">
                                Invoice Amount
                          </th>
                            <th style="padding-right:20px;">
                                ECF Raised Date
                            </th>
                            <th style="padding-right:20px;">
                                ECF Approval Date
                            </th>
                            <th style="padding-right:20px;">
                                Reason of Delay
                            </th>
                            <th style="padding-right:20px;">
                                Payment Date
                            </th>
                            <th style="padding-right:20px;">
                                Functional Head Approver name
                            </th>
                            <th style="padding-right:20px;">
                                Functional Head Approver Id
                            </th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach:{ data: MSMEReportArray, afterRender: DatatableMSMEReport }, visible: MSMEReportArray().length > 0">
                        <tr>
                            <td align="center">
                                <span data-bind="text:$index()+1"></span>
                            </td>
                            <td>
                                <span data-bind="text:RaiserID"></span>
                            </td>
                            <td>
                                <span data-bind="text: RaiserName"></span>
                            </td>
                            <td>
                                <span data-bind="text: RaiserDepartment"></span>
                            </td>
                            <td align="left">
                                <span data-bind="text: VendorCode"></span>
                            </td>
                            <td>
                                <span data-bind="text: VendorName"></span>
                            </td>
                            <td>
                                <span data-bind="text: InvoiceNo"></span>
                            </td>
                            <td>
                                <span data-bind="text: ecfstatus_name"></span>
                            </td>
                            <td>
                                <span data-bind="text: InvoiceDate"></span>
                            </td>
                            <td>
                                <span data-bind="text: InvoiceReceiptDate"></span>
                            </td>

                            <td align="right">
                                <span data-bind="text: InvoiceAmount"></span>
                            </td>
                            <td>
                                <span data-bind="text: ECFRaisedDate"></span>
                            </td>
                            <td>
                                <span data-bind="text: ECFApprovalDate"></span>
                            </td>
                            <td>
                                <span data-bind="text: ReasonofDelay"></span>
                            </td>
                            <td>
                                <span data-bind="text: PaymentDate"></span>
                            </td>
                            <td>
                                <span data-bind="text: FunctionalHeadApproverName"></span>
                            </td>
                            <td>
                                <span data-bind="text: FunctionalHeadApproverId"></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script>
    var UrlDet = "@Url.Action("GetLocalConveyanceDateWaise", "Reports")"
    var UrlQuery = "@Url.Action("GetQueryInvoiceDateWaise", "Reports")"
    var UrlMsme = "@Url.Action("GetMSMEReportDateWaise", "Reports")"
    
    $(document).ready(function () {
        debugger;
        $(".fsDatePicker").datepicker({
            yearRange: '1900:+nn',
            changeMonth: true,
            changeYear: true,
            maxDate: 'd',
            dateFormat: 'dd/mm/yy'
        });

        $(".fsDatePicker").keyup(function (e) {
            if (e.keyCode == 8 || e.keyCode == 46)
                $.datepicker._clearDate(this);

            $(this).datepicker('show');
        });

        //Date Wise Local Conveyance
        $('.glEntry').change(function () {
            IsValidSubmit();
            var _data = $(this).val();
            var trigerName = $(this).attr('id');
            if (_data.trim() != "") {
                $("#" + trigerName).removeClass('required').removeClass('valid');
                $("#" + trigerName).addClass('valid');
            }
            else {
                $("#" + trigerName).removeClass('valid').removeClass('required');
                $("#" + trigerName).addClass('required');
            }
        });

        $('.glQEntry').change(function () {
            debugger;
            IsValidSubmitQ();
            var _data = $(this).val();
            var trigerName = $(this).attr('id');
            if (_data.trim() != "") {
                $("#" + trigerName).removeClass('required').removeClass('valid');
                $("#" + trigerName).addClass('valid');
            }
            else {
                $("#" + trigerName).removeClass('valid').removeClass('required');
                $("#" + trigerName).addClass('required');
            }
        });
        $('.glMEntry').change(function () {
            debugger;
            IsValidSubmitM();
            var _data = $(this).val();
            var trigerName = $(this).attr('id');
            if (_data.trim() != "") {
                $("#" + trigerName).removeClass('required').removeClass('valid');
                $("#" + trigerName).addClass('valid');
            }
            else {
                $("#" + trigerName).removeClass('valid').removeClass('required');
                $("#" + trigerName).addClass('required');
            }
        });
        IsValidSubmitM();
        IsValidSubmitQ();
        IsValidSubmit();
      
    });


    function IsValidSubmit() {
        var _glFrom = $("#txtDateFrom").val();
        var _glTo = $("#txtDateTo").val();
        //var _glac = $("#ddlActivity").val();

        if (_glFrom.trim() == "" || _glTo.trim() == "" /*|| _glac == "" || _glac == "0"*/) {
            $('#btnsearch').attr('disabled', true);
        }
        else {
            $('#btnsearch').attr('disabled', false); 
        }
    }

    function IsValidSubmitQ() {
        debugger;
        var _glFrom = $("#txtDateFromQ").val();
        var _glTo = $("#txtDateToQ").val();  
        if (_glFrom.trim() == "" || _glTo.trim() == "" /*|| _glac == "" || _glac == "0"*/) {
            $('#btnsearchQ').attr('disabled', true); 
        }
        else { 
            $('#btnsearchQ').attr('disabled', false);
        }
    }
    function IsValidSubmitM() {
        debugger;
        var _glFrom = $("#txtDateFromM").val();
        var _glTo = $("#txtDateToM").val();
        if (_glFrom.trim() == "" || _glTo.trim() == "" /*|| _glac == "" || _glac == "0"*/) {
            $('#btnsearchM').attr('disabled', true);
        }
        else {
            $('#btnsearchM').attr('disabled', false);
        }
    }
    function isEvent(evt) {
        return false;
    }
</script>
 

<script src="@Url.Content("~/Areas/EOW/EOW_Userscript/jsLocalConveyanceReport.js")" type="text/javascript"></script>