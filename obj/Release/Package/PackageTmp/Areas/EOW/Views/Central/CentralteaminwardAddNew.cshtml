@model IEM.Areas.EOW.Models.CentraldataModel
<script src="~/Scripts/asms/jQuery1.alert.js"></script>
@using IEM.Areas.EOW.Models
@{
    //CentraldataModel sh = (CentraldataModel)ViewBag.CentralCurrency;
}

<div id="CentralInwardScreen">
    @using (Html.BeginForm())
    {
        <table class="myTableStyleTabNew" style="width:100%;">
            <tr>
                <td style="width:15%;">
                    <span>Received Date </span>
                    <br />
                    <input type="text"
                           id="RecivedDate"
                           name="txtRecivedDateFrom"
                           value="@ViewBag.filter"
                           onchange="checkdate()" maxlength="10"
                           class="textboxStyle required" /> @*//Length Fixed by selva*@

                    </td>

                    <td style="width:15%;">
                        <span>Raiser Code</span>
                        <br />
                        <input type="text"
                               name="txtraisercode"
                               id="raisercode"
                               value="@ViewBag.txtraisercode"
                               class="textboxStyle required"
                               readonly="readonly" />
                    </td>
                    <td>
                        <a title="Search"><span class="glyphicon glyphicon-search" style="margin:27px 0px 0px 0px;" onclick="EmployeeSearch11()"></span></a>
                        @*<a title="Search" ng-click="open('lg')"><span class="glyphicon glyphicon-search" id="Searchicon"></span></a>*@
                    </td>
                    <td style="width:33%;">
                        <span> Raiser Name</span>
                        <br />
                        <input type="text"
                               name="txtraisername"
                               id="raisername"
                               value="@ViewBag.txtraisername"
                               readonly="readonly"
                               class="textboxStyle required " />

                        <input type="hidden"
                               name="EmployeeId"
                               id="EmployeeId"
                               value="@ViewBag.EmployeeId" />
                    </td>

                    <td colspan="2">
                        <span>Raiser Department</span>
                        <br />
                        <input type="text"
                               name="EmployeeId"
                               id="EmployeeDept"
                               value="@ViewBag.EmployeeDepartment"
                               class="textboxStyle"
                               readonly="readonly" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <span> Supplier Type</span>
                        @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.SupplierType, "---Select---", new { @class = "textboxStyle required", @style = "display: block;margin-top: 4px;", @id = "SupplierIdCinward", @Name = "SupplierType", @onchange = "suppliertype()" })
                    </td>
                    <td>
                        <span> Supplier Code</span>
                        <br />
                        <input type="text"
                               name="txtsuppliercode"
                               id="suppliercode"
                               value="@ViewBag.filter_name"
                               class="textboxStyle"
                               readonly="readonly" />
                        <input type="hidden"
                               name="txtsupplierId"
                               id="supplierId"
                               value="@ViewBag.txtsupplierId" />
                    </td>
                    <td>
                        <a title="Search"><span class="glyphicon glyphicon-search" style="margin:27px 0px 0px 0px;" id="supname" onclick="Searchforsupp()"></span></a>
                    </td>
                    <td>
                        <span> Supplier Name</span>
                        <br />
                        <input type="text"
                               name="txtSuppliername"
                               id="Suppliername"
                               value="@ViewBag.filter_name"
                               class="textboxStyle required"
                               maxlength="128"
                               readonly="readonly" />
                    </td>
                    <td>
                        <span> Invoice Type</span>
                        <br />
                        <select class="textboxStyle required" id="ddlClaimType" onchange="showclear(this)">
                            <option value="0">---Select---</option>
                            <option value="P">PO</option>
                            <option value="W">WO(With PAR/PR)</option>
                            <option value="N">Non PO/WO</option>
                            <option value="U">Utility</option>
                            <option value="O">WO(Without PAR/PR)</option>
                        </select>
                    </td>
                    <td>
                        <span>PO/WO No</span>
                        <br />
                        <input type="text"
                               id="txtponumber"
                               name="txtInvoiceNo"
                               maxlength="32"
                               value="@ViewBag.filter"
                               class="textboxStyle" />
                    </td>
                    <td>
                        <a title="Search"><span class="glyphicon glyphicon-search" style="margin:27px 0px 0px 0px;" id="posearchicon" onclick="PoSearch11()"></span></a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <span> Invoice Date</span>
                        <br />
                        <input type="text"
                               name="filter_name"
                               id="InvoiceDate"
                               value="@ViewBag.filter_name"
                               class="textboxStyle required" maxlength="10"
                               onchange="checkdateinvoice()" /> @*//Length Fixed by selva*@
                        </td>
                        <td>
                            <span>Invoice No</span>
                            <br />
                            <input type="text"
                                   id="InvoiceNo"
                                   name="txtInvoiceNo"
                                   value="@ViewBag.filter"
                                   class="textboxStyle required"
                                   style="text-transform:uppercase"
                                   maxlength="64" />
                        </td>
                        <td></td>
                        <td colspan="3">
                            <span>Remarks</span>
                            <br />
                            <input type="text"
                                   id="Remarks"
                                   name="txtRemarks"
                                   value="@ViewBag.filter"
                                   class="textboxStyleBig "
                                   maxlength="255" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span> Currency</span>
                            @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.CentralCurrency, new { @class = "textboxStyle Valid", @style = "display: block;margin-top: 4px;", @id = "Currencyinward", @Name = "SupplierType" })

                        </td>
                        <td>
                            <span>Exchange Rate</span><br />
                            <input type="text"
                                   name="txtexrate"
                                   id="txtexrate"
                                   value="@ViewBag.exrate"
                                   class="textboxStyle"
                                   disabled="disabled"
                                   onkeypress="return isAmount(event);"
                                   maxlength="15" />
                            @Html.HiddenFor(n => n.Exrate, new { @id = "txtecratehd" })
                        </td>
                        <td>
                            @*<a title="Search"><span class="glyphicon glyphicon-search" style="margin:27px 0px 0px 0px;" id="supname" onclick="Searchforsupp()"></span></a>*@
                        </td>
                        <td>
                            <span>Currency Amount</span><br />
                            <input type='text'
                                   name='txtecfamontal'
                                   class="textboxStyle required" maxlength="15"
                                   id="txtecfcurramount" />
                        </td>
                        <td colspan="2">
                            <span>Invoice Amount</span><br />
                            <input type='text'
                                   name='txtecfamontal'
                                   id="txtecfamont"
                                   readonly="readonly"
                                   class="textboxStyle" />
                        </td>
                    </tr>

                    <tr>
                        <td colspan="6">
                            <table width="100%">
                                <tr>
                                    <td style="padding-left: 15px;" id="tdGSTCharged">
                                        <span> GST Charged</span>
                                        <br />
                                        <input checked="checked" id="rdogstChargedFlagYes" name="rdogstChargedFlag" type="radio" value="Y" style="margin-top: 10px; margin-right:5px;">Yes
                                        <input id="rdogstChargedFlagNo" name="rdogstChargedFlag" type="radio" value="N" style="margin: 10px 5px 0px 20px;">No
                                    </td>
                                    <td>
                                        <span> Provider Location</span>
                                        @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.ProviderLocation, new { @class = "textboxStyle Valid", @style = "display: block;margin-top: 4px;", @id = "ddlProvider", @Name = "ddlProvider" })
                                    </td>
                                    <td>
                                        <span>Vendor GSTN</span><br />
                                        <input type="text"
                                               name="txtvendorGSTN"
                                               id="txtvendorGSTN"
                                               value=""
                                               class="textboxStyle"
                                               disabled="disabled"
                                               maxlength="15" />
                                    </td>
                                    <td>
                                        <span>Receiver Location</span><br />
                                        @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.ReceiverLocation, new { @class = "textboxStyle Valid", @style = "display: block;margin-top: 4px;", @id = "ddlReceiver", @Name = "ddlReceiver" })
                                    </td>
                                    <td>
                                        <span>FICCL GSTN</span><br />
                                        <input type="text"
                                               name="txtRecGSTIN"
                                               id="txtRecGSTIN"
                                               value=""
                                               class="textboxStyle"
                                               disabled="disabled"
                                               maxlength="15" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
                <table class="myTableStyleTabNew" align="center">
                    <tr>
                        <td>
                            <div>
                                <button type="button" id="btnsave" class="btn btn-primary" value="Save" onclick="Insert()"><span class="glyphicon glyphicon-floppy-disk" style="color:white;"></span> Save</button>
                            </div>
                        </td>
                        <td>
                            <div>
                                <button type="button" class="btn btn-warning" value="Cancel" onclick="Close()"><span style="color:white;" class="glyphicon glyphicon-remove-sign"></span> Cancel</button>
                            </div>
                        </td>
                    </tr>
                </table>
    }
</div>

<div id="ForPartialViewSearch"></div>
<input type="hidden" id="hid_employee" value="" />
<script type="text/javascript">
    function showclear(id) { //Pandiaraj clear on PO/WO  testbox  10/10/2017
        $("#txtponumber").val("");
    }

    $("#txtecfcurramount").keyup(function (event) {
        if (event.which >= 37 && event.which <= 40) {
            event.preventDefault();
        }
        var currentval = $("#txtecfcurramount").val();
        var testDecimal = testDecimals(currentval);
        if (testDecimal.length > 1) {
            currentval = currentval.slice(0, -1);
        }
        $("#txtecfcurramount").val(replaceCommas(currentval));
        var parse = $("#txtecfcurramount").val()
        var parsereplace = parse.replace(/,/g, "");
        var currentvalnew = $('#txtexrate').val() * parseFloat(parsereplace);
        var currentval1 = currentvalnew.toFixed(2);
        var testDecimal1 = testDecimals(currentval1);
        if (testDecimal1.length > 1) {
            currentval1 = currentval1.slice(0, -1);
        }
        var tolnew = replaceCommas(currentval1);
        $('#txtecfamont').val(tolnew);

    });
    var objDialogySearch;
    var SupplierType;
    $(document).ready(function () {
        var UrlHelper = "@Url.Action("GetAutoCompleteCourier", "EOWHelper")"
        UrlHelper = UrlHelper.replace("GetAutoCompleteCourier", "");
        //var RefId = 0; //var RefId = "5838";
        var _Filter = {
            ViewType: "5",
            RefId: 0
        };
        $.ajax({
            type: "post",
            url: UrlHelper + "GetGSTINArray",
            data: JSON.stringify(_Filter),
            async: false,
            contentType: "application/json;",
            success: function (response) {
                var data2 = "";
                debugger;
                if (response.Data1 != null && response.Data1 != "" && JSON.parse(response.Data1) != null)
                    data2 = JSON.parse(response.Data1);
                $("#ddlReceiver").empty();
                if (data2.length > 0) {
                    debugger;
                    //$("#ddlgstProviderLoc").append("<option value='0' >--Select--</option>");
                    for (var i = 0; i < data2.length; i++) {
                        var stylesSelect = $('#ddlReceiver');
                        stylesSelect.attr('disabled', false);
                        $("#ddlReceiver").append("<option value=" + data2[i].Id + " title=" + data2[i].Value1 + " >" + data2[i].Value + "</option>");
                    }
                }
                if (data2.length == 0) {
                    $("#ddlReceiver").append("<option value='0' >--Select--</option>");
                    var stylesSelect = $('#ddlReceiver');
                    stylesSelect.attr('disabled', true);
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
            }
        });
        $('#Currencyinward').change(function () {
            $("#txtexrate").val("");
            $("#txtexrate").remove('valid');
            $("#txtexrate").addClass('required');
            $("#txtecfamont").val('');
            $("#txtecfcurramount").val('');
            var brandID = $(this).val();
            var ecfdate = $("#InvoiceDate").val();

            var Paymode1 = $("#Currencyinward option:selected").text();
            var Paymodeid = $("#Currencyinward").val();

            if (ecfdate == null || ecfdate == "") {
                $("#currencyNames option:selected").text('-- Select --');
                jAlert("Please Enter Invoice Date.", "Message");
                $("#InvoiceDate").focus();
                return false;
            }
            if (brandID == null || brandID == "0" || brandID == "-- Select --") {
                return false;
            }
            var Student =
           {
               "CurrencyName": brandID,
               "Currencyrate": ecfdate
           };
            $.ajax({
                url: '../SupplierInvoiceNew/Getcurrencyrate/',
                data: JSON.stringify(Student),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    if (data != "") {
                        $("#txtexrate").val(data);
                        $("#txtecratehd").val(data);
                        $("#CurrencyNamevalid").val(Paymode1);
                        $("#Currencyidvalid").val(Paymodeid);
                        $("#txtexrate").remove('required');
                        $("#txtexrate").addClass('valid');
                    }
                    else {
                        $("#txtexrate").val("");
                        $("#txtexrate").remove('valid');
                        $("#txtexrate").addClass('required');
                        jAlert(" Please maintain Currency Rate ", "Message");
                        return false;
                    }
                },
                error: function (result) {
                    $("#txtexrate").val("");
                    $("#txtexrate").remove('valid');
                    $("#txtexrate").addClass('required');
                    jAlert("Error", "Message");
                    return false;
                }
            });
        });

        $("#supname").attr("disabled", "disabled");
        if ($("#hid_employee").val() == "") {
            objDialogySearch = $("[id$='ForPartialViewSearch']");
            $("#hid_employee").val("s");
            objDialogySearch.dialog({
                autoOpen: false,
                modal: true,
                //show: 'fade-in',
                //close: 'fade-out',
            });
        }
        $("#hid_employee").val("");
        $("#btnsave").attr("disabled", true);
        $("#txtponumber").attr("disabled", "disabled");
    });

    //$("#txtecfcurramount").keyup(function (event) {

    //    var exrate = $("#txtexrate").val();
    //    var curamount = $("#txtecfcurramount").val();
    //    var newcurval = exrate * curamount
    //    $("#txtecfamont").val(newcurval);
    //});

    function Searchforsupp() {
        $("#posearchicon").attr("disabled", true);
        var url = "@(Html.Raw(Url.Action("SupplierSearchCentral", "Central")))";
        objDialogyinwardsupse.load(url + '?' + new Date().getTime());
        objDialogyinwardsupse.dialog({
            title: 'Supplier Search ', 'width': 1100, modal: true, cache: false, resizable: false, autoOpen: false, 'height': 510
        });
        objDialogyinwardsupse.dialog("open");
    }
    function EmployeeSearch11() {

        var url = "@(Html.Raw(Url.Action("EmployeeSearch", "Central")))";
        objDialogyinwardempse.load(url + '?' + new Date().getTime());
        objDialogyinwardempse.dialog({
            title: 'Employee Search ', 'width': 830, modal: true, resizable: false, cache: false, autoOpen: false, 'height': 510
        });
        objDialogyinwardempse.dialog("open");
    }
    function PoSearch11() {
        var supp = $('#supplierId').val();
        var ddlClaimTypename = $("#ddlClaimType option:selected").text();
        var ddlClaimTypeid = $("#ddlClaimType").val();
        if (ddlClaimTypeid == "0" || ddlClaimTypename == "-- Select --") {
            jAlert("Please Select Invoice Type", "Information");
            return;
        }

        else if (ddlClaimTypeid == "P" || ddlClaimTypeid == "W" || ddlClaimTypeid == "O") {
            $.ajax({
                url: '@Url.Action("posearchdetails", "Central")?id=' + supp + '&' + new Date().getTime(),
                //data: JSON.stringify(Student),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (result) {
                    isSuccess = result;
                    if (supp == null || supp == 0) {
                        jAlert("You Can't Search PO/WO Number", "Information");
                        return false;
                    }
                    else if (result == 0) {
                        jAlert("This Supplier Don't Have PO/WO Number", "Information");
                        return false;
                    }
                    else {
                        var url = "@(Html.Raw(Url.Action("POSearch", "Central")))";
                        posearchdetails.load(url + '?id=' + supp + '&claimType=' + ddlClaimTypeid);
                        posearchdetails.dialog({
                            title: 'PO  Search ', 'width': 830, modal: true, resizable: false, cache: false, autoOpen: false, 'height': 510
                        });
                        posearchdetails.dialog("open");
                        $("#searchgrid").css("display", "block"); /*selva po search 16-03-2021*/
                    }
                },
            });
        }
    }
    $(document).ready(function () {
        $("#posearchicon").attr("disabled", true);

        var objDate = new Date();
        var Presentyear = objDate.getFullYear();

        $("#RecivedDate").datepicker({
            changeMonth: true,
            changeYear: true,
            maxDate: '-id',
            dateFormat: 'dd-mm-yy',
            numberOfMonths: 1,
            onSelect: function (selected) {
                $("#RecivedDate").addClass('valid');
                $("#InvoiceDate").datepicker("option", "maxDate", selected);
            }
        });
        $("#InvoiceDate").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd-mm-yy',
            maxDate: '-id',
            numberOfMonths: 1,
            onSelect: function (selected) {
                $("#InvoiceDate").addClass('valid');
                $("#RecivedDate").datepicker("option", "minDate", selected);
            }
        });
        $("#txtinvoice, #txtraisercode").keypress(function (event) {
            return isNumber(event);
        });
        $("#invoice").keypress(function (event) {
            return isAmount(event);
        });
        $("#txtecfcurramount").keypress(function (event) {

            return isAmount(event);
        });
        $("#raisername").keypress(function (event) {
            return isAlphabet(event);
        });
        $("#suppliercode", "#Suppliername", "#InvoiceNo", "#PONO").keypress(function (event) {
            return isAlphaNumeric(event);
        });
        $("#RecivedDate", "#InvoiceDate").keypress(function (event) {
            return isDate(event);
        });
    });
    $('#SupplierIdCinward').change(function () {
        $("#posearchicon").attr("disabled", true);
        var text = $("#SupplierIdCinward option:selected").text();
        if (text == "Approved") {
            $("#suppliercode").val('');
            $("#Suppliername").val('');
            $("#Suppliername").removeClass('valid');
            $("#Suppliername").addClass('required');
            $("#Suppliername").attr("readonly", true);
            $("#suppliercode").attr("readonly", true);
            //$("#posearchicon").attr("disabled", false);
            //$("#txtponumber").attr("disabled", false);
            $("#supname").attr("disabled", false);
        }
        else {
            $("#suppliercode").val('');
            $("#Suppliername").val('');
            $("#Suppliername").removeClass('valid');
            $("#Suppliername").addClass('required');
            $("#suppliercode").attr("readonly", true);
            $("#Suppliername").attr("readonly", false);
            //$("#txtponumber").attr("disabled", "disabled");
            $("#supname").attr("disabled", "disabled");
            //$("#posearchicon").attr("disabled", true);
        }
        if (text == "---Select---") {
            $("#SupplierIdCinward").removeClass('valid');
            $("#SupplierIdCinward").addClass('required');
        }
    });
    $("#txtponumber").blur(function () {
        var InwardNo = $('#txtponumber').val()
        var Pulloutdetails = {
            "PONo": InwardNo
        };
        $.post('../Central/CheckValidInwardNo', Pulloutdetails,
            function (data) {
                if (data == "INVALID") {
                    jAlert("Invalid PO No", "Information", function (r) {
                        if (r = true) {
                            $("#txtponumber").focus();
                            $('#btnsave').attr('disabled', true);
                            return false;
                        }
                    });
                }
                else {
                    $('#btnsave').attr('disabled', false);
                }
            }
        , 'json');
    });
    function Save() {
        $('#btnsave').attr('disabled', true);
        var SupType = $("#SupplierIdCinward option:selected").text();

        var ddlClaimTypename = $("#ddlClaimType option:selected").text().substring(1, 2); // ramya added on 04 jun 22
        var ddlClaimTypeid = $("#ddlClaimType").val();
        var PONO = $("#txtponumber").val();
        if (ddlClaimTypeid == "0" || ddlClaimTypename == "-- Select --") {
            jAlert("Please Select Invoice Type", "Information");
            return;
        }
        if (ddlClaimTypename == "PO") {
            if (PONO == "") {
                jAlert("Please Select PO Ref No.", "Information");
                return false;
            }
        }
        else if (ddlClaimTypename == "WO") {
            if (PONO == "") {
                jAlert("Please Select PO Ref No.", "Information");
                return false;
            }
        }

        var employeeid = $("#EmployeeId").val();
        var RecivedDate = $("#RecivedDate").val();
        var Raisercode = $("#raisercode").val();
        var Raisername = $("#raisername").val();
        var SupplierCode = $("#suppliercode").val();
        var supplierId = $("#supplierId").val();
        var Suppliername = $("#Suppliername").val();
        var InvoiceDate = $("#InvoiceDate").val();
        var InvoiceNo = $("#InvoiceNo").val();
        var invoice = $("#invoice").val();

        var Remarks = $("#Remarks").val();
        var Currency = $("#Currencyinward").val();
        var ExchangeRate = $("#txtexrate").val();
        var CurrencyAmount = $("#txtecfcurramount").val().replace(/,/g, "");
        var EcfAmount = $("#txtecfamont").val().replace(/,/g, "");
        var providerlocation = $("#ddlProvider").val();
        var Receiverlocation = $("#ddlReceiver").val();
        var VendorGst = $("#txtvendorGSTN").val();
        var Ficcl = $("#txtRecGSTIN").val(); //ramya 16 Feb 21
        var GstCharged = "N";
        GstCharged = $("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value");
        //debugger;
        if ((VendorGst == "" || VendorGst == null) && (GstCharged == "Y" || GstCharged == "N") && Currency != 4) {
            VendorGst = "0";
        }
        if (Suppliername == null || Suppliername == "" || InvoiceDate == null || InvoiceDate == "" || InvoiceNo == null || InvoiceNo == "") {
            jAlert("You Can't Add Empty Values", "Information");
            return false;
        }
        if (SupType == "Approved") {
            SupType = 'A';
        }
        else if (SupType == "UnApproved") {
            SupType = 'U';
        }
        var Student = {
            "EmployeeId": employeeid,
            "ReceivedDate": RecivedDate,
            "SupplierId": supplierId,
            "SupplierCode": SupplierCode,
            "SupplierName": Suppliername,
            "SupplierType": SupType,
            "RaiserCode": Raisercode,
            "RaiserName": Raisername,
            "InvoiceNo": InvoiceNo,
            "InvoiceDate": InvoiceDate,
            "InvoiceAmount": invoice,
            "PONo": PONO,
            "Remarks": Remarks,
            "Exrate": ExchangeRate,
            "Currencyrate": Currency,
            "Currencyamount": CurrencyAmount,
            "POtype": ddlClaimTypeid,
            "ECF_Amount": EcfAmount,
            "ProviderLocationGid": providerlocation,
            "ReceiverLocationGid": Receiverlocation,
            "centralinward_provider_gstn": VendorGst, //15 Feb 21 ramya
            "centralinward_receiver_gstn": Ficcl,
            "GSTNStatus": GstCharged,
        };
        $.ajax({
            url: '../Central/AddSupplier/',
            data: JSON.stringify(Student),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (result) {
                jYesNo(result, "Information", function (j) {
                    if (j == true) {
                        $("#InvoiceNo").val('');
                        $("#txtecfcurramount").val('');
                        $('#btnsave').attr('disabled', false);
                        @*var url = '@Url.Action("CentralteaminwardAddNew", "Central")?' + new Date().getTime();
                        $("#CentralInwardScreen").load(url);*@

                    }
                    else {
                        @*location = '@Url.Action("ClearInward", "Central")?' + new Date().getTime();*@
                        var url = '@Url.Action("CentralteaminwardAddNew", "Central")?' + new Date().getTime();
                        $("#CentralInwardScreen").load(url);
                    }
                });
            },
        })
    }
    function Close() {
        location = '@Url.Action("ClearInward", "Central")?' + new Date().getTime();
        objDialogyCentral.remove();
    }
    $(".ui-icon-closethick").click(function () {
        location = '@Url.Action("ClearInward", "Central")?' + new Date().getTime();
    });
    function Insert() {
        var ddlClaimTypename = $("#ddlClaimType option:selected").text().substring(1, 2);
        //var ddlClaimTypename = $("#ddlClaimType").val();
        var ddlClaimTypeid = $("#ddlClaimType").val();
        var PONO = $("#txtponumber").val();
        if (ddlClaimTypeid == "0" || ddlClaimTypename == "-- Select --") {
            jAlert("Please Select Invoice Type", "Information");
            return;
        }
        if (ddlClaimTypename == "PO") {
            if (PONO == "") {
                jAlert("Please Select PO Ref No.", "Information");
                return false;
            }
        }
        else if (ddlClaimTypename == "WO") {
            if (PONO == "") {
                jAlert("Please Select PO Ref No.", "Information");
                return false;
            }
        }
        var SupType = $("#SupplierIdCinward option:selected").text();
        var employeeid = $("#EmployeeId").val();
        var RecivedDate = $("#RecivedDate").val();
        var Raisercode = $("#raisercode").val();
        var Raisername = $("#raisername").val();
        var SupplierCode = $("#suppliercode").val();
        var supplierId = $("#supplierId").val();
        var Suppliername = $("#Suppliername").val();
        var InvoiceDate = $("#InvoiceDate").val();
        var InvoiceNo = $("#InvoiceNo").val();
        var invoice = $("#invoice").val();
        var Remarks = $("#Remarks").val();
        var Currency = $("#Currencyinward").val();
        var ExchangeRate = $("#txtexrate").val();
        //var CurrencyAmount = $("#txtecfcurramount").val().replace(/,/g, '');
        var CurrencyAmount = $("#txtecfcurramount").val().replace(/,/g, "");
        var EcfAmount = $("#txtecfamont").val().replace(/,/g, "");
        var providerlocation = $("#ddlProvider").val();
        var Receiverlocation = $("#ddlReceiver").val();
        var VendorGst = $("#txtvendorGSTN").val();
        var Ficcl = $("#txtRecGSTIN").val();
        var GstCharged = "N";
        GstCharged = $("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value");
        if ((providerlocation == "0" || providerlocation == "" || providerlocation == null)) {
            jAlert("Please Select provider Location ", "Message");
            return false;
        }
        if ((Receiverlocation == "0" || Receiverlocation == "" || Receiverlocation == null)) {
            jAlert("Please Select Receiver Location", "Message");
            return false;
        }
        if ((VendorGst == "" || VendorGst == null) && GstCharged == "Y" && providerlocation != 78 && Currency == 4) { // ramya modified on 30 sep 22
            jAlert("Please Select GSTIN Vendor", "Message");
            return false;
        }
        if ((VendorGst == "" || VendorGst == null) && providerlocation == 78) {
            VendorGst = "0"
        }

        if ((VendorGst == "" || VendorGst == null) && (GstCharged == "Y" || GstCharged == "N") && Currency != 4) {
            VendorGst = "0";
        }
        if ((Ficcl == "" || Ficcl == null) && GstCharged == "Y") {
            jAlert("Please Select Receiver Location GSTIN!", "Message");
            return false;
        }
        if (Suppliername == null || Suppliername == "" || InvoiceDate == null || InvoiceDate == "" || InvoiceNo == null || InvoiceNo == "") {
            jAlert("You Can't Add Empty Values", "Information");
            return;
        }
        if (SupType == "Approved") {
            SupType = 'A';
        }
        else if (SupType == "UnApproved") {
            SupType = 'U';
        }
        var Student = {
            "EmployeeId": employeeid,
            "ReceivedDate": RecivedDate,
            "SupplierId": supplierId,
            "SupplierCode": SupplierCode,
            "SupplierName": Suppliername,
            "SupplierType": SupType,
            "RaiserCode": Raisercode,
            "RaiserName": Raisername,
            "InvoiceNo": InvoiceNo,
            "InvoiceDate": InvoiceDate,
            "InvoiceAmount": invoice,
            "PONo": PONO,
            "Remarks": Remarks,
            "Exrate": ExchangeRate,
            "Currencyrate": Currency,
            "Currencyamount": CurrencyAmount,
            "POtype": ddlClaimTypeid,
            "ECF_Amount": EcfAmount,
            "providerlocation": providerlocation,
            "Receiverlocation": Receiverlocation,
            "VendorGst": VendorGst,
            "Ficcl": Ficcl,
            "GstCharged": GstCharged,
        };
        $.ajax({
            url: '../Central/AddSupplierDuplicateCheck/',
            data: JSON.stringify(Student),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (result) {
                if (result == "NotExists") {
                    Save();
                }
                else {
                    jAlert(result);
                    @*var url = '@Url.Action("CentralteaminwardAddNew", "Central")?' + new Date().getTime();
                        $("#CentralInwardScreen").load(url);*@
                }
            },
        })
    }

    $("#ddlClaimType").keyup(function () {
        var txtContractFrom = $("#ddlClaimType").val();
        if (txtContractFrom.trim() != "0") {
            $("#ddlClaimType").removeClass('required');
            $("#ddlClaimType").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#ddlClaimType").removeClass('valid');
            $("#ddlClaimType").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#ddlClaimType").change(function () {
        $("#posearchicon").attr("disabled", true);
        $("#txtponumber").attr("disabled", "disabled");
        var txtContractFrom = $("#ddlClaimType").val();
        if (txtContractFrom.trim() != "0") {
            $("#ddlClaimType").removeClass('required');
            $("#ddlClaimType").addClass('valid');

            if (txtContractFrom != "N" && txtContractFrom != "U") {
                $("#txtponumber").attr("disabled", "disabled");
                $("#posearchicon").attr("disabled", false);
            }
                //else if (txtContractFrom == "W") {
                //    $("#txtponumber").attr("disabled", "disabled");
                //    $("#posearchicon").attr("disabled", false);
                //}
            else {
                $("#txtponumber").attr("disabled", "disabled");
                $("#txtponumber").removeClass('required');
                $("#txtponumber").removeClass('valid');
                $("#posearchicon").attr("disabled", true);
            }
            CheckFieldsHeader();
        }
        else {
            $("#ddlClaimType").removeClass('valid');
            $("#ddlClaimType").addClass('required');
            CheckFieldsHeader();
        }
    });

    $("#RecivedDate").change(function () {
        var txtContractTo = $("#RecivedDate").val();
        if (txtContractTo.trim() != "") {
            $("#RecivedDate").removeClass('required');
            $("#RecivedDate").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#RecivedDate").removeClass('valid');
            $("#RecivedDate").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#raisercode").blur(function () {
        var txtContractTo = $("#raisercode").val();
        if (txtContractTo.trim() != "") {
            $("#raisercode").removeClass('required');
            $("#raisercode").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#raisercode").removeClass('valid');
            $("#raisercode").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#raisername").blur(function () {
        var txtContractTo = $("#raisername").val();
        if (txtContractTo.trim() != "") {
            $("#raisername").removeClass('required');
            $("#raisername").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#raisername").removeClass('valid');
            $("#raisername").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#Suppliername").keyup(function () {
        var txtContractTo = $("#Suppliername").val();
        if (txtContractTo.trim() != "") {
            $("#Suppliername").removeClass('required');
            $("#Suppliername").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#Suppliername").removeClass('valid');
            $("#Suppliername").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#InvoiceDate").change(function () {
        var txtContractTo = $("#InvoiceDate").val();
        if (txtContractTo.trim() != "") {
            $("#InvoiceDate").removeClass('required');
            $("#InvoiceDate").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#InvoiceDate").removeClass('valid');
            $("#InvoiceDate").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#InvoiceNo").keyup(function () {
        //var valupper = $('#InvoiceNo').val().toUpperCase();
        //$('#InvoiceNo').val(valupper);
        var txtContractTo = $("#InvoiceNo").val();
        if (txtContractTo.trim() != "") {
            $("#InvoiceNo").removeClass('required');
            $("#InvoiceNo").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#InvoiceNo").removeClass('valid');
            $("#InvoiceNo").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#invoice").keyup(function () {
        var txtContractTo = $("#invoice").val();
        if (txtContractTo.trim() != "") {
            $("#invoice").removeClass('required');
            $("#invoice").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#invoice").removeClass('valid');
            $("#invoice").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#txtponumber").change(function () {
        var txtContractTo = $("#txtponumber").val();
        if (txtContractTo.trim() != "") {
            $("#txtponumber").removeClass('required');
            $("#txtponumber").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#txtponumber").removeClass('valid');
            $("#txtponumber").addClass('required');
        }
    });
    $("#txtecfcurramount").keyup(function () {
        var txtContractTo = $("#txtecfcurramount").val();
        if (txtContractTo.trim() != "") {
            $("#txtecfcurramount").removeClass('required');
            $("#txtecfcurramount").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#txtecfcurramount").removeClass('valid');
            $("#txtecfcurramount").addClass('required');
            CheckFieldsHeader();
        }
    });
    function suppliertype() {
        var txtContractTo = $("#SupplierIdCinward option:selected").text();
        if (txtContractTo.trim() != "") {
            $("#SupplierIdCinward").removeClass('required');
            $("#SupplierIdCinward").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#SupplierIdCinward").removeClass('valid');
            $("#SupplierIdCinward").addClass('required');
        }
    }

    function CheckFieldsHeader() {
        //var ddlClaimTypename = $("#ddlClaimType option:selected").text();
        //var ddlClaimTypeid = $("#ddlClaimType").val();

        var ErrCount = 0;
        if ($("#RecivedDate").val() == "" || $("#RecivedDate").val() == null) {
            ErrCount = 1;
        }
        if ($("#raisercode").val() == "" || $("#raisercode").val() == null) {
            ErrCount = 2;
        }
        if ($("#raisername").val() == "" || $("#raisername").val() == null) {
            ErrCount = 3;
        }
        if ($("#Suppliername").val() == "" || $("#Suppliername").val() == null) {
            ErrCount = 5;
        }
        if ($("#InvoiceDate").val() == "" || $("#InvoiceDate").val() == null) {
            ErrCount = 6;
        }
        if ($("#InvoiceNo").val() == "" || $("#InvoiceNo").val() == null) {
            ErrCount = 7;
        }
        if ($("#txtecfcurramount").val() == "" || $("#txtecfcurramount").val() == null) {
            ErrCount = 8;
        }
        if ($("#SupplierIdCinward").val() == "" || $("#SupplierIdCinward").val() == null || $("#SupplierIdCinward").val() == "---Select---") {
            ErrCount = 9;
        }
        if ($("#ddlClaimType").val() == "0" || $("#ddlClaimType").val() == null) {
            ErrCount = 10;
        }
        if (ErrCount == 0) {
            $("#btnsave").removeAttr('disabled');
        }
        else {
            $("#btnsave").attr('disabled', 'disabled');
        }
    }
    function checkdate() {
        var txtContractTo = $("#RecivedDate").val();
        if (txtContractTo.trim() != "") {
            $("#RecivedDate").removeClass('required');
            $("#RecivedDate").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#RecivedDate").removeClass('valid');
            $("#RecivedDate").addClass('required');
            CheckFieldsHeader();
        }
    }
    function checkdateinvoice() {
        var txtContractTo = $("#InvoiceDate").val();
        if (txtContractTo.trim() != "") {
            $("#InvoiceDate").removeClass('required');
            $("#InvoiceDate").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#InvoiceDate").removeClass('valid');
            $("#InvoiceDate").addClass('required');
            CheckFieldsHeader();
        }
    }
    function LoadSupplier() {
        var Suppliergid = $("#supplierId").val();
        $.ajax({
            url: "../Central/GetValue",
            type: "POST",
            dataType: "json",
            data: { "SupplierId": Suppliergid },
            success: function (data) {
                $("#PONOId").empty();
                if (data.length > 0) {
                    $("#PONOId").append("<option value='0' >--Select--</option>");
                    for (var i = 0; i < data.length; i++) {
                        var stylesSelect = $('#PONOId');
                        stylesSelect.attr('disabled', false);
                        $("#PONOId").append("<option value=" + data[i].PONo + " >" + data[i].PONo + "</option>");
                    }
                }
                if (data.length == 0) {
                    var stylesSelect = $('#PONOId');
                    stylesSelect.attr('disabled', true);
                }
            }
        });
    }
    $(document).ready(function () {
        $("#raisercode").autocomplete({

            source: function (request, response) {
                $.ajax({
                    url: "/ECF/AutocompleteEmployeeCode",
                    type: "POST",
                    dataType: "json",
                    data: { RaiserCode: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.EmployeeId, value: item.RaiserCode };
                            $("")
                        }))
                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });

        $("#raisername").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/ECF/AutocompleteEmployeeName",
                    type: "POST",
                    dataType: "json",
                    data: { RaiserName: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.RaiserName, value: item.RaiserName };
                        }))
                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });
    });
    //GST_Phase_3_2
    $("#ddlProvider").change(function () {
        $("#ddlProvider").removeClass("valid").removeClass("required");
        var value = $(this).val();
        if (value != null && value != "0" && value != "") {
            $("#ddlProvider").addClass("valid");
        } else { $("#ddlProvider").addClass("required"); }
        var _text = $('#ddlProvider option:selected').attr('title');
        $("#txtvendorGSTN").val(_text);
    });
    $("#ddlReceiver").change(function () {
        $("#ddlReceiver").removeClass("valid").removeClass("required");
        var value = $(this).val();
        if (value != null && value != "0" && value != "") {
            $("#ddlReceiver").addClass("valid");
        } else { $("#ddlReceiver").addClass("required"); }
        var _text = $('#ddlReceiver option:selected').attr('title');
        $("#txtRecGSTIN").val(_text);
    });
</script>
