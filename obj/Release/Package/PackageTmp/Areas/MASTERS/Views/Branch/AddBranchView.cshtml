@model  IEnumerable<IEM.Areas.MASTERS.Models.BranchDataModel>

<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.24.min.js")" type="text/javascript"></script>
<div class="well">
    <div class="row">
        <table class="myTableStyleTabNew" align="left" style="width:99%">
            <tr>
                <td>
                    <div class="input-append ">
                        <span>Branch Code</span>
                        <br />
                        <input type="text"
                               name="BranchCode"
                               id="BranchCodeId"
                               value="@ViewBag.BranchCode"
                               class="textboxStyleSearch required"
                               maxlength="32"
                               style="width: 100%;" />
                    </div>
                </td>
                <td colspan="2">
                    <div class="input-append ">
                        <span>Branch Name</span>
                        <br />
                        <input type="text"
                               name="BranchName"
                               id="BranchNameId"
                               value="@ViewBag.BranchName"
                               class="textboxStyleSearch required"
                               maxlength="32"
                               style="width: 100%;" />
                    </div>
                </td>
                <td>
                    <span>Branch Type</span>
                    <br />
                    @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.BranchType, "-----Select-----", new { @class = "textboxStyleSearch required", @style = "display: block;width:100%;", @id = "BranchTypeId", @Name = "BranchType" })
                </td>
                <td>
                    <div class="input-append ">
                        <span>Branch Tier</span>
                        <br />
                        <input type="text"
                               name="BranchTier"
                               id="BranchTier"
                               value="@ViewBag.BranchTier"
                               class="textboxStyleSearch required"
                               maxlength="32"
                               style="width: 100%;" />
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="input-append ">
                        <span>Old Branch Code</span>
                        <br />
                        <input type="text"
                               name="OldBranchCode"
                               id="OldBranchCode"
                               value="@ViewBag.OldBranchCode"
                               class="textboxStyleSearch"
                               maxlength="32"
                               style="width: 100%;" />
                    </div>
                </td>
                <td style="display:none;">
                    <span>Employee Id</span>
                    <br />
                    <input type="text"
                           name="EmployeeId"
                           id="EmployeeId"
                           value="@ViewBag.EmployeeId"
                           class="textboxStyleSearch required"
                           maxlength="32"
                           readonly="readonly"
                           style="width: 100%;" />
                </td>
                <td>
                    <span>Branch Incharge</span>
                    <br />
                    <input type="text"
                           name="BranchIncharge"
                           id="BranchIncharge"
                           value="@ViewBag.BranchIncharge"
                           class="textboxStyleSearch required"
                           maxlength="32"
                           readonly="readonly"
                           style="width: 100%;" />
                </td>
                <td style="width:3%">
                    <span>&nbsp;</span>
                    <br />
                    <a title="Search"><span class="glyphicon glyphicon-search" id="Searchicon" onclick="EmployeeSearchBranch()"></span></a>
                </td>
                <td>
                    <div class="input-append ">
                        <span>Start Date</span>
                        <br />
                        <input type="text"
                               name="StartDate"
                               id="StartDate"
                               value="@ViewBag.StartDate"
                               class="textboxStyleSearch required"
                               maxlength="32"
                               style="width: 100%;" />
                    </div>
                </td>
                <td>
                    <div class="input-append ">
                        <span>End Date</span>
                        <br />
                        <input type="text"
                               name="EndDate"
                               id="EndDate"
                               value="@ViewBag.EndDate"
                               class="textboxStyleSearch required"
                               maxlength="32"
                               style="width: 100%;" />
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <span>Branch</span>
                    <br />
                    @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.Branch, "-----Select-----", new { @class = "textboxStyleSearch required", @style = "display: block;width: 100%;", @id = "BranchId", @Name = "Branch" })
                </td>
                <td colspan="2">
                    <span>City</span>
                    <br />
                    @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.City, "-----Select-----", new { @class = "textboxStyleSearch required", @style = "display: block;width: 100%;", @id = "CityId", @Name = "City" })
                </td>
                <td>
                    <span>Location</span>
                    <br />
                    @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.location, "-----Select-----", new { @class = "textboxStyleSearch required", @style = "display: block;width:100%;", @id = "locationId", @Name = "location" })
                </td>
                <td>
                    <span>Active Status</span>
                    <br />
                    @Html.DropDownList("cnm", (IEnumerable<SelectListItem>)ViewBag.ActiveStatus, "-----Select-----", new { @class = "textboxStyleSearch required", @style = "display: block;width: 100%;", @id = "ActiveStatusId", @Name = "ActiveStatus" })
                </td>
            </tr>
            <tr>
                <td colspan="5">
                    <div class="input-append ">
                        <span>Branch Address</span>
                        <br />
                        <input type="text"
                               name="BranchAddress"
                               id="BranchAddress"
                               value="@ViewBag.BranchAddress"
                               class="textboxStyleSearch required"
                               maxlength="32" />
                    </div>
                </td>
            </tr>
        </table>
        <table class="myTableStyleTabNew" align="center">
            <tr>
                <td>
                    <div>
                        <button type="button" id="btnsave" class="btn btn-primary" value="Save" onclick="SaveTravel()"><span class="glyphicon glyphicon-floppy-disk" style="color:white;"></span> Save</button>
                    </div>
                </td>
                <td>
                    <div>
                        <button type="button" class="btn btn-warning" value="Cancel" onclick="GotoIndex()"><span style="color:white;" class="glyphicon glyphicon-remove-sign"></span> Cancel</button>
                    </div>
                </td>
            </tr>
        </table>
    </div>
</div>
<script>
    $(document).ready(function () {
        $("#btnsave").attr('disabled', 'disabled');
        $(function () {
            $("#TravelClassIdAdd").focus();
        });
    });
    function SaveTravel() {
        var BranchName = $("#BranchNameId").val();
        var oldbranchcode = $("#OldBranchCode").val();
        var BranchTypeId = $("#BranchTypeId option:selected").val();
        var BranchCode = $("#BranchCodeId").val();
        var BranchTier = $("#BranchTier").val();
        var EmployeeId = $("#EmployeeId").val();
        var StartDate = $("#StartDate").val();
        var EndDate = $("#EndDate").val();
        var Location = $("#locationId option:selected").val();
        var LocationName= $("#locationId option:selected").text();
        var City_gid = $("#CityId option:selected").val();
        var City = $("#CityId option:selected").text();
        var EmployeeId = $("#EmployeeId").val();
        var BranchAddress = $("#BranchAddress").val();
        var BranchFlag = $("#BranchId option:selected").text();
        var ActiveStatusId = $("#ActiveStatusId option:selected").text();

        var branch = {
            "BranchName": BranchName,
            "Branchtype_gid": BranchTypeId,
            "BranchCode": BranchCode,
            "BranchTier": BranchTier,
            "EmployeeId": EmployeeId,
            "StartDate": StartDate,
            "ClosedDate": EndDate,
            "City_gid": City_gid,
            "City":City,
            "Location_gid": Location,
            "BranchAddress":BranchAddress,
            "Branchfl": BranchFlag,
            "ActiveStatus": ActiveStatusId,
            "BranchTier":BranchTier,
            "LocationName": LocationName,
            "OldBranchCode":oldbranchcode
        };
      
        $.ajax({
            url: '../Branch/AddBranch',
            data: JSON.stringify(branch),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (result) {
                isSuccess = result;
                jAlert(result, "Information", function (r) {
                    if (r == true) {
                        location = '../Branch/BranchIndex';
                    }
                });
               
            },
        })
        //$.post('../Branch/AddBranch', branch,
        //       function (data) {

        //           jAlert(data, "Information", function (r) {
        //                           if (r == true) {
        //                               location = '../Branch/BranchIndex';
        //                           }
        //                       });
        //       }

        //  , 'json');
    }
    function EmployeeSearchBranch() {
        var url = "@(Html.Raw(Url.Action("EmployeeSearch", "Branch")))";
        objDialogybranchempse.load(url + '?' + new Date().getTime());
        objDialogybranchempse.dialog({title: 'Employee Search ', 'width': 830, show: 'fade-in', close: 'fade-out', modal: true, resizable: false, cache: false, autoOpen: false, 'height': 510
        });
        objDialogybranchempse.dialog("open");
    }
    function GotoIndex() {
        window.parent.jQuery('#ForPartialViewBranch').dialog('close');
        $('#gridBranchClassid').find('tr').css('background', 'none');
    }
    $(".ui-icon-closethick").click(function () {
        $('#gridBranchClassid').find('tr').css('background', 'none');
    });
    $(document).ready(function () {
        $("#StartDate").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd-mm-yy',
            onSelect: function (selected) {

                var dt = $('#StartDate').val();
                var dt1 = $('#EndDate').val();
                $("#StartDate").addClass('valid');
                $("#EndDate").datepicker("option", "minDate", selected)
            }
        })
        $("#EndDate").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd-mm-yy',

            onSelect: function (selected) {
                var dt = $('#StartDate').val();
                var dt1 = $('#EndDate').val();
                $("#EndDate").addClass('valid');
            }
        });
    });
    $("#StartDate").change(function () {
        var txtContractTo = $("#StartDate").val();
        if (txtContractTo.trim() != "") {
            $("#StartDate").removeClass('required');
            $("#StartDate").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#StartDate").removeClass('valid');
            $("#StartDate").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#EndDate").change(function () {
        var txtContractTo = $("#EndDate").val();
        if (txtContractTo.trim() != "") {
            $("#EndDate").removeClass('required');
            $("#EndDate").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#EndDate").removeClass('valid');
            $("#EndDate").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#BranchCodeId").keyup(function () {
        var txtContractTo = $("#BranchCodeId").val();
        if (txtContractTo.trim() != "") {
            $("#BranchCodeId").removeClass('required');
            $("#BranchCodeId").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#BranchCodeId").removeClass('valid');
            $("#BranchCodeId").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#BranchAddress").keyup(function () {
        var txtContractTo = $("#BranchAddress").val();
        if (txtContractTo.trim() != "") {
            $("#BranchAddress").removeClass('required');
            $("#BranchAddress").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#BranchAddress").removeClass('valid');
            $("#BranchAddress").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#BranchNameId").keyup(function () {
        var txtContractTo = $("#BranchNameId").val();
        if (txtContractTo.trim() != "") {
            $("#BranchNameId").removeClass('required');
            $("#BranchNameId").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#BranchNameId").removeClass('valid');
            $("#BranchNameId").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#BranchTypeId").change(function () {
        var txtContractTo = $("#BranchTypeId").val();
        if (txtContractTo.trim() != "") {
            $("#BranchTypeId").removeClass('required');
            $("#BranchTypeId").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#BranchTypeId").removeClass('valid');
            $("#BranchTypeId").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#BranchId").change(function () {
        var txtContractTo = $("#BranchId").val();
        if (txtContractTo.trim() != "") {
            $("#BranchId").removeClass('required');
            $("#BranchId").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#BranchId").removeClass('valid');
            $("#BranchId").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#BranchTier").keyup(function () {
        var txtContractTo = $("#BranchTier").val();
        if (txtContractTo.trim() != "") {
            $("#BranchTier").removeClass('required');
            $("#BranchTier").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#BranchTier").removeClass('valid');
            $("#BranchTier").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#CityId").change(function () {
        var txtContractTo = $("#CityId").val();
        if (txtContractTo.trim() != "") {
            $("#CityId").removeClass('required');
            $("#CityId").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#CityId").removeClass('valid');
            $("#CityId").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#locationId").change(function () {
        var txtContractTo = $("#locationId").val();
        if (txtContractTo.trim() != "") {
            $("#locationId").removeClass('required');
            $("#locationId").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#locationId").removeClass('valid');
            $("#locationId").addClass('required');
            CheckFieldsHeader();
        }
    });
    $("#ActiveStatusId").change(function () {
        var txtContractTo = $("#ActiveStatusId").val();
        if (txtContractTo.trim() != "") {
            $("#ActiveStatusId").removeClass('required');
            $("#ActiveStatusId").addClass('valid');
            CheckFieldsHeader();
        }
        else {
            $("#ActiveStatusId").removeClass('valid');
            $("#ActiveStatusId").addClass('required');
        }
    });
    function CheckFieldsHeader() {

        var ErrCount = 0;
        if ($("#BranchIncharge").val().trim() == "" || $("#BranchIncharge").val() == null) {
            ErrCount = 11;
        }
        if ($("#ActiveStatusId").val().trim() == "" || $("#ActiveStatusId").val() == null) {
          
            ErrCount = 1;
        }
        if ($("#locationId").val().trim() == "" || $("#locationId").val() == null) {
         
            ErrCount = 2;
        }
        if ($("#CityId").val().trim() == "" || $("#CityId").val() == null) {
           
            ErrCount = 3;
        }
        if ($("#BranchId").val().trim() == "" || $("#BranchId").val() == null) {
           
            ErrCount = 5;
        }
        if ($("#BranchTypeId").val().trim() == "" || $("#BranchTypeId").val() == null) {
           
            ErrCount = 6;
        }
        if ($("#BranchNameId").val().trim() == "" || $("#BranchNameId").val() == null) {
           
            ErrCount = 7;
        }
        if ($("#BranchCodeId").val().trim() == "" || $("#BranchCodeId").val() == null) {
           
            ErrCount = 8;
        }
        if ($("#BranchAddress").val().trim() == "" || $("#BranchAddress").val() == null) {
            
            ErrCount = 9;
        }
        if ($("#BranchTier").val().trim() == "" || $("#BranchTier").val() == null) {
           
            ErrCount = 10;
        }
        if (ErrCount == 0) {
           
            $("#btnsave").removeAttr('disabled');
        }
        else {
            $("#btnsave").attr('disabled', 'disabled');
        }
    }
</script>
