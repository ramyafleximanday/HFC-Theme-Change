@model IEM.Areas.MASTERS.Models.FbEntity
@{
    var viewfor = (string)ViewBag.viewfor;

    if (viewfor == "edit")
    {
        ViewBag.viewmode = "";
    }
    else if (viewfor == "view")
    {
        ViewBag.viewmode = "disabled";
    }
    else if (viewfor == "delete")
    {
        ViewBag.viewmode = "disabled";
        ViewBag.deletemode = "disabled";
    }

}
<head>
    <title></title>
    <style>
        .disabled {
            color: darkgray;
            background-color: gray;
        }
    </style>
</head>
@using (Html.BeginForm())
{
    <input type="hidden" id="hidRadio" value="@Session["productService"]" />
    <input type="hidden" id="productid" value="@Model.productId" />
    <input type="hidden" id="hidRadio" value="@Session["productService"]" />
    <input type="hidden" id="hidParent" name="hidparent" value="@Session["parent"]" />
    <input type="hidden" id="hidCategory" value="@Session["Category"]" />
    <input type="hidden" id="hidgid" name="productID" value="@Session["gid"]" />
    <input type="hidden" id="hid" value="Edit" name="Edit" />
    <table class="myTableStyleTabNew">
        <tr>
            <td>
                <input type="radio" id="radioProduct" value="Product" name="Radio" @ViewBag.viewmode /> Product
                <input type="radio" id="radioService" value="Service" name="Radio" @ViewBag.viewmode /> Service
            </td>
        </tr>
    </table>
    <br />
    <div id="ProductServiceDetails" class="borderStyle">
        <table id="productDetailTable" style="margin-left: 15px" class="myTableStyleTabNew">

            @{
    var a = (string)Session["productService"];
    if (a != "")
    {
        if (a == "Product")
        {
            <tr>
                <td style="display:none">
                    <input type="text" name="productgid" id="prod" value="@Model.productGid" />
                </td>
                <td>
                    <div class="form-group">
                        <span>Product Code</span>
                        <br />
                        <input type="text"
                               name="productcode"
                               id="productcode"
                               value="@Model.productCode"
                               class="textboxStyle valid"
                               @ViewBag.viewmode />

                    </div>
                </td>
                <td>
                    <div class="form-group">
                        <span>Product Name</span>
                        <br />
                        <input type="text"
                               name="productname"
                               id="productname"
                               value="@Model.productName"
                               class="textboxStyle valid"
                               @ViewBag.viewmode />

                    </div>
                </td>
                <td>
                    <div class="form-group">
                        <span>Product Description</span>
                        <br />
                        <input type="text"
                               name="productDescription"
                               id="productDescription"
                               value="@Model.productDescription"
                               class="textboxStyle valid"
                               @ViewBag.viewmode />

                    </div>
                </td>
            </tr>
        }
    }
            }
            <tr>
                <td>
                    @{
    var parent = (string)Session["parent"];
    if (parent != "")
    {
        if (parent == "Yes")
        {
            <div class="form-group" id="ddlParent">
                <span>Parent</span>
                <br />
                <select id="ddlflag" class="textboxStyle valid" name="ddlflag" @ViewBag.viewmode>
                    <option value="Y" selected="selected">Yes</option>
                    <option value="N">No</option>
                </select>
            </div>
        }
        else
        {
            <div class="form-group" id="ddlParent">
                <span>Parent</span>
                <br />
                <select id="ddlflag" class="textboxStyle valid" name="ddlflag" @ViewBag.viewmode>
                    <option value="Y">Yes</option>
                    <option value="N" selected="selected">No</option>
                </select>
            </div>
        }
    }
                    }
                </td>
                <td>
                    @{
    var prod = (string)Session["parent"];
    if (prod != "")
    {
        if (prod == "Yes")
        {

            <div class="form-group" id="ddlProduct">
                <span>Parent Product</span>
                <br />
                @if (viewfor == "edit")
                {
                    @Html.DropDownList("productParentGid", Model.productList, "--Select--", new { @class = "textboxStyle valid", @id = "productParentGid" })
                }
                else
                {
                    @Html.DropDownList("productParentGid", Model.productList, "--Select--", new { @class = "textboxStyle valid", @id = "productParentGid", @disabled = "disabled" })
                }
            </div>

        }
        else
        {
            <div class="form-group" id="ddlProduct" @ViewBag.viewmode>
                <span>Parent Product</span>
                <br />
                @if (viewfor == "edit")
                {
                    @Html.DropDownList("productParentGid", Model.productList, new { @class = "textboxStyle valid", @id = "productParentGid" })
                }
                else
                {
                    @Html.DropDownList("productParentGid", Model.productList, new { @class = "textboxStyle valid", @id = "productParentGid", @disabled = "disabled" })
                }
            </div>
        }
    }
                    }
                </td>
            </tr>
        </table>
        <table id="serviceDetailTable" style="margin-left: 15px" class="myTableStyleTabNew">

            @*@{
                var b=(string)Session["productService"];
                if(b!=""){
                if(a=="Service")
                {*@
            <tr>
                <td>
                    <div class="form-group">
                        <span>Service Code</span>
                        <br />
                        <input type="text"
                               name="service"
                               id="service"
                               value="@Model.service"
                               class="textboxStyle valid"
                               @ViewBag.viewmode />

                    </div>
                </td>
                <td>
                    <div class="form-group">
                        <span>Service Name</span>
                        <br />
                        <input type="text"
                               name="servicename"
                               id="servicename"
                               value="@Model.serviceName"
                               class="textboxStyle valid"
                               @ViewBag.viewmode />

                    </div>
                </td>
                <td>
                    <div class="form-group">
                        <span>Service Description</span>
                        <br />
                        <input type="text"
                               name="serviceDescription"
                               id="Servicedescnew"
                               value="@Model.serviceDescription"
                               class="textboxStyle valid"
                               @ViewBag.viewmode />

                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    @{
    var Servparent = (string)Session["parent"];
    if (Servparent != "")
    {
        if (Servparent == "Yes")
        {
            <div class="form-group" id="ddlParent1">
                <span>Parent</span>
                <br />
                <select id="ddlparent" class="textboxStyle valid" name="ddlparent" @ViewBag.viewmode>
                    <option value="Yes" selected="selected">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
        }
        else
        {
            <div class="form-group" id="ddlParent1">
                <span>Parent</span>
                <br />
                <select id="ddlparent" class="textboxStyle valid" name="ddlparent" @ViewBag.viewmode>
                    <option value="Yes">Yes</option>
                    <option value="No" selected="selected">No</option>
                </select>
            </div>
        }
    }
                    }
                </td>
                <td>
                    @{
    var b = (string)Session["parent"];
    if (b != "")
    {
        if (b == "Yes")
        {
            <div class="form-group" id="ddlservice">
                <span>Parent Service</span>
                <br />
                @if (viewfor == "edit")
                {
                    @Html.DropDownList("serviceParentGid", Model.serviceList, "--Select--", new { @class = "textboxStyle valid", @id = "serviceParentGid" })
                }
                else
                {
                    @Html.DropDownList("serviceParentGid", Model.serviceList, "--Select--", new { @class = "textboxStyle valid", @id = "serviceParentGid", @disabled = "disabled" })
                }
            </div>
        }
        else
        {
            <div class="form-group" id="ddlservice">
                <span>Parent Service</span>
                <br />
                @if (viewfor == "edit")
                {
                    @Html.DropDownList("serviceParentGid", Model.serviceList, new { @class = "textboxStyle valid", @id = "serviceParentGid" })
                }
                else
                {
                    @Html.DropDownList("serviceParentGid", Model.serviceList, new { @class = "textboxStyle valid", @id = "serviceParentGid", @disabled = "disabled" })
                }
            </div>
        }
    }
                    }
                </td>
            </tr>
        </table>

    </div>
    <br />
    <table class="myTableStyleTabNew" >
        <tr>
            <td>
                <input type="radio" id="radioAsset" value="Asset" name="RadioGL" @ViewBag.viewmode /> Asset
                <input type="radio" id="radioExpense" value="Expense" name="RadioGL" @ViewBag.viewmode /> Expense
            </td>
        </tr>
    </table>
    <br />
    @*<div class="borderStyle">
        <table class="myTableStyleTabNew" style="margin-top:15px;margin-left:10px;">
            <tr>
                <td>
                    <table>
                        <tr>
                            <td>
                                <div id="dropAsset">
                                    <span>Asset Category</span>
                                    <br />
                                    @{
    var asset = (string)Session["Category"];
    if (asset != "")
    {
        if (asset == "Asset")
        {
            if (viewfor == "edit")
            {
                @Html.DropDownList("assetGid", Model.categoryList, "--Select--", new { @class = " textboxStyleBig valid", @style="width: 175px;", @id = "assetGid" })
            }
            else
            {
                @Html.DropDownList("assetGid", Model.categoryList, "--Select--", new { @class = "textboxStyleBig valid",@style="width: 175px;", @id = "assetGid", @disabled = "disabled" })
            }
        }
        else
        {
            if (viewfor == "edit")
            {
                @Html.DropDownList("assetGid", Model.categoryList, "--Select--", new { @class = "textboxStyleBig valid",@style="width: 175px;", @id = "assetGid" })
            }
            else
            {
                @Html.DropDownList("assetGid", Model.categoryList, "--Select--", new { @class = "textboxStyleBig valid", @style="width: 175px;", @id = "assetGid", @disabled = "disabled" })
            }
        }
    }
                                    }

                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr>
                            <td>
                                <div class="form-group" id="dropExpense">
                                    <span>Expense Category</span>
                                    <br />
                                    @{
    var expense = (string)Session["Category"];
    if (expense != "")
    {
        if (expense == "Expense")
        {
            if (viewfor == "edit")
            {
                @Html.DropDownList("expenseGid", Model.expenseList, "--Select--", new { @class = "textboxStyle valid",@style="width: 175px;", @id = "expenseGid" })
            }
            else
            {
                @Html.DropDownList("expenseGid", Model.expenseList, "--Select--", new { @class = "textboxStyle valid",@style="width: 175px;", @id = "expenseGid", @disabled = "disabled" })
            }
        }
        else
        {
            if (viewfor == "edit")
            {
                @Html.DropDownList("expenseGid", Model.expenseList, "--Select--", new { @class = "textboxStyle valid",@style="width: 175px;", @id = "expenseGid" })
            }
            else
            {
                @Html.DropDownList("expenseGid", Model.expenseList, "--Select--", new { @class = "textboxStyle valid",@style="width: 175px;", @id = "expenseGid", @disabled = "disabled" })
            }
        }
    }
                                    }
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr>
                            <td>
                                <div class="form-group">
                                    <span>GL Code</span>
                                    <br />
                                    <input type="text" name="glCode" style="width:168px" class="textboxStyle valid" value="@Model.glCode"
                                           disabled="disabled" id="glCode" @ViewBag.viewmode />
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>

        </table>
    </div>*@
     <div class="borderStyle assetexpenseedit">
        <table class="myTableStyleTabNew" style="margin-left: 15px">
            <tr>

                <td>

                    <table>
                        <tr>
                            <td>
                                <div class="form-group" id="dropAsset">
                                    <span>Asset Category</span>
                                    <br />
                                    @*@Html.DropDownList("asssetGid", Model.categoryList, "--Select--", new { @class = "textboxStyle required" })*@
                                    @Html.DropDownListFor(j => j.SelectedAssetCatGid, Model.categoryList, "--select--", new { @class = "textboxStyle", @id = "SelectedAssetCatGidEdit" })
                                </div>
                            </td>
                        </tr>
                    </table>

                </td>
                <td>
                    <table>
                        <tr>
                            <td>
                                <div class="form-group" id="dropExpense">
                                    <span>Asset Sub Category</span>
                                    <br />
                                    @*@Html.DropDownList("AssetSubCatGid", Model.AssetSubCatList, "--Select--", new { @class = "textboxStyle required" })*@
                                    @Html.DropDownListFor(j => j.SelectedAssetSubCatGid, Model.AssetSubCatList, "--select--", new { @class = "textboxStyle", @id = "SelectedAssetSubCatGidEdit" })
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr>
                            <td>
                                <div class="form-group">
                                    <span>GL Code</span>
                                    <br />
                                    <input type="text" name="glCode" class="textboxStyle required" id="glCode" disabled="disabled" />
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>
    <br />
    <div class="borderStyle assetexpenseedit1">
        <table class="myTableStyleTabNew" style="margin-left: 15px">
            <tr>

                <td>

                    <table>
                        <tr>
                            <td>
                                <div class="form-group" id="dropAsset">
                                    <span>Expense Nature</span>
                                    <br />
                                    @*@Html.DropDownList("asssetGid", Model.categoryList, "--Select--", new { @class = "textboxStyle required" })*@
                                    @Html.DropDownListFor(j => j.SelectedExpNatureGid, Model.ExpNatureList, "--select--", new { @class = "textboxStyle", @id = "SelectedExpNatureGidEdit" })
                                </div>
                            </td>
                        </tr>
                    </table>

                </td>
                <td>
                    <table>
                        <tr>
                            <td>
                                <div class="form-group" id="dropExpense">
                                    <span>Expense Category</span>
                                    <br />
                                    @*@Html.DropDownList("expenseGid", Model.expenseList, "--Select--", new { @class = "textboxStyle required" })*@
                                    @Html.DropDownListFor(j => j.SelectedExpGid, Model.expenseList, "--select--", new { @class = "textboxStyle SelectedExpGid1", @id = "SelectedExpGidEdit" })
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table>
                        <tr>
                            <td>
                                <div class="form-group">
                                    <span>GL Code</span>
                                    <br />
                                    <input type="text" name="glCode1" class="textboxStyle required" id="glCode1" disabled="disabled" />
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>
     <table class="myTableStyleTabNew" align="center">
        <tr>
            <td>
                <div style="float:right;padding-right: 44px;margin-left: 15px;margin-top:16px;">
                    @if (viewfor == "view")
                    {
                        <button type="button" class="btn btn-warning" value="Close" onclick="GotoIndex()"><span style="color:white;" class="glyphicon glyphicon-remove"></span> Close</button>
                    }
                    @if (viewfor == "delete")
                    {
                        <button type="button" class="btn btn-danger" value="Delete" onclick="DeleteProdServ()" ><span class="glyphicon glyphicon-trash" style="color:white;"></span> Delete</button>
                        <button type="button" class="btn btn-warning" value="Close" onclick="GotoIndex()"><span style="color:white;" class="glyphicon glyphicon-remove"></span> Close</button>
                        
                    }
                   @if(ViewBag.viewmode=="")
                    { 
                    <button type="button" id="prodeditsave" name="command" class="btn btn-primary" value="Save"><span class="glyphicon glyphicon-floppy-disk" style="color:white;"></span> Save</button>
                    @*<input type="button" id="savebtn" value="Save" class="btn btn-primary" <span class="glyphicon glyphicon-floppy-disk" style="color:white;"></span>*@
                    <button type="button" class="btn btn-warning" value="Cancel" onclick="GotoIndex()"><span style="color:white;" class="glyphicon glyphicon-remove-sign"></span> Cancel</button>
                    @*<input type="button" value="Cancel" class="btn btn-warning" onclick="GotoIndex()" />*@
                    }
                </div>
            </td>
        </tr>
    </table>

    @*<div style="float:right;padding-right: 44px;margin-left: 100px;margin-top:16px;">
        <table>
            <tr>
                <td>
                    <input type="button" name="btnS" id="savebtn"  value="Save" class="btn btn-primary" @ViewBag.viewmode />
                    <input type="button" name="command" value="Cancel" class="btn btn-warning" onclick="GotoIndex()" />
                </td>
            </tr>
        </table>
    </div>*@

    <script type="text/javascript">
        $(document).ready(function () {
            //$("#productcode").attr("maxlength", "16");
            $("#productname").attr("maxlength", "64");
            $("#productDescription").attr("maxlength", "256");
            //$("#service").attr("maxlength", "16");
            $("#servicename").attr("maxlength", "64");
            $("#Servicedescnew").attr("maxlength", "256");
            var product = $('#hidRadio').val();
            if (product == "Service") {
                $('#radioService:input').attr('checked', true);
                $("#serviceDetailTable").fadeIn();
                $("#productDetailTable").fadeOut(0);
                $('#radioProduct:input').attr('disabled', true);
                $('#service:input').attr('disabled', true);
            }
            if (product == "Product") {
                $('#radioProduct:input').attr('checked', true);
                $("#productDetailTable").fadeIn();
                $("#serviceDetailTable").fadeOut(0);
                $('#radioService:input').attr('disabled', true);
                $('#productcode:input').attr('disabled', true);
            }
            var parent = $('#hidParent').val();
            if (parent == "Yes") {
                $('#ddlflag').val("Y");
                $('#ddlflag1').val("Y");
                $('#ddlProduct :input').attr('disabled', true);
                $('#ddlservice :input').attr('disabled', true);
                $('#ddlParent1 :input').attr('disabled', true);
                $('#ddlParent :input').attr('disabled', true);
            }
            if (parent == "No") {
                $('#ddlflag').val("N");
                $('#ddlparent').val("No");
            }
            var Category = $('#hidCategory').val();
            if (Category == "Asset") {
                $('#radioAsset:input').attr('checked', true);
                $('#radioExpense:input').attr('disabled', true);
                $('#dropExpense :input').attr('disabled', true);
            }
            if (Category == "Expense") {
                $('#radioExpense:input').attr('checked', true);
                $('#radioAsset:input').attr('disabled', true);
                $('#dropAsset :input').attr('disabled', true);
            }

            $("#productname,#productDescription,#servicename,#Servicedescnew").keypress(function (event) {

                return isAlphaNumericWithSingleQuote(event);

            });
            $("#productname").attr("maxlength", "64");
            $("#productDescription").attr("maxlength", "256");
            $("#servicename").attr("maxlength", "64");
            $("#servicedesc").attr("maxlength", "256");
        });
        //for disabling and enabling category dropdown
        $('#radioAsset').change(function () {

            //$(".assetexpense").show();
            //$("#expenseGid").val("--Select--");
            //$("#glCode").val("");
            var parentflag = $("#ddlflag option:selected").val();
            if (parentflag == "" || parentflag == "--Select--") {

                jAlert("Please Select Parent", "Error", function (e) {
                    if (e == true) {
                        $("#ddlflag").focus();

                    }
                });
                $('#radioAsset').removeAttr("checked");
                return false;
            }
            $(".assetexpense").show();
            $(".assetexpense1").hide();
            $("#SelectedExpGid").val("");
            $("#SelectedExpNatureGid").val("");
            if (parentflag == "Y") {
                $("#SelectedAssetSubCatGid").empty();
                $("#SelectedAssetSubCatGid").append("<option value='0' >--Select--</option>");
                $('#SelectedAssetSubCatGid').val('0');
                $('#SelectedAssetSubCatGid').attr('disabled', true);
            }
            $('#dropExpense :input').attr('disabled', true);
            $('#dropAsset :input').attr('disabled', false);
        });

        $('#radioExpense').change(function () {
            $(".assetexpense").show();
            $("#assetGid").val("--Select--");
            $("#glCode").val("");
            $('#dropAsset :input').attr('disabled', true);
            $('#dropExpense :input').attr('disabled', false);

        });

        $('#ddlflag').change(function () {
            var e = document.getElementById("ddlflag");
            var strUser = e.options[e.selectedIndex].text;
            jAlert(strUser);
            if (strUser == 'Yes') {

                $('#ddlProduct :input').attr('disabled', true);
            }
            else {
                $('#ddlProduct :input').removeAttr('disabled');
            }
        });
        $('#ddlparent').change(function () {
            var e = document.getElementById("ddlparent");
            var parent = e.options[e.selectedIndex].text;
            if (parent == 'Yes') {

                $('#ddlservice :input').attr('disabled', true);
            }
            else {
                $('#ddlservice :input').removeAttr('disabled');
            }
        });

        $("#assetGid").change(function () {
            var asset = $("#assetGid").val();
            if (asset.trim() != "") {
                $("#assetGid").removeClass('required');
                $("#assetGid").addClass('valid');
            }
            else {
                $("#assetGid").removeClass('valid');
                $("#assetGid").addClass('required');
            }
            var select = $("#assetGid").val();
            if (select == "") {
                $("#glCode").val("");
                return false;
            }
            else {
                $.ajax({
                    url: '@Url.Action("Assetglcode", "FbProductService")',
                    dataType: 'json',
                    data: { id: $(this).val() },
                    success: function (msg) {
                        $("#glCode").val("");
                        $("#glCode").attr("value", msg);
                        if ($("#glCode").val() != null || $("#glCode").val() != "") {
                            $("#glCode").addClass("valid");
                        }
                    },
                    error: function () { }
                });
            }
        });

        $("#expenseGid").change(function () {
            var expense = $("#expenseGid").val();
            if (expense.trim() != "") {
                $("#expenseGid").removeClass('required');
                $("#expenseGid").addClass('valid');
            }
            else {
                $("#expenseGid").removeClass('valid');
                $("#expenseGid").addClass('required');
            }
            var selected = $("#expenseGid").val();
            if (selected == "") {
                $("#glCode").val("");
                return false;
            }
            else {
                $.ajax({
                    url: '@Url.Action("Expenseglcode", "FbProductService")',
                    dataType: 'json',
                    data: { id: $(this).val() },
                    success: function (msg) {
                        $("#glCode").val("");
                        $("#glCode").attr("value", msg);
                        if ($("#glCode").val() != null || $("#glCode").val() != "") {
                            $("#glCode").addClass("valid");
                        }

                    },
                    error: function () { }
                });
            }
        });

        $('#prodeditsave').click(function () {


            var productType = $("input[name='Radio']:checked").val();
            var serviceType = $("input[name='Radio']:checked").val();
            if (productType == null || productType == "" || serviceType == null || serviceType == "") {
                jAlert("Please Select Type", "Error");
                return false;
            }

            if (productType == "Product") {

                var productName = $("#productname").val();
                var productDescription = $("#productDescription").val();
                var parentflag = $("#ddlflag option:selected").val();
                var e = document.getElementById("ddlflag");
                var selectedparent = e.options[e.selectedIndex].text;
                var parentproduct = $("#productParentGid option:selected").text();



                if (productName == null || productName == "") {
                    jAlert("Please Enter Product Name", "Error", function (e) {
                        if (e == true) {
                            $("#productname").focus();

                        }
                    });
                    return false;
                }
                else if (productDescription == null || productDescription == "") {
                    jAlert("Please Enter Product Description", "Error", function (e) {
                        $("#productDescription").focus();

                    });
                    return false;
                }
                else if (parentflag == "--Select--") {
                    jAlert("Please Select Parent", "Error", function (e) {
                        if (e == true) {
                            $("#ddlflag").focus();
                        }
                    });
                    return false;
                }
                else if (selectedparent == "No" & parentproduct == "--Select--") {
                    jAlert("Please Select Parent Product", "Error", function (e) {
                        if (e == true) {
                            $("#productParentGid").focus();
                        }
                    });
                    return false;
                }
                var assetType = $("input[name='RadioGL']:checked").val();
                var expenseType = $("input[name='RadioGL']:checked").val();
                if (assetType == null || assetType == "" || expenseType == null || expenseType == "") {
                    jAlert("Please Select Category Type", "Error");
                    return false;
                }
                if (assetType == "Asset") {
                    var assetCategory = $("#assetGid option:selected").text();
                    if (assetCategory == "--Select--") {
                        jAlert("Please Select Asset Category", "Error", function (e) {
                            if (e == true) {

                                $("#assetGid").focus();
                            }
                        });
                        return false;
                    }
                    else {
                        var parentgid = $("#productgid").val();
                        var assetType = $("input[name='RadioGL']:checked").val();
                        var assetCategory = $("#assetGid").val();
                        var expenseCategory = $("#expenseGid").val();
                        var productid = $("#productid").val();
                        var parentproductid = $("#productParentGid").val();
                        var objDetails =
                       {

                           "productName": productName,
                           "productDescription": productDescription,
                           "parentFlag": selectedparent,
                           "productParentGid": parentproductid,
                           "productServflag": productType,
                           "category": assetType,
                           "assetGid": assetCategory,
                           "expenseGid": expenseCategory,
                           "productId": productid
                       };
                        $.post('../FbProductService/Edit', objDetails,
                           function (data) {
                               if (data == 0) {
                                   jAlert("Duplicate Record!", "Error");
                                   return false;
                               }
                               else {
                                   jAlert("Record Updated Successfully", "Information", function (e) {
                                       if (e == true) {
                                           location = '../FbProductService/Index';
                                       }
                                   });

                               }
                           }, 'json');
                    }
                }
                if (expenseType == "Expense") {
                    var expenseCategory = $("#expenseGid option:selected").text();
                    if (expenseCategory == "--Select--") {
                        jAlert("Please Select Expense Category", "Error", function (e) {
                            if (e == true) {
                                $("#expenseGid").focus();
                            }
                        });
                        return false;
                    }
                    else {
                        var parentgid = $("#productgid").val();
                        var ExpenseType = $("input[name='RadioGL']:checked").val();
                        var assetCategory = $("#assetGid").val();
                        var expenseCategory = $("#expenseGid").val();
                        var productid = $("#productid").val();
                        var parentproductid = $("#productParentGid").val();
                        var objDetails =
                       {

                           "productName": productName,
                           "productDescription": productDescription,
                           "parentFlag": selectedparent,
                           "productParentGid": parentproductid,
                           "productServflag": productType,
                           "category": ExpenseType,
                           "assetGid": assetCategory,
                           "expenseGid": expenseCategory,
                           "productId": productid
                       };
                        $.post('../FbProductService/Edit', objDetails,
                           function (data) {
                               if (data == 0) {
                                   jAlert("Duplicate Record! ", "Error");
                                   return false;
                               }
                               else {
                                   jAlert("Record Updated Successfully", "Information", function (e) {
                                       if (e == true) {
                                           location = '../FbProductService/Index';
                                       }
                                   });

                               }
                           }, 'json');
                    }
                }

            }

            if (serviceType == "Service") {

                var serName = $("#servicename").val();
                var serDesc = $("#Servicedescnew").val();
                alert(serDesc);
                var parentflag = $("#ddlparent option:selected").val();
                var e = document.getElementById("ddlparent");
                var selectedparent = e.options[e.selectedIndex].text;
                var parentservice = $("#serviceParentGid option:selected").text();



                if (serName == null || serName == "") {
                    jAlert("Please Enter Service Name", "Error", function (e) {
                        if (e == true) {
                            $("#servicename").focus();

                        }
                    });
                    return false;
                }
                else if (serDesc == null || serDesc == "") {
                    jAlert("Please Enter Service Description", "Error", function (e) {
                        $("#Servicedescnew").focus();

                    });
                    return false;
                }
                else if (selectedparent == "No" && parentservice == "--Select--") {
                    jAlert("Please select Parent product", "Error", function (e) {
                        if (e == true) {
                            $("#ddlparent").focus();
                        }
                    });
                    return false;
                }

                var assetType = $("input[name='RadioGL']:checked").val();
                var expenseType = $("input[name='RadioGL']:checked").val();
                if (assetType == null || assetType == "" || expenseType == null || expenseType == "") {
                    jAlert("Please Select Category Type", "Error");
                    return false;
                }
                if (assetType == "Asset") {
                    var assetCategory = $("#assetGid option:selected").text();
                    if (assetCategory == "--Select--") {
                        jAlert("Please Select Asset Category", "Error", function (e) {
                            if (e == true) {

                                $("#assetGid").focus();
                            }
                        });
                        return false;
                    }
                    else {
                        var servicegid = $("#servicegid").val();
                        var assetType = $("input[name='RadioGL']:checked").val();
                        var assetCategory = $("#assetGid").val();
                        var expenseCategory = $("#expenseGid").val();
                        var productid = $("#productid").val();
                        var objDetails =
                     {

                         "serviceName": serName,
                         "serviceDescription": serDesc,
                         "parentFlag": selectedparent,
                         "servicegid": servicegid,
                         "productServflag": productType,
                         "category": assetType,
                         "assetGid": assetCategory,
                         "expenseGid": expenseCategory,
                         "productId": productid
                     };
                        $.post('../FbProductService/Edit', objDetails,
                             function (data) {
                                 if (data == 0) {
                                     jAlert("Duplicate Record!", "Error");
                                     return false;
                                 }
                                 else {
                                     jAlert("Record Updated Successfully", "Information", function (e) {
                                         if (e == true) {
                                             location = '../FbProductService/Index';
                                         }
                                     });
                                 }
                             }, 'json');
                    }
                }
                if (expenseType == "Expense") {
                    var expenseCategory = $("#expenseGid option:selected").text();
                    if (expenseCategory == "--Select--") {
                        jAlert("Please Select Expense Category", "Error", function (e) {
                            if (e == true) {
                                $("#expenseGid").focus();
                            }
                        });
                        return false;
                    }
                    else {
                        var servicegid = $("#servicegid").val();
                        var expenseType = $("input[name='RadioGL']:checked").val();
                        var assetCategory = $("#assetGid").val();
                        var expenseCategory = $("#expenseGid").val();
                        var productid = $("#productid").val();
                        var serviceparentid = $("#serviceParentGid").val();
                        var objDetails =
                     {

                         "serviceName": serName,
                         "serviceDescription": serDesc,
                         "parentFlag": selectedparent,
                         "servicegid": servicegid,
                         "serviceParentGid": serviceparentid,
                         "productServflag": productType,
                         "category": expenseType,
                         "assetGid": assetCategory,
                         "expenseGid": expenseCategory,
                         "productId": productid
                     };
                        $.post('../FbProductService/Edit', objDetails,
                             function (data) {
                                 if (data == 0) {
                                     jAlert("Duplicate Record!", "Error");
                                     return false;
                                 }
                                 else {
                                     jAlert("Record Updated Successfully", "Information", function (e) {
                                         if (e == true) {
                                             location = '../FbProductService/Index';
                                         }
                                     });
                                 }
                             }, 'json');
                    }
                }
            }
        });
        function GotoIndex() {
            $('#prodservgrid').find('tr').css('background', 'none');
            window.parent.jQuery('#ForPartialView').dialog('close');
        }

        //onkey function for checking validation
        $("#productname").keyup(function () {
            var txtproductname = $("#productname").val();
            if (txtproductname.trim() != "") {
                $("#productname").removeClass('required');
                $("#productname").addClass('valid');
            }
            else {
                $("#productname").removeClass('valid');
                $("#productname").addClass('required');
            }
        });
        $("#productDescription").keyup(function () {
            var txtproductdesc = $("#productDescription").val();
            if (txtproductdesc.trim() != "") {
                $("#productDescription").removeClass('required');
                $("#productDescription").addClass('valid');
            }
            else {
                $("#productDescription").removeClass('valid');
                $("#productDescription").addClass('required');
            }
        });

        $("#servicename").keyup(function () {
            var txtservicename = $("#servicename").val();
            if (txtservicename.trim() != "") {
                $("#servicename").removeClass('required');
                $("#servicename").addClass('valid');
            }
            else {
                $("#servicename").removeClass('valid');
                $("#servicename").addClass('required');
            }
        });
        $("#Servicedescnew").keyup(function () {
            var txtservicedesc = $("#Servicedescnew").val();
            if (txtservicedesc.trim() != "") {
                $("#Servicedescnew").removeClass('required');
                $("#Servicedescnew").addClass('valid');
            }
            else {
                $("#Servicedescnew").removeClass('valid');
                $("#Servicedescnew").addClass('required');
            }
        });

        var glcode = $("#glCode").val();
        if (glcode == null || glcode == "") {
            $("#glCode").addClass('required');
        }
        else {
            $("#glCode").addClass('valid');
        }
        $("#ddlflag").change(function () {
            var parentflag = $("#ddlflag option:selected").val();
            if (parentflag.trim() != "") {
                $("#ddlflag").removeClass('required');
                $("#ddlflag").addClass('valid');
            }
            else {
                $("#ddlflag").removeClass('valid');
                $("#ddlflag").addClass('required');
            }
        });
        $("#ddlparent").change(function () {
            var parentflag = $("#ddlparent option:selected").val();
            if (parentflag.trim() != "") {
                $("#ddlparent").removeClass('required');
                $("#ddlparent").addClass('valid');
            }
            else {
                $("#ddlparent").removeClass('valid');
                $("#ddlparent").addClass('required');
            }
        });
        $("#productParentGid").change(function () {
            var productparent = $("#productParentGid").val();
            if (productparent.trim() != "") {
                $("#productParentGid").removeClass('required');
                $("#productParentGid").addClass('valid');
            }
            else {
                $("#productParentGid").removeClass('valid');
                $("#productParentGid").addClass('required');
            }
        });
        $("#serviceParentGid").change(function () {
            var serviceparent = $("#serviceParentGid").val();
            if (serviceparent.trim() != "") {
                $("#serviceParentGid").removeClass('required');
                $("#serviceParentGid").addClass('valid');
            }
            else {
                $("#serviceParentGid").removeClass('valid');
                $("#serviceParentGid").addClass('required');
            }
        });
        $(".ui-icon-closethick").click(function () {
            $('#prodservgrid').find('tr').css('background', 'none');
        });
        function DeleteProdServ()
        {
            var prodservId = $("#productid").val();
            jConfirm("Do you want to delete this?", "Delete product/service", function (r) {
                if (r == true) {
                    var objdel =
                    {
                        "productGid": prodservId,
                    };
                    $.post('../FbProductService/Delete', objdel,
                         function (data) {
                             if (data == 0) {
                                 jAlert("Please Delete Child Product/Service First", "Error");
                                 return false;
                             }
                             else {
                                 jAlert("Record Deleted Successfully", "Success", function (e) {
                                     if (e == true) {
                                         location = '../FbProductService/Index';
                                     }
                                 });
                             }
                         }, 'json');
                }
            });
        }
    </script>
}
