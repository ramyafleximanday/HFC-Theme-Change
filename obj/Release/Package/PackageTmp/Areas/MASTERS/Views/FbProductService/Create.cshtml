@model IEM.Areas.MASTERS.Models.FbEntity
@{
    Model.AssetSubCatList = new SelectList(Enumerable.Empty<SelectListItem>());
    Model.expenseList = new SelectList(Enumerable.Empty<SelectListItem>());
}
<link href="@Url.Content("~/Content/Rmax_Site.css")" rel="stylesheet" type="text/css" />
<style>
    .borderStyle {
        border-radius: 5px;
        opacity: 50;
        border: 1px solid #ada8a8;
        height: 100%;
        padding: 8px;
    }
</style>
@using (Html.BeginForm())
{
    <table class="myTableStyleTabNew" width="100%">
        <tr>
            <td>
                <input type="radio" id="radioProduct" value="Product" name="Radio" /> Product
                <input type="radio" id="radioService" value="Service" name="Radio" /> Service
            </td>
        </tr>
    </table>
    
    <div style="max-height: 383px; min-height:380px; width:100%; overflow: auto; height:100%;">
        <div id="ProductServiceDetails" style="margin-top:5px;" class="borderStyle product">
            <table id="productDetailTable" class="myTableStyleTabNew" width="100%">
                <tr>
                    <td style="width:33%;">
                        <span>Product Code</span>
                        <br />
                        <input type="text"
                               name="productcode"
                               id="productcode"
                               class="textboxStyle required" />
                    </td>
                    <td style="width:33%;">
                        <span>Product Name</span>
                        <br />
                        <input type="text"
                               name="productname"
                               id="productname"
                               class="textboxStyle required" />
                    </td>
                    <td style="width:33%;">
                        <span>Product Description</span>
                        <br />
                        <input type="text"
                               name="productDescription"
                               id="productDescription"
                               class="textboxStyle required" />
                    </td>
                </tr>
                <tr>
                    <td style="width:33%;">
                        <div id="parentflag">
                            <span>Parent</span>
                            <br />
                            <select id="ddlflag" class="textboxStyle required ddlflag" name="ddlflag">
                                <option selected="selected">--Select--</option>
                                <option value="Y">Yes</option>
                                <option value="N">No</option>
                            </select>
                        </div>
                    </td>
                    <td style="width:33%;">
                            <span>Parent Product</span>
                            <br />
                            @Html.DropDownList("parentProductGid", Model.productList, "--Select--", new { @class = "textboxStyle required" })
                    </td>
                    <td style="width:33%;"></td>
                </tr>
            </table>
            <table id="serviceDetailTable" class="myTableStyleTabNew" width="100%">
                <tr>
                    <td style="width:33%;">
                        <span>Service Code</span>
                        <br />
                        <input type="text"
                               name="service"
                               id="service"
                               class="textboxStyle required" />
                    </td>
                    <td style="width:33%;">
                        <span>Service Name</span>
                        <br />
                        <input type="text"
                               name="servicename"
                               id="servicename"
                               class="textboxStyle required" />
                    </td>
                    <td style="width:33%;">
                        <span>Service Description</span>
                        <br />
                        <input type="text"
                               name="serviceDescription"
                               id="servicedesc"
                               class="textboxStyle required" />
                    </td>
                </tr>
                <tr>
                    <td style="width:33%;">
                        <span>Parent</span>
                        <br />
                        <select id="ddlparent" class="textboxStyle required ddlflag" name="ddlparent">
                            <option id="myOption" selected="selected" value="--Select--">--Select--</option>
                            <option value="Y">Yes</option>
                            <option value="N">No</option>
                        </select>
                    </td>
                    <td style="width:33%;">
                        <div id="ddlService">
                            <span>Parent Service</span>
                            <br />
                            @Html.DropDownList("serviceGid", Model.serviceList, "--Select--", new { @class = "textboxStyle required" })
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <table class="myTableStyleTabNew" style="margin-top:5px;" width="100%">
            <tr>
                <td>
                    <div id="radassetexp">
                        <input type="radio" id="radioAsset"  class="radioAssetExpense" value="Asset" name="RadioGL" /> Asset
                        <input type="radio" id="radioExpense" class="radioAssetExpense" value="Expense" name="RadioGL" /> Expense
                    </div>
                </td>
            </tr>
        </table>
        <div class="borderStyle assetexpense" style="margin-top:5px;">
            <table class="myTableStyleTabNew" width="100%">
                <tr>
                    <td style="width:33%;">
                        <div id="dropAsset">
                            <span>Asset Category</span>
                            <br />
                            @Html.DropDownListFor(j => j.SelectedAssetCatGid, Model.categoryList, "--select--", new { @class = "textboxStyle", @id = "SelectedAssetCatGid" })
                        </div>

                    </td>
                    <td style="width:33%;">
                        <div id="dropExpense">
                            <span>Asset Sub Category</span>
                            <br />
                            @Html.DropDownListFor(j => j.SelectedAssetSubCatGid, Model.AssetSubCatList, "--select--", new { @class = "textboxStyle", @id = "SelectedAssetSubCatGid" })
                        </div>

                    </td>
                    <td style="width:33%;">
                        <span>GL Code</span>
                        <br />
                        <input type="text" name="glCode" class="textboxStyle required" id="glCode" disabled="disabled" />
                    </td>
                </tr>
            </table>
        </div>
        <div class="borderStyle assetexpense1" style="margin-top:5px;">
            <table class="myTableStyleTabNew" width="100%">
                <tr>
                    <td style="width:33%;">
                        <div id="dropAsset">
                            <span>Expense Nature</span>
                            <br />
                            @Html.DropDownListFor(j => j.SelectedExpNatureGid, Model.ExpNatureList, "--select--", new { @class = "textboxStyle", @id = "SelectedExpNatureGid" })
                        </div>
                    </td>
                    <td style="width:33%;">

                        <div id="dropExpense">
                            <span>Expense Category</span>
                            <br />
                            @Html.DropDownListFor(j => j.SelectedExpGid, Model.expenseList, "--select--", new { @class = "textboxStyle SelectedExpGid1", @id = "SelectedExpGid1" })
                        </div>

                    </td>
                    <td style="width:33%;">
                        <span>GL Code</span>
                        <br />
                        <input type="text" name="glCode1" class="textboxStyle required" id="glCode1" disabled="disabled" />
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <table class="myTableStyleTabNew" style="margin-top:5px;" width="100%">
        <tr>
            <td>
                <div style="text-align:right;">
                    <button type="button" id="prodsavebtn" name="command" class="btn btn-primary" value="Save"><span class="glyphicon glyphicon-floppy-disk" style="color:white;"></span> Save</button>
                    <button type="button" class="btn btn-warning" value="Cancel" onclick="ProdServClose()"><span style="color:white;" class="glyphicon glyphicon-remove-sign"></span> Cancel</button>
                </div>
            </td>
        </tr>
    </table>

    <script type="text/javascript">

        $(document).ready(function () {
            $("#productcode, #service,#productname,#productDescription,#service,#servicename,#servicedesc").keypress(function (event) {
                return isAlphaNumericWithSingleQuote(event);
            });

            $("#ddlflag, #parentProductGid, #ddlparent, #serviceGid, #SelectedAssetCatGid, #SelectedAssetSubCatGid, #SelectedExpNatureGid, #SelectedExpGid1").chosen({});
            $("#ddlflag_chosen, #parentProductGid_chosen, #ddlparent_chosen, #serviceGid_chosen, #SelectedAssetCatGid_chosen, #SelectedAssetSubCatGid_chosen, #SelectedExpNatureGid_chosen, #SelectedExpGid1_chosen").css('width', '100%');
            
            $("#ddlflag_chosen, #parentProductGid_chosen, #ddlparent_chosen, #serviceGid_chosen").addClass('mychosen');
            $("#SelectedAssetCatGid_chosen, #SelectedAssetSubCatGid_chosen, #SelectedExpNatureGid_chosen, #SelectedExpGid1_chosen").addClass('mychosensmall');

            $("#productcode").attr("maxlength", "16");
            $("#productname").attr("maxlength", "64");
            $("#productDescription").attr("maxlength", "256");
            $("#service").attr("maxlength", "16");
            $("#servicename").attr("maxlength", "64");
            $("#servicedesc").attr("maxlength", "256");

            $("#serviceDetailTable").fadeOut(0);
            $("#productDetailTable").fadeOut(0);

            $(".borderStyle").hide();
            $("#radassetexp").hide();

            $('#productcode, #service').keypress(function () {
                $(this).attr('maxlength', '8')
            });

        });

        //for selecting product or service through radio button
        $('#radioService').change(function () {
            $('#radioService').checked == true
            {
                $(".product").show();
                $("#productDetailTable").fadeOut(0);
                $("#serviceDetailTable").fadeIn();
                $('#radioService').attr('checked', 'checked');
                $("#service,#servicename,#servicedesc").val('');

                $("#ddlparent").val('--Select--').trigger('chosen:updated');
                $("#serviceGid").val('').trigger('chosen:updated');
                
                $("#service,#servicename,#servicedesc,#ddlparent_chosen,#serviceGid_chosen").removeClass('required').removeClass('valid');
                $("#service,#servicename,#servicedesc,#ddlparent_chosen,#serviceGid_chosen").addClass('required');

                IsDiableddlService(false);
                IsDiableProductParent(true);

                $("#service").focus();
                $("#radassetexp").show();

                $('.assetexpense, .assetexpense1').hide();
                $('.radioAssetExpense').removeAttr('checked').removeAttr('disabled');
            }
        });

        $('#radioProduct').change(function () {
            $('#radioProduct').checked == true
            {
                $(".product").show();
                $("#serviceDetailTable").fadeOut(0);
                $("#productDetailTable").fadeIn();
                $('#radioProduct').attr('checked', 'checked');
                $("#productcode,#productname,#productDescription").val('');

                $("#productcode,#productname,#productDescription,#parentProductGid_chosen,#ddlflag_chosen").removeClass('required').removeClass('valid');
                $("#productcode,#productname,#productDescription,#parentProductGid_chosen,#ddlflag_chosen").addClass('required');

                $("#parentProductGid").val('').trigger('chosen:updated');
                $("#ddlflag").val('--Select--').trigger('chosen:updated');
                $("#serviceGid").val('').trigger('chosen:updated');
                $("#expenseGid").val('').trigger('chosen:updated');
                
                IsDiableProductParent(false);
                IsDiableddlService(true);

                $("#radassetexp").show();
                $("#productcode").focus();

                $('.assetexpense, .assetexpense1').hide();
                $('.radioAssetExpense').removeAttr('checked').removeAttr('disabled');
            }
        });

        //for disabling and enabling category dropdown
        $('#radioAsset').change(function () {
            $(".assetexpense1").hide();
            if (document.getElementById('radioProduct').checked) {
                var parentflag1 = $("#ddlflag option:selected").val();
                if (parentflag1 == "" || parentflag1 == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlflag").focus();

                        }
                    });
                    $('#radioAsset').removeAttr("checked");
                    return false;
                }
            }
            else {
                var parentflag2 = $("#ddlparent option:selected").val();
                if (parentflag2 == "" || parentflag2 == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlparent").focus();

                        }
                    });
                    $('#radioAsset').removeAttr("checked");
                    return false;
                }
            }
            
            $(".assetexpense").show();
            //$(".assetexpense1").hide();
            //$("#SelectedExpGid").val("");
            //$("#SelectedExpNatureGid").val("");
            $("#SelectedExpGid1").val("").trigger('chosen:updated');
            $("#SelectedExpNatureGid").val("").trigger('chosen:updated');

            

            $("#glCode").val("");
            $("#glCode1").val("");

            IsDiabledropExpense(true);
            IsDiabledropAsset(false);
            //$('#dropExpense :input').attr('disabled', true);
            //$('#dropAsset :input').attr('disabled', false);
        });

        $('#radioExpense').change(function () {
            $(".assetexpense").hide();
            if (document.getElementById('radioProduct').checked)
            {
                var parentflag1 = $("#ddlflag option:selected").val();
                if (parentflag1 == "" || parentflag1 == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlflag").focus();

                        }
                    });
                    $('#radioExpense').removeAttr("checked");
                    return false;
                }
            }
            else
            {
                var parentflag2 = $("#ddlparent option:selected").val();
                if (parentflag2 == "" || parentflag2 == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlparent").focus();

                        }
                    });
                    $('#radioExpense').removeAttr("checked");
                    return false;
                }
            }
            
            $(".assetexpense1").show();
            //$("#SelectedAssetSubCatGid").val("");
            $("#SelectedAssetSubCatGid").val("").trigger('chosen:updated');
            $("#SelectedAssetCatGid").val("").trigger('chosen:updated');
            //$("#SelectedAssetCatGid").val("");
            $("#glCode").val("");
            $("#glCode1").val("");
            //$('#dropAsset :input').attr('disabled', true);
            $('#SelectedExpNatureGid :input').attr('disabled', false);
            IsDiabledropExpense(false);
            IsDiabledropAsset(true);
        });

        $('#ddlflag').change(function () {
            $('.assetexpense, .assetexpense1').hide();
            $('.radioAssetExpense').removeAttr('checked').removeAttr('disabled');
            var e = document.getElementById("ddlflag");
            var parent = e.options[e.selectedIndex].text;
            $("#ddlflag_chosen").removeClass('required');
            $("#ddlflag_chosen").addClass('valid');
            $("#glCode, #glCode1").val("");
            $("#SelectedAssetCatGid, #SelectedAssetSubCatGid").val("").trigger('chosen:updated');
            $("#SelectedExpGid1, #SelectedExpNatureGid").val("").trigger('chosen:updated');
            
            if (parent == 'Yes') {
                $("#parentProductGid").val("");
                //$("#parentProductGid").val("--Select--").trigger('chosen:updated');
                //$('#ddlProduct :input').attr('disabled', true);
                IsDiableProductParent(true);
            }
            else {
                //$('#ddlProduct :input').removeAttr('disabled');
                IsDiableProductParent(false);
            }
        });

        $('#ddlparent').change(function () {
            $('.assetexpense, .assetexpense1').hide();
            $('.radioAssetExpense').removeAttr('checked').removeAttr('disabled');
            var e = document.getElementById("ddlparent");
            var parent = e.options[e.selectedIndex].text;
            $("#ddlparent_chosen").removeClass('required');
            $("#ddlparent_chosen").addClass('valid');
            $("#glCode, #glCode1").val("");
            $("#SelectedAssetCatGid, #SelectedAssetSubCatGid").val("").trigger('chosen:updated');
            $("#SelectedExpGid1, #SelectedExpNatureGid").val("").trigger('chosen:updated');
            if (parent == 'Yes') {
                //$("#serviceGid").val("--Select--");
                $("#serviceGid").val("").trigger('chosen:updated');
                //$('#ddlService :input').attr('disabled', true);
                IsDiableddlService(true);
            }
            else {
                IsDiableddlService(false);
                //$('#ddlService :input').removeAttr('disabled');
            }
        });

        $("#SelectedAssetCatGid").change(function () {
            var AssetCatId = $(this).val();
            if (document.getElementById('radioProduct').checked)
            {
                var parentflag = $("#ddlflag option:selected").val();
                if (parentflag == "" || parentflag == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlflag").focus();

                        }
                    });
                    $('#radioAsset').removeAttr("checked");
                    return false;
                }
            }
            else {
                var parentflag1 = $("#ddlparent option:selected").val();
                if (parentflag1 == "" || parentflag1 == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlparent").focus();

                        }
                    });
                    $('#radioAsset').removeAttr("checked");
                    return false;
                }
            }

            var objAssetCat =
            {
                "SelectedAssetCatGid": AssetCatId
            };
            $.ajax({
                url: '@Url.Action("GetAssetSubCat", "FbProductService")',
                data: JSON.stringify(objAssetCat),
                type: 'POST',
                async: false,
                cache: false,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    debugger;
                    console.log(data)
                    $("#SelectedAssetSubCatGid").empty();
                    if (data.length > 0) {
                        console.log(data[0].glCode)
                        $("#glCode").attr("value", data[0].glCode);
                        if ($("#glCode").val() != null && $("#glCode").val() != "") {
                            $("#glCode").addClass("valid");
                        }
                        debugger;
                        //if (parentflag == "Y") {
                        //    $("#SelectedAssetSubCatGid").append("<option value='0' >--Select--</option>");
                        //    $('#SelectedAssetSubCatGid').val('0');
                        //    //$('#SelectedAssetSubCatGid').attr('disabled', true);
                        //    IsDiableAssetSubCatGid(true);
                        //}
                        //else {
                        //$("#SelectedAssetSubCatGid").empty();
                        $("#SelectedAssetSubCatGid").append("<option value='0' >--Select--</option>");
                        for (var i = 0; i < data.length; i++) {
                            //console.log("<option value=" + data[i].AssetSubCatGid + " >" + data[i].AssetSubCat + "</option>")
                                $("#SelectedAssetSubCatGid").append("<option value=" + data[i].AssetSubCatGid + " >" + data[i].AssetSubCat + "</option>");
                            }
                            IsDiableAssetSubCatGid(false);
                        //}

                    }

                    if (data.length == 0) {
                        console.log(data.length)
                        //$("#glCode").attr("value", "");
                        //if ($("#glCode").val() == null || $("#glCode").val() == "") {
                        $("#glCode").val("").removeClass("valid").addClass("required");
                        //}
                        $("#SelectedAssetSubCatGid").empty();
                        $("#SelectedAssetSubCatGid").append("<option value='0' >--Select--</option>");
                        $('#SelectedAssetSubCatGid').val('0');
                        //$('#SelectedAssetSubCatGid').attr('disabled', true);
                        IsDiableAssetSubCatGid(true);

                    }
                },
                error: function (result) {
                    jAlert("Something went wrong", "Message");
                }
            });
        });
        $("#SelectedExpNatureGid").change(function () {
            var AssetCatId = $(this).val();
            if (document.getElementById('radioProduct').checked) {
                var parentflag = $("#ddlflag option:selected").val();
                if (parentflag == "" || parentflag == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlflag").focus();
                        }
                    });
                    $('#radioExpense').removeAttr("checked");
                    return false;
                }
            }
            else {
                var parentflag1 = $("#ddlparent option:selected").val();
                if (parentflag1 == "" || parentflag1 == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlparent").focus();

                        }
                    });
                    $('#radioExpense').removeAttr("checked");
                    return false;
                }
            }
            var objAssetCat =
           {
               "SelectedExpNatureGid": AssetCatId
           };
            $.ajax({
                url: '@Url.Action("GetExpenseCat", "FbProductService")',
                data: JSON.stringify(objAssetCat),
                type: 'POST',
                async: false,
                cache: false,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    console.log(data)
                    $("#SelectedExpGid1").empty();
                    
                    //$("#SelectedExpGid1").val("0");

                    var len = data.length;

                    console.log(len);
                    if (data.length > 0) {
                        $("#glCode1").attr("value", data[0].glCode);
                        if ($("#glCode1").val() != null && $("#glCode1").val() != "") {
                            $("#glCode1").addClass("valid");
                        }
                        $("#SelectedExpGid1").append("<option value='0' >--Select--</option>");
                        for (var i = 0; i < data.length; i++) {
                            $("#SelectedExpGid1").append("<option value=" + data[i].expenseGid + " >" + data[i].expenseCategory + "</option>");
                        }
                        IsDiableSelectedExpGid1(false);
                    }

                    if (data.length == 0) {
                       
                        $("#glCode1").val("").removeClass("valid").addClass("required");
                        
                        $("#SelectedExpGid1").empty();
                        $("#SelectedExpGid1").append("<option value='0' >--Select--</option>");
                        $('#SelectedExpGid1').val('0');
                        //$('#SelectedExpGid1').attr('disabled', true);
                        IsDiableSelectedExpGid1(true);

                    }
                },
                error: function (result) {
                    jAlert("Something went wrong", "Error");
                }
            });
        });

        //$(".SelectedExpGid1").change(function () {
        //    //alert($(this).val());
        //});


        // On key up function
        $("#productcode,#productname,#productDescription,#service,#servicename,#servicedesc").keyup(function (e) {
            var _data = $(this).val();
            $(this).removeClass('required').removeClass('valid');
            if (_data.trim() != "")
                $(this).addClass('valid');
            else
                $(this).addClass('required');
        });

        $("#parentProductGid").change(function () {
            var parentGid = $("#parentProductGid").val();
            var selectedValue = $("#parentProductGid option:selected").text();
            $("#parentProductGid_chosen").removeClass('required').removeClass('valid');
            if (parentGid.trim() != "") {
                $("#parentProductGid_chosen").addClass('valid');
            }
            else {
                $("#parentProductGid_chosen").addClass('required');
            }
            if (selectedValue != "--Select--") {
                $.ajax({
                    url: '@Url.Action("GetCategory", "FbProductService")',
                    dataType: 'json',
                    data: { id: $(this).val() },
                    success: function (objDetails) {
                        //console.log(objDetails);
                        console.log(objDetails.AssetSubCatList);
                        debugger;
                        $('.assetexpense, .assetexpense1').hide();

                        if (objDetails.category == "A")
                        {
                            
                            $("#SelectedAssetCatGid, #SelectedAssetSubCatGid").empty();
                            //$("#SelectedAssetCatGid, #SelectedAssetSubCatGid").append("<option value='0' >--Select--</option>");
                            $("#radioAsset").attr("checked", true);
                            
                            $("#radioExpense").attr("disabled", true);
                            IsDiabledropExpense(true);
                            IsDiableSelectedExpGid1(true)
                            $(".assetexpense").show();
                            if (objDetails.glCode != null && objDetails.glCode != null)
                            {
                                $("#glCode").attr("value", objDetails.glCode);
                                $("#glCode").addClass("valid");
                            }
                            for (var i = 0; i < objDetails.categoryList.length; i++) {
                                IsDiabledropAsset(false);
                                $("#SelectedAssetCatGid").append("<option value=" + objDetails.categoryList[i].Value + "" + (objDetails.categoryList[i].Selected == true ? " Selected" : "") + " >" + objDetails.categoryList[i].Text + "</option>");
                            }
                            IsDiabledropAsset(true);
                            for (var i = 0; i < objDetails.AssetSubCatList.length; i++) {
                                IsDiableAssetSubCatGid(false)
                                $("#SelectedAssetSubCatGid").append("<option value=" + objDetails.AssetSubCatList[i].Value + " " + (objDetails.AssetSubCatList[i].Selected == true ? " Selected" : "") + ">" + objDetails.AssetSubCatList[i].Text + "</option>");
                            }
                        }
                        if(objDetails.category == "E")
                        {
                            $("#SelectedExpNatureGid, #SelectedExpGid1").empty();
                            $("#SelectedExpNatureGid, #SelectedExpGid1").append("<option value='0' >--Select--</option>");
                            $("#SelectedExpNatureGid, #SelectedExpGid1").val("0");
                            $("#radioExpense").attr("checked", true);
                            
                            $("#radioAsset").attr("disabled", true);
                            IsDiabledropAsset(true);
                            IsDiableAssetSubCatGid(true)
                            $(".assetexpense1").show();
                            if (objDetails.glCode != null && objDetails.glCode != null) {
                                $("#glCode1").attr("value", objDetails.glCode);
                                $("#glCode1").addClass("valid");
                            }
                            for (var i = 0; i < objDetails.ExpNatureList.length; i++) {
                                IsDiabledropExpense(false);
                                $("#SelectedExpNatureGid").append("<option value=" + objDetails.ExpNatureList[i].Value + " " + (objDetails.ExpNatureList[i].Selected == true ? " Selected='Selected'" : "") + ">" + objDetails.ExpNatureList[i].Text + "</option>");
                            }

                            IsDiabledropExpense(false);
                            $("#SelectedExpNatureGid").attr('disabled', 'disabled')
                            for (var i = 0; i < objDetails.expenseList.length; i++) {
                                IsDiableSelectedExpGid1(false)
                                $("#SelectedExpGid1").append("<option value=" + objDetails.expenseList[i].Value + " " + (objDetails.expenseList[i].Selected == true ? " Selected='Selected'" : "") + ">" + objDetails.expenseList[i].Text + "</option>");
                            }
                        }
                    },
                    error: function () { }
                });
            }
        });

        $("#serviceGid").change(function () {
            var txtContractTo = $("#serviceGid").val();
            var selectedValue = $("#serviceGid option:selected").text();
            $("#serviceGid_chosen").removeClass('required').removeClass('valid');
            if (txtContractTo.trim() != "") {
                $("#serviceGid_chosen").addClass('valid');
            } else {
                $("#serviceGid_chosen").addClass('required');
            }
            if (selectedValue != "--Select--") {
                $.ajax({
                    url: '@Url.Action("GetCategory", "FbProductService")',
                    dataType: 'json',
                    data: { id: $(this).val() },
                    success: function (objDetails) {
                        console.log(objDetails);
                        $('.assetexpense, .assetexpense1').hide();
                        if (objDetails.category == "E") {
                            $("#SelectedExpNatureGid, #SelectedExpGid1").empty();
                            $("#SelectedExpNatureGid, #SelectedExpGid1").append("<option value='0' >--Select--</option>");
                            //$("#SelectedExpNatureGid, #SelectedExpGid1").val("0");
                            $("#radioExpense").attr("checked", true);
                            $("#radioAsset").attr("disabled", true);
                            IsDiabledropAsset(true);
                            IsDiableAssetSubCatGid(true)
                            $(".assetexpense1").show();
                            if (objDetails.glCode != null && objDetails.glCode != null) {
                                $("#glCode1").attr("value", objDetails.glCode);
                                $("#glCode1").addClass("valid");
                            }
                            for (var i = 0; i < objDetails.ExpNatureList.length; i++) {
                                IsDiabledropExpense(false);
                                $("#SelectedExpNatureGid").append("<option value=" + objDetails.ExpNatureList[i].Value + " " + (objDetails.ExpNatureList[i].Selected == true ? " Selected='Selected'" : "") + ">" + objDetails.ExpNatureList[i].Text + "</option>");
                            }
                            IsDiabledropExpense(true);
                            $("#SelectedExpNatureGid").attr('disabled', 'disabled')
                            for (var i = 0; i < objDetails.expenseList.length; i++) {
                                IsDiableSelectedExpGid1(false)
                                console.log("<option value=" + objDetails.expenseList[i].Value + "" + (objDetails.expenseList[i].Selected == true ? " Selected='Selected'" : "") + " >" + objDetails.expenseList[i].Text + "</option>")
                                $("#SelectedExpGid1").append("<option value=" + objDetails.expenseList[i].Value + " " + (objDetails.expenseList[i].Selected == true ? " Selected='Selected'" : "") + ">" + objDetails.expenseList[i].Text + "</option>");
                            }
                        }
                        if (objDetails.category == "A") {
                            $("#SelectedAssetCatGid, #SelectedAssetSubCatGid").empty();
                            $("#SelectedAssetCatGid, #SelectedAssetSubCatGid").append("<option value='0' >--Select--</option>");
                            $("#radioAsset").attr("checked", true);
                            
                            $("#radioExpense").attr("disabled", true);
                            IsDiabledropExpense(true);
                            IsDiableSelectedExpGid1(true)
                            $(".assetexpense").show();
                            if (objDetails.glCode != null && objDetails.glCode != null) {
                                $("#glCode").attr("value", objDetails.glCode);
                                $("#glCode").addClass("valid");
                            }
                            for (var i = 0; i < objDetails.categoryList.length; i++) {
                                IsDiabledropAsset(false)
                                $("#SelectedAssetCatGid").append("<option value=" + objDetails.categoryList[i].Value + "" + (objDetails.categoryList[i].Selected == true ? " Selected" : "") + " >" + objDetails.categoryList[i].Text + "</option>");
                            }
                            IsDiabledropAsset(true);
                            $("#SelectedAssetCatGid").attr('disabled', 'disabled')
                            for (var i = 0; i < objDetails.AssetSubCatList.length; i++) {
                                IsDiableAssetSubCatGid(false);
                                $("#SelectedAssetSubCatGid").append("<option value=" + objDetails.AssetSubCatList[i].Value + " " + (objDetails.AssetSubCatList[i].Selected == true ? " Selected" : "") + ">" + objDetails.AssetSubCatList[i].Text + "</option>");
                            }
                        }
                        //if (msg == "E") {
                        //    $("#radioAsset").attr("disabled", true);
                        //    //$('#dropAsset :input').attr('disabled', true);
                        //    IsDiabledropAsset(true);
                        //    //$('#dropExpense :input').attr('disabled', false);
                        //    IsDiabledropExpense(false);
                        //    $("#radioExpense").attr("checked", true);
                        //    $(".assetexpense1").show();
                        //}
                        //else {
                        //    $("#radioAsset").attr("disabled", false);
                        //    //$('#dropAsset :input').attr('disabled', false);
                        //    IsDiabledropAsset(false);
                        //    //$('#dropExpense :input').attr('disabled', true);
                        //    IsDiabledropExpense(true);
                        //    $("#radioExpense").attr("disabled", true);
                        //    $(".assetexpense").show();
                        //}
                    },
                    error: function () { }
                });
            }
        });

        var glcode = $("#glCode").val();
        if (glcode == null || glcode == "") {
            $("#glCode").addClass('required');
        }
        else {
            $("#glCode").addClass('valid');
        }

        //Validation for product or service
        $('#prodsavebtn').click(function () {
            var assetTypeName = document.getElementById('radioAsset').value;
            var expenseTypeName = document.getElementById('radioExpense').value;
            var productType = $("input[name='Radio']:checked").val();
            var serviceType = $("input[name='Radio']:checked").val();
            //var productType = document.getElementById('radioProduct').value;
            //var serviceType = document.getElementById('radioService').value;
            if (productType == null || productType == "" || serviceType == null || serviceType == "") {
                jAlert("Please Select Type", "Message");
                return false;
            }
            if (productType == "Product") {
                var productCode = $("#productcode").val();
                var productName = $("#productname").val();
                var productDescription = $("#productDescription").val();
                var parentflag = $("#ddlflag option:selected").val();
                var e = document.getElementById("ddlflag");
                var selectedparent = e.options[e.selectedIndex].text;
                var parentproduct = $("#parentProductGid option:selected").text();
                console.log(selectedparent)
                if (productCode == null || productCode == "") {
                    jAlert("Please Enter Product Code", "Message", function (e) {
                        if (e == true) {
                            $("#productcode").focus();

                        }
                    });
                    return false;
                }
                else if (productName == null || productName == "") {
                    jAlert("Please Enter Product Name", "Message", function (e) {
                        if (e == true) {
                            $("#productname").focus();

                        }

                    });
                    return false;
                }
                else if (productDescription == null || productDescription == "") {
                    jAlert("Please Enter Product Description", "Message", function (e) {
                        if (e == true) {
                            $("#productDescription").focus();

                        }
                    });
                    return false;
                }
                else if (parentflag == "" || parentflag == "--Select--") {

                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlflag").focus();

                        }
                    });
                    return false;
                }
                else if (selectedparent == "No" & parentproduct == "--Select--") {
                    jAlert("Please Select Parent Product", "Message", function (e) {
                        if (e == true) {
                            $("#parentProductGid").focus();

                        }
                    });
                    return false;
                }
                //var assetTypeName = document.getElementById('radioAsset').value;
                //var expenseTypeName = document.getElementById('radioExpense').value;
                if (assetTypeName == null || assetTypeName == "" || expenseTypeName == null || expenseTypeName == "") {
                    jAlert("Please Select Category Type", "Message");
                    return false;
                }

                if (document.getElementById('radioAsset').checked)
                {
                    var glcodeprod = $("#glCode").val();
                    if (glcodeprod == "") {
                        jAlert("GL Number is invalid", "Message", function (e) {
                            if (e == true) {
                                $("#asssetGid").focus();
                            }
                        });
                        return false;
                    }
                    var assetCategory = $("#SelectedAssetCatGid option:selected").text();
                    if (assetCategory == "--Select--") {
                        jAlert("Please Select Asset Category", "Message", function (e) {
                            if (e == true) {
                                $("#asssetGid").focus();
                            }

                        });
                        return false;
                    }
                    if (selectedparent == "No") {
                        var assetSubCategory = $("#SelectedAssetSubCatGid option:selected").text();
                        if (assetSubCategory == "--Select--") {
                            jAlert("Please Select Asset Sub Category", "Message", function (e) {
                                if (e == true) {
                                    $("#SelectedAssetSubCatGid").focus();
                                }

                            });
                            return false;
                        }
                    }
                    var parentgid = $("#parentProductGid").val();

                    var assetCategory = $("#SelectedAssetCatGid").val();
                    var assetsubcategory = $("#SelectedAssetSubCatGid").val();
                    //if (selectedparent == "No") {
                    //    assetsubcategory = $("#SelectedAssetSubCatGid").val();
                    //}
                    //else {
                    //    assetsubcategory = 0;
                    //}

                    var objDetails =
                   {
                       "productCode": productCode,
                       "productName": productName,
                       "productDescription": productDescription,
                       "parentFlag": selectedparent,
                       "parentProductGid": parentgid,
                       "productServflag": productType,
                       "category": assetTypeName,
                       "assetGid": assetCategory,
                       "AssetSubCatGid": assetsubcategory,
                       "expenseGid": 0,
                       "ExpNatureGid": 0,
                       "glCode": glcodeprod
                   };
                    console.log(objDetails)
                    $.post('../FbProductService/Create', objDetails,
                         function (data) {
                             if (data == 0) {
                                 jAlert("Duplicate Record ", "Message");
                                 return false;
                             }
                             else {
                                 jAlert("Record Inserted Successfully", "Message", function (e) {
                                     if (e == true) {
                                         location = '../FbProductService/Index';
                                     }
                                 });
                             }
                         }, 'json');
                }
                else {
                    console.log(expenseTypeName)
                    var glcodeprod = $("#glCode1").val();
                    if (glcodeprod == "") {
                        jAlert("GL Number is invalid", "Message", function (e) {
                            if (e == true) {
                                $("#SelectedExpNatureGid").focus();
                            }
                        });
                        return false;
                    }
                    var expenseCategory = $("#SelectedExpNatureGid option:selected").text();
                    var expenseSubCategory = $("#SelectedExpGid1 option:selected").text();
                    if (expenseCategory == "--Select--") {
                        jAlert("Please Select Expense Category", "Message", function (e) {
                            if (e == true) {
                                $("#SelectedExpNatureGid").focus();

                            }
                        });
                        return false;
                    }
                    if (expenseSubCategory == "--Select--") {
                        jAlert("Please Select Expense Sub Category", "Message", function (e) {
                            if (e == true) {
                                $("#SelectedExpGid1").focus();

                            }
                        });
                        return false;
                    }

                    var parentgid = $("#parentProductGid").val();
                    var expenseCategoryval = $("#SelectedExpNatureGid").val();
                    var expenseSubCategoryval = $("#SelectedExpGid1").val();
                    var objDetails =
                   {
                       "productCode": productCode,
                       "productName": productName,
                       "productDescription": productDescription,
                       "parentFlag": selectedparent,
                       "parentProductGid": parentgid,
                       "productServflag": productType,
                       "category": expenseTypeName,
                       "assetGid": 0,
                       "AssetSubCatGid": 0,
                       "expenseGid": expenseSubCategoryval,
                       "ExpNatureGid": expenseCategoryval,
                       "glCode": glcodeprod
                   };
                    $.post('../FbProductService/Create', objDetails,
                         function (data) {
                             if (data == 0) {
                                 jAlert("Duplicate Record!", "Message");
                                 return false;
                             }
                             else {
                                 jAlert("Record Inserted Successfully", "Message", function (e) {
                                     if (e == true) {
                                         location = '../FbProductService/Index';
                                     }
                                 });
                             }
                         }, 'json');
                }
                //var assetType = $("input[name='RadioGL']:checked").val();
                //var expenseType = $("input[name='RadioGL']:checked").val();
                //if (assetType == null || assetType == "" || expenseType == null || expenseType == "") {
                //    jAlert("Please Select Category Type", "Message");
                //    return false;
                //}
                //if (assetType == "Asset") {
                    

                //}
                //if (expenseType == "Expense") {
                    

                //}

            }

            if (serviceType == "Service") {

                var servCode = $("#service").val();
                var servName = $("#servicename").val();
                var servDesc = $("#servicedesc").val();
                var parentflag = $("#ddlparent option:selected").val();
                var e = document.getElementById("ddlparent");
                var selectedparent = e.options[e.selectedIndex].text;
                var parentservice = $("#serviceGid option:selected").text();

                if (servCode == null || servCode == "") {
                    jAlert("Please Enter Service Code", "Message", function (e) {
                        if (e == true) {
                            $("#service").focus();

                        }
                    });
                    return false;
                }
                else if (servName == null || servName == "") {
                    jAlert("Please Enter Service Name", "Message", function (e) {
                        if (e == true) {
                            $("#servicename").focus();

                        }
                    });
                    return false;
                }
                else if (servDesc == null || servDesc == "") {
                    jAlert("Please Enter Service Description", "Message", function (e) {
                        if (e == true) {
                            $("#servicedesc").focus();

                        }
                    });
                    return false;
                }
                else if (parentflag == "--Select--") {
                    jAlert("Please Select Parent", "Message", function (e) {
                        if (e == true) {
                            $("#ddlparent").focus();

                        }
                    });
                    return false;
                }
                else if (selectedparent == "No" && parentservice == "--Select--") {
                    jAlert("Please select Parent product", "Message", function (e) {
                        if (e == true) {
                            $("#serviceGid").focus();
                        }
                    });
                    return false;
                }
                if (assetTypeName == null || assetTypeName == "" || expenseTypeName == null || expenseTypeName == "") {
                    jAlert("Please Select Category Type", "Message");
                    return false;
                }
                if (document.getElementById('radioAsset').checked)
                {
                    console.log(assetTypeName)
                    var glcodeprod = $("#glCode").val();
                    if (glcodeprod == "") {
                        jAlert("GL Number is invalid", "Message", function (e) {
                            if (e == true) {
                                $("#asssetGid").focus();
                            }
                        });
                        return false;
                    }
                    var assetCategory = $("#asssetGid option:selected").text();
                    if (assetCategory == "--Select--") {
                        jAlert("Please Select Asset Category", "Message", function (e) {
                            if (e == true) {
                                $("#asssetGid").focus();
                            }
                        });
                        return false;
                    }
                    if (selectedparent == "No") {
                        var assetSubCategory = $("#SelectedAssetSubCatGid option:selected").text();
                        if (assetSubCategory == "--Select--") {
                            jAlert("Please Select Asset Sub Category", "Message", function (e) {
                                if (e == true) {
                                    $("#SelectedAssetSubCatGid").focus();
                                }

                            });
                            return false;
                        }
                    }
                    var serviceGid = $("#serviceGid").val();
                    //var assetType = $("input[name='RadioGL']:checked").val();
                    var assetCategory = $("#SelectedAssetCatGid").val();
                    var assetsubcategory = $("#SelectedAssetSubCatGid").val();
                    //if (selectedparent == "No") {
                    //    assetsubcategory = $("#SelectedAssetSubCatGid").val();
                    //}
                    //else {
                    //    assetsubcategory = 0;
                    //}
                    var objDetails =
                    {
                         "service": servCode,
                         "serviceName": servName,
                         "serviceDescription": servDesc,
                         "parentFlag": selectedparent,
                         "parentProductGid": serviceGid,
                         "productServflag": productType,
                         "category": assetTypeName,
                         "assetGid": assetCategory,
                         "AssetSubCatGid": assetsubcategory,
                         "expenseGid": 0,
                         "ExpNatureGid": 0,
                         "glCode": glcodeprod
                    };
                    console.log(objDetails)
                    $.post('../FbProductService/Create', objDetails,
                         function (data) {
                             if (data == 0) {
                                 jAlert(" Duplicate Record!", "Message");
                                 return false;
                             }
                             else {
                                 jAlert("Record Inserted Successfully", "Message", function (e) {
                                     if (e == true) {
                                         location = '../FbProductService/Index';
                                     }
                                 });
                             }
                         }, 'json');
                }
                else
                {
                    console.log(expenseTypeName)
                    var glcodeprod = $("#glCode1").val();
                    if (glcodeprod == "") {
                        jAlert("GL Number is invalid", "Message", function (e) {
                            if (e == true) {
                                $("#SelectedExpNatureGid").focus();
                            }
                        });
                        return false;
                    }
                    var expenseCategory = $("#SelectedExpNatureGid option:selected").text();
                    var expenseSubCategory = $("#SelectedExpGid1 option:selected").text();
                    if (expenseCategory == "--Select--") {
                        jAlert("Please Select Expense Category", "Message", function (e) {
                            if (e == true) {
                                $("#SelectedExpNatureGid").focus();

                            }
                        });
                        return false;
                    }
                    if (expenseSubCategory == "--Select--") {
                        jAlert("Please Select Expense Sub Category", "Message", function (e) {
                            if (e == true) {
                                $("#SelectedExpGid1").focus();

                            }
                        });
                        return false;
                    }
                    var serviceGid = $("#serviceGid").val();
                    
                    //var assetCategory = $("#asssetGid").val();
                    //var expenseCategory = $("#expenseGid").val();
                    //var parentgid = $("#parentProductGid").val();
                    var expenseCategoryval = $("#SelectedExpNatureGid").val();
                    var expenseSubCategoryval = $("#SelectedExpGid1").val();
                    var objDetails =
                   {
                       "service": servCode,
                       "serviceName": servName,
                       "serviceDescription": servDesc,
                       "parentFlag": selectedparent,
                       "parentProductGid": serviceGid,
                       "productServflag": productType,
                       "category": expenseTypeName,
                       "assetGid": 0,
                       "AssetSubCatGid": 0,
                       "expenseGid": expenseSubCategoryval,
                       "ExpNatureGid": expenseCategoryval,
                       "glCode": glcodeprod

                   };
                    console.log(objDetails)
                    $.post('../FbProductService/Create', objDetails,
                         function (data) {
                             if (data == 0) {

                                 jAlert(" Duplicate Record!", "Message");
                                 return false;
                             }
                             else {
                                 jAlert("Record Inserted Successfully", "Message", function (e) {
                                     if (e == true) {
                                         location = '../FbProductService/Index';
                                     }
                                 });
                             }
                         }, 'json');
                }
                //if (assetType == "Asset") {
                    

                //}
                //if (expenseType == "Expense") {
                    

                //}


            }

        });

        function IsDiableProductParent(value) {
            if (value == true) {
                $('#parentProductGid').data('chosen').search_field_disabled();
                $('#parentProductGid').prop('disabled', true).trigger("chosen:updated");
            } else {
                $('#parentProductGid').removeAttr('disabled');
                $('#parentProductGid').trigger("chosen:updated");
            }
        }

        function IsDiableAssetCatGid(value) {
            
            //if (value == true) {
            //    $('#SelectedAssetCatGid').data('chosen').search_field_disabled();
            //    $('#SelectedAssetCatGid').prop('disabled', true).trigger("chosen:updated");
            //} else {
            //    $('#SelectedAssetCatGid').removeAttr('disabled');
            //    $('#SelectedAssetCatGid').trigger("chosen:updated");
            //}
        }

        function IsDiableAssetSubCatGid(value) {
            if (value == true) {
                $('#SelectedAssetSubCatGid').data('chosen').search_field_disabled();
                $('#SelectedAssetSubCatGid').prop('disabled', true).trigger("chosen:updated");
            } else {
                $('#SelectedAssetSubCatGid').removeAttr('disabled');
                $('#SelectedAssetSubCatGid').trigger("chosen:updated");
            }
        }

        function IsDiableSelectedExpGid1(value) {
            if (value == true) {
                $('#SelectedExpGid1').data('chosen').search_field_disabled();
                $('#SelectedExpGid1').prop('disabled', true).trigger("chosen:updated");
            } else {
                $('#SelectedExpGid1').removeAttr('disabled');
                $('#SelectedExpGid1').trigger("chosen:updated");
            }
        }

        function IsDiabledropExpense(value) {
            if (value == true) {
                $('#SelectedExpNatureGid').data('chosen').search_field_disabled();
                $('#SelectedExpNatureGid').prop('disabled', true).trigger("chosen:updated");
            } else {
                $('#SelectedExpNatureGid').removeAttr('disabled');
                $('#SelectedExpNatureGid').trigger("chosen:updated");
            }
        }

        //function IsDiabledropExpense(value) {
        //    if (value == true) {
        //        //$('#SelectedExpNatureGid').data('chosen').search_field_disabled();
        //        //$('#SelectedExpNatureGid').prop('disabled', true).trigger("chosen:updated");

        //        //$('#SelectedExpNatureGid').data('chosen').search_field_disabled();
        //        //$('#SelectedExpNatureGid').prop('disabled', true).trigger("chosen:updated");
        //    } else {
        //        $('#SelectedAssetSubCatGid').removeAttr('disabled');
        //        $('#SelectedAssetSubCatGid').trigger("chosen:updated");

        //        //$('#SelectedAssetSubCatGid').removeAttr('disabled');
        //        //$('#SelectedAssetSubCatGid').trigger("chosen:updated");
        //    }
        //}

        function IsDiabledropAsset(value) {
            if (value == true) {
                $('#SelectedAssetCatGid').data('chosen').search_field_disabled();
                $('#SelectedAssetCatGid').prop('disabled', true).trigger("chosen:updated");
            } else {
                //$('#SelectedExpNatureGid').removeAttr('disabled');
                //$('#SelectedExpNatureGid').trigger("chosen:updated");

                $('#SelectedAssetCatGid').removeAttr('disabled');
                $('#SelectedAssetCatGid').trigger("chosen:updated");
            }
        }

        
        function IsDiableddlService(value) {
            if (value == true) {
                $('#serviceGid').data('chosen').search_field_disabled();
                $('#serviceGid').prop('disabled', true).trigger("chosen:updated");
            } else {
                $('#serviceGid').removeAttr('disabled');
                $('#serviceGid').trigger("chosen:updated");
            }
        }


        function ProdServClose() {
            window.parent.jQuery('#ForPartialView').dialog('close');
        }

    </script>
}