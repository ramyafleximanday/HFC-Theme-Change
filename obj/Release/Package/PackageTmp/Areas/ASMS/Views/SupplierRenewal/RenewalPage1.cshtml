@model  IEM.Areas.ASMS.Models.SupplierContractRenewal
@using IEM.Areas.ASMS.Models
<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.24.min.js")" type="text/javascript"></script>
@{
    ViewBag.Title = "Renewal";
    Layout = "~/Views/Shared/_Layout.cshtml";
    // SupplierContractRenewal model=new SupplierContractRenewal ();
    //WebGrid grid = new WebGrid(source: Model, canPage: true, canSort: true);
    if (@ViewBag.status == "yes")
    {
        <script>jAlert('Successfully Renewal', "Message") </script>
    }
}

<b>
    <span style="color: rgb(52, 108, 196);">Contract Renewal</span>
</b>
<br />

@using (Html.BeginForm("RenewalPage1", "SupplierRenewal", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <div>
        <table align="center">
            <tr>
                <td>
                    <div class="wellNew">
                        @*<div style="margin-left:-60px;margin-right:-102px;">*@
                        <div style="margin-left:30px">
                            <div style="width:100%">
                                <div class="input-group">

                                    <table>
                                        <tr>
                                            <td style="display:none;width:10px;">@Html.TextBoxFor(model => model.SupplierheadGid)</td>
                                        </tr>
                                        <tr style="height:55px">
                                            <td><label>Supplier Code :</label></td>
                                            <td>
                                                @*<input type="text" id="txtSupplierCode" class="form-control" name='SupplierCode' value='@Model.SupplierCode' disabled="disabled" />*@
                                                @Html.TextBoxFor(model => model.SupplierCode, new { @readonly = true, @class = "form-control" })
                                            </td>
                                            <td width="30px"></td>
                                            <td><label>Supplier Name :</label></td>
                                            <td>
                                                @*<input type="text" id="txtSupplierName" class="form-control" name='@Html.NameFor(x => x.SupplierName)' value='@Model.SupplierName' disabled="disabled" />*@
                                                @Html.TextBoxFor(model => model.SupplierName, new { @readonly = true, @class = "form-control" })
                                            </td>
                                            <td width="30px"></td>
                                            <td><label>Activity Count :</label></td>
                                            <td>
                                                @*<input type="text" id="txtActivityCount" class="form-control" value="1" />*@
                                                @Html.TextBoxFor(model => model.ActivityCount, new { @readonly = true, @class = "form-control" })
                                            </td>
                                            <td width="30px"></td>
                                        </tr>
                                        <tr style="height:55px">
                                            <td><label>Contract Start Date:</label></td>
                                            <td width="80px">
                                                @*<input type="text" id="txtCStartdate" class="form-control" name='@Html.NameFor(x => x.Cont_startDate)' value='@Model.Cont_startDate' disabled="disabled" />*@
                                                @*@Html.TextBox("Cont_startDate", Model.Cont_startDate)*@
                                                @Html.TextBoxFor(model => model.Cont_startDate, new { @readonly = true, @class = "form-control" })
                                            </td>
                                            <td width="30px"></td>
                                            <td><label>Contract End Date Old:</label></td>
                                            <td>
                                                @*<input type="text" id="txtCEnddateold" class="form-control" name='@Html.NameFor(x => x.Cont_EndDate)' value='@Model.Cont_EndDate' disabled="disabled" />*@
                                                @*@Html.TextBox("Cont_EndDate", Model.Cont_EndDate)*@
                                                @Html.TextBoxFor(model => model.Cont_EndDate, new { @readonly = true, @class = "form-control", @id = "txtEnddateold" })
                                            </td>
                                            <td width="30px"></td>
                                            <td><label>Contract End Date New :</label></td>
                                            <td>
                                                @*<input type="date" id="txtCEnddatenew" class="form-control datepicker" />*@
                                                @Html.TextBoxFor(model => model.Cont_EndDateNew, new { @class = "form-control datepicker", placeholder = "Select date here...", @id = "txtEndDateNew" })
                                            </td>
                                            <td width="30px"></td>
                                        </tr>
                                        <tr style="height:55px">
                                            <td><label>Attachment Type :</label></td>
                                            <td>
                                                <select name="Attachment Type">
                                                    <option value="ServiceTaxCopy">Service Tax Copy</option>
                                                    <option value="ServiceTax ">Service Tax </option>
                                                </select>
                                            </td>
                                            <td width="30px"></td>
                                            <td><label>SelectFile To Attach :</label></td>
                                            <td>
                                                @*<input type="file" id="flpAttach" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/pdf,application/tiff,application/vnd.ms-excel,image/*,application/msword" value="Upload" />*@
                                                <input type="file" id="fuldAttach" name='@Html.NameFor(x=>x.file)' value="@Model.file" />
                                            </td>
                                            <td width="30px"></td>
                                            <td><label>Description :</label></td>
                                            <td>
                                                @*<input type="text" id="txtDecs" class="form-control" />*@
                                                @Html.TextBoxFor(model => model.Description, new { @class = "form-control", @maxlength = "500", @id = "txtDesc" })
                                            </td>
                                            <td width="30px"></td>
                                        </tr>

                                        @*<tr>
                                                <td colspan="9" align="center">
                                                    <span style="color:red;width:5px;">**Attach only.pdf.docx.jpg.png.tif files</span>
                                                </td>
                                            </tr>*@

                                        <tr>
                                            <td colspan="9" align="center">

                                                <input type="submit" id="btnRenew" class="btn btn-primary" value="ReNew" />
                                                <input type="submit" id="btnClear" class="btn btn-primary" value="Clear" />
                                                <input type="button" id="btnBack" onclick="location.href='@Url.Action("GetContractReneal", "SupplierContractRenewal")'" class="btn btn-primary" value="Back">
                                            </td>
                                        </tr>

                                    </table>


                                </div>
                            </div>
                        </div>
                    </div>

                </td>
            </tr>
            <tr style="height:30px;"><td></td></tr>
            <tr>
                <td>
                    <div id="dvgrid">
                        @if (@ViewBag.status == "yes")
                        {

                            var grid = new WebGrid(canPage: true, canSort: true);
                            grid.Bind(Model.SupplierRenewal, autoSortAndPage: true);
                            grid.Pager(WebGridPagerModes.All);

                            @grid.GetHtml(
    tableStyle: "table table-bordered table-hover", columns:
    @*grid.Columns
                                      (grid.Column("SupplierCode", "Supplier Code"),
                                                          grid.Column("SupplierName", "Supplier Name"),
                                                          grid.Column("Cont_startDate", "Cont startDate"),
                                                              grid.Column("Cont_EndDate", "Cont EndDate"),
                                                                  grid.Column("Cont_EndDateNew", "Renewal Date"),
                                                                              grid.Column("filename", "AttachFileName"),
                grid.Column(header: "Action", canSort: false, style: "action",
        format: @<text>
            @Html.Raw("<input type='button'  title='Edit' onclick='Renewal(" + item.SupplierCode + ")' class='btn btn-primary' value='View AttachFile' />")
               <button class="save-user edit-mode">Save</button>  )



        </text>)
                           )
                           )*@
 grid.Columns(
                                               grid.Column("SupplierCode", format: @<text>  <span>@item.SupplierCode </span> <label id="UserID" style="display:none;">@item.SupplierCode</label> </text>, style: "col1Width" ),
                                    grid.Column("SupplierName", "SupplierName", format: @<text>  <span> <label id="lblName">@item.SupplierName</label> </span> <input type="text" id="Name" value="@item.SupplierName" style="display:none;" /></text>, style: "col2Width"),
                                    grid.Column("Cont_startDate", "Cont startDate", format: @<text>  <span> <label id="lblName">@item.Cont_startDate</label> </span> <input type="text" id="Name" value="@item.Cont_startDate" style="display:none;" /></text>, style: "col2Width"),
                                    grid.Column("Cont_EndDate", "Cont EndDate", format: @<text>  <span> <label id="lblName">@item.Cont_EndDate</label> </span> <input type="text" id="Name" value="@item.Cont_EndDate" style="display:none;" /></text>, style: "col2Width"),
                                    grid.Column("Cont_EndDateNew", "Renewal Date", format: @<text>  <span class="display-mode"> <label id="lblName">@item.Cont_EndDateNew</label> </span> <input type="text" id="Name" value="@item.Cont_EndDateNew" style="display:none;" /></text>, style: "col2Width"),
                                    grid.Column("filename", "AttachFileName", format: @<text> <span class="display-mode"> <label id="lblSurName">@item.filename</label> </span>  <input type="text" id="SurName" value="@item.filename" class="edit-mode" style="display:none;" /> </text>, style: "col2Width"),
             grid.Column("Action", format: @<text>
                                @*<button class="edit-user display-mode" >Edit</button>*@
                                <button class="save-user display-mode">View AttchFile</button>
                                @*<button class="cancel-user edit-mode" >Cancel</button>*@
            </text>, style: "col3Width", canSort: false)
))



                        }

                    </div>
                </td>

            </tr>
            <tr>
                <td>
                    @*<input type="button" id="btnback" name="Back" value="Back" class="btn btn-primary" />*@
                    @*<a href='ASMS/SupplierContractRenewal/GetContractReneal/' class="btn btn-link"><span>Back</span></a>*@
                </td>
            </tr>
        </table>


    </div>
}

<script>
    $(document).ready(function () {
        //$('.edit-mode').hide();
        //$('.edit-user, .cancel-user').on('click', function () {
        //    var tr = $(this).parents('tr:first');
        //    tr.find('.edit-mode, .display-mode').toggle();
        //});
        $('#btnRenew').click(function () {
            var eddate = $('#txtEndDateNew').val();
            if (eddate == '') {
                jAlert('EndDateNew Should not be empty', "Reqired");
                return false;
            }
        });

        //$('#txtEndDateNew').change(function () {
        //    alert("date");
        //    //  var fit_start_time = $("#txtEnddateold").val();
        //    var fit_start_time = new Date($("#txtEnddateold").val());
        //    // var fit_end_time = $("#txtEndDateNew").val();
        //    var fit_end_time =new Date($("#txtEndDateNew").val());
        //    alert(fit_start_time);
        //    alert(fit_end_time);
        //    if (Date.parse(fit_start_time) >= Date.parse(fit_end_time)) {
        //        jAlert('Please select a different End Date New.',"Message");
        //        $("#txtEndDateNew").val('');
        //    }
        //});

        var objDate = new Date();
        // alert(objDate);
        var Presentyear = objDate.getFullYear();
        $('#txtEndDateNew').datepicker({
            yearRange: '1900:' + Presentyear,
            changeMonth: true,
            changeYear: false,
            //minDate: '+1d',
            minDate: $("#txtEnddateold").val(),
            dateFormat: 'dd/mm/yy'
        });

        $('#btnClear').click(function () {
            $('#txtEndDateNew').val('');
            $('#txtDesc').val('');
            $('#dvgrid').disabled();
        });
        //$('#txtEndDateNew').datetimepicker({
        //    lang: 'de',
        //    i18n: {
        //        de: {
        //            months: [
        //             'Jan', 'Feb', 'Mar', 'Apr',
        //             'May', 'Jun', 'Jul', 'Aug',
        //             'Sep', 'Oct', 'Nov', 'Dec',
        //            ],
        //            dayOfWeek: [
        //             "Sun", "Mon", "Thu", "wed",
        //             "Thr", "Fri", "Sat.",
        //            ]
        //        }
        //    },
        //    timepicker: false,
        //    format: 'd-m-Y'
        //});
        $('.save-user').on('click', function () {
            var tr = $(this).parents('tr:first');
            //var Name = tr.find("#Name").val();
            var SurName = tr.find("#SurName").val();
            //var UserID = tr.find("#UserID").html();
            // alert(SurName);
            // alert(SurName);
            if (SurName != '') {
                window.open("//192.168.0.130/images/" + SurName, "_blank", "toolbar=yes, scrollbars=yes, resizable=yes, top=500, left=500, width=400, height=400");
            }

            //tr.find("#lblName").text(Name);
            //tr.find("#lblSurName").text(SurName);
            //tr.find('.edit-mode, .display-mode').toggle();
            //var UserModel =
            //{
            //    "ID": UserID,
            //    "Name": Name,
            //    "SurName": SurName
            //};
            //$.ajax({
            //    url: '/User/ChangeUser/',
            //    data: JSON.stringify(UserModel),
            //    type: 'POST',
            //    contentType: 'application/json; charset=utf-8',
            //    success: function (data) {
            //        alert(data);
            //    }
            //});
            return false;
        });

        $('#btnClear').click(function () {
            return false;
        });

        //$('#btnback').click(function () {
        //    $.ajax({
        //        // Get Index PartialView
        //        url: "/SupplierContractRenewal/GetContractReneal/",
        //        type: 'GET',
        //        contentType: "application/json; charset=utf-8"
        //        //,

        //        //,
        //        //success: function (data) {
        //        //    $("#POdetailGridnewinline").empty().append(data);
        //        //},
        //        //error: function () {
        //        //    alert("something seems wrong");
        //        //}
        //    });
        //});
        @*$('.datepicker').datepicker();
        $('#btnRenew').click(function () {
            $.ajax({
                // Get Index PartialView
                url: "/SupplierRenewal/RenewalPage1/",
                type: 'POST',
                contentType: "application/json; charset=utf-8"
                //,
               // data: JSON.stringify(@Model)
                //,
                //success: function (data) {
                //    $("#POdetailGridnewinline").empty().append(data);
                //},
                //error: function () {
                //    alert("something seems wrong");
                //}
            });
        });*@
        //$('#flpAttach').change(function () {
        //    var filename = $(this).val();
        //    if (! /\.txt$/.test(filename)) {
        //        alert('Please select a text file');
        //    }
        //});
    });
    //function checkFileExtension(elem) {
    //    alert('hai');
    //    alert(elem.value);
    //    var filePath = elem.value;
    //    alert('ok');

    //    if (filePath.indexOf('.') == -1)
    //        return false;


    //    var validExtensions = new Array();
    //    var ext = filePath.substring(filePath.lastIndexOf('.') + 1).toLowerCase();
    //    alert(ext);

    //    validExtensions[0] = 'jpg';
    //    validExtensions[1] = 'jpeg';
    //    validExtensions[2] = 'bmp';
    //    validExtensions[3] = 'png';
    //    validExtensions[4] = 'gif';
    //    validExtensions[5] = 'tif';
    //    validExtensions[6] = 'tiff';
    //    validExtensions[7] = 'txt';
    //    validExtensions[8] = 'doc';
    //    validExtensions[9] = 'xls';
    //    validExtensions[10] = 'pdf';


    //    for (var i = 0; i < validExtensions.length; i++) {
    //        if (ext == validExtensions[i])
    //            return true;
    //    }


    //    alert('The file extension ' + ext.toUpperCase() + ' is not allowed!');
    //    return false;
    //}
    //function RenewalAttach(id)
    //{
    //    alert('hai');
    //    var ss = document.getElementById(id);
    //    alert(ss);

    //    window.open("//192.168.0.130/images/"+id);
    //}
    //function Renewal(id) {

    //    //var userName = "Shahid Bhat";
    //    //'<%Session["UserName"] = "' + id + '"; %>';
    //    //alert(<%Session["UserName"]%>);



    //    //$.getJSON('/SupplierContractRenewal/RenewalPage/', function (id) {


    //    //});

    //    var id = id;
    //    alert(id);
    //    // var value = id;
    //    // alert(value);
    //    //getPo(value);
    //    var Student =
    //      {
    //          "SupplierCode": id
    //      };
    //    //alert("hi");
    //    // alert(Student);
    //    $.ajax({
    //        // Get Index PartialView
    //        url: "/SupplierRenewal/next/",
    //        type: 'POST',
    //        contentType: "application/json; charset=utf-8",
    //        data: JSON.stringify(Student)
    //        //,
    //        //success: function (data) {
    //        //    $("#POdetailGridnewinline").empty().append(data);
    //        //},
    //        //error: function () {
    //        //    alert("something seems wrong");
    //        //}
    //    });
    //}
</script>
