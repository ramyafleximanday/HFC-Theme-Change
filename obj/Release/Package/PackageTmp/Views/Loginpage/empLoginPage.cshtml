@model IEM.Models.LoginPage

@{
    ViewBag.Title = "empLoginPage";
    Layout = null;
    if (Session["ErrMsg"] != null)
    {
        ViewBag.ErrMsg = (string)Session["ErrMsg"];
    }
    else
    {
        ViewBag.ErrMsg = "";
    }
}
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>IEM</title>
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <script src="~/Scripts/html5shiv.js"></script>
    <script src="~/Scripts/respond.min.js"></script>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryui")
    @Styles.Render("~/Content/themes/base/css")
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.8.2.min.js")" type="text/javascript"></script>
    <link href="@Url.Content("~/Content/jqsimplemenu.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.24.min.js")" type="text/javascript"></script>
    <script src="~/Scripts/asms/commonvalidation.js"></script>
    <link href="~/Content/bootstrap.css" rel="stylesheet" />
    <script src="~/Scripts/asms/jQuery.alert.js"></script>
    <link href="~/Content/jQuery.alert.css" rel="stylesheet" />
    <script src="~/Scripts/asms/ErrorMessages.js"></script>
    <script>
        function noBack() { window.history.forward() }
        noBack();
        window.onload = noBack;
        window.onpageshow = function (evt) { if (evt.persisted) noBack() }
        window.onunload = function () { void (0) }

        function RemoveSavedPassword() {
            debugger;
            if (jQuery.browser.webkit == undefined) {
                inputValue = $('.real-input').val();
                numChars = inputValue.length;
                showText = "";
                for (i = 0; i < numChars; i++) {
                    showText += "&#8226;";
                }
                $('.fake-input').html(showText);
            }
        }
    </script>
    <style>
        .active {
            background-image: url('~/Content/images/IEM-LOGO.png');
            background-position: left;
        }

        .input-box {
             position: relative;
            height: 50px;
           
        }

        input.real-input, .fake-input {
            position:absolute;
            height: 50px;
            display: block;
            width: 100%;
            height: 34px;
            padding: 6px 12px;
            font-size: 14px;
            line-height: 1.42857143;
            color: #555;
            background-color: #fff;
            background-image: none;
            border: 1px solid #ccc;
            border-left-color: rgb(204, 204, 204);
            border-left-style: solid;
            border-left-width: 1px;
            border-radius: 4px;
            -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
            box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
            -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;
            -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
            transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
        }

        input.real-input {
            opacity: 0;
            background: transparent;
        }
    </style>
</head>
@using (Html.BeginForm(new { autocomplete = "off", id = "form1" }))
{
    @Html.AntiForgeryToken()
    <div style="background-color:#EEF0F2;PADDING:0;margin:0;width:100%;height:100%;top:-20px;">
        <div style="margin:0 auto 0;">

            <table align="center" style="width:350px;">
                <tr>
                    <td>
                        <span id="txtErrorMsgSpan" style="color:red;"> @ViewBag.ErrMsg</span>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div style="padding:0px 10px 0px 10px;width:100%;border:2PX solid #7C6A55;margin-top:40%;">
                            <div id="image" style="
    height: 75px; /* or whatever, equal to the image you want 'watermarked' */
    width: 200px; /* as above */
    background-image: url(../Content/images/Fullerton.png);
    background-position: 0 0;
    background-repeat: no-repeat;
    position: relative;
    position: absolute;
    top: 66px; /* or whatever */
    left: 581px; /* or whatever, position according to taste */
  /*  opacity: 0.3;  Firefox, Chrome, Safari, Opera, IE >= 9 (preview) */
    filter:alpha(opacity=50); /* for <= IE 8 */
"></div><br />
                            <table align="center">
                                <tr>
                                    <td class="active" style="padding:10px 10px 10px 0px;color:#E36F1E;text-align:center;">
                                        <img src="~/Content/images/IEM-LOGO_New.png" width="60" height="60" />
                                        <span style="font-size:25px;font-weight:bold;vertical-align:middle">Employee Login</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding:10px">
                                        <span style="font-size:small">LOGIN</span><br />
                                        @Html.TextBoxFor(a => a.employeeId, new { @autocomplete = "off", @onfocus = "this.removeAttribute('readonly');", @class = "form-control textboxStyle100 required", @id = "txtEmployeegid", @required = "required", @style = "width:250px", @maxlength = "7" })
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding:10px;">
                                         <span style="font-size:small">PASSWORD</span><br />
                                        <div class="input-box" style="cursor:default;">
                                           
                                            <div class="fake-input" ></div>
                                            <input type="text" onkeyup="RemoveSavedPassword()" autocomplete="off" style="cursor:pointer;" class="real-input required" id="txtLoginPassword">
                                        </div>
                                        @* <span style="font-size:small">PASSWORD</span><br />
                                            @Html.TextBoxFor(a => a.passward, new
                                             {
                                                 @autocomplete = "off",
                                                 @onblur = "this.setAttribute('readonly', 'readonly');",
                                                 @onfocus = "this.removeAttribute('readonly');",
                                                 @readonly = "readonly",
                                                 @class = "form-control textboxStyle100 required real-input",
                                                 @style = "width:250px",
                                                 @id = "txtLoginPassword",
                                                 @onKeyUp = "RemoveSavedPassword()"
                                             })*@
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding:10px;">
                                        <span style="font-size:small">LOGIN MODE</span>
                                        <br />
                                        <div>
                                            <select style="height:30px;width:250px;" class="form-control" name="employeelogintype" id="employeelogintype">
                                                @*<option value="Select">Select</option>*@
                                                <option value="Self">Self</option>
                                                <option value="Proxy">Proxy</option>
                                            </select>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="idproxy" style="display:none">
                                    <td style="padding-left:10px;padding-top:10px;">
                                        <div>
                                            <span style="padding:10px;">Proxy User</span>
                                            <br />
                                            @Html.DropDownListFor(e => e.empname, Enumerable.Empty<SelectListItem>(), "--select--", new { @class = "form-control ", @style = "display: block;width:250px; height:30px;", @id = "ddlloginmode" })
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding:10px" align="center">
                                        <div align="center">
                                            <input autocomplete="off" style="font-style:normal;background-color:#E36F1E;color:white;" type="submit" id="btnLogin" name="Login" value="Login" class="btn" />
                                            <input style="font-style:normal;background-color:#7C6A55;color:white;" type="button" name="clear" id="btnClear" value="Cancel" class="btn" />
                                            <input style="font-style:normal;background-color:#a70404;color:white;" type="button" name="closed" id="btnClosed" value="Close" class="btn" />
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>

            </table>
        </div>
    </div>

}

<script>

    $("#txtEmployeegid").change(function () {
        var password = $("#txtLoginPassword").val();
        var username = $("#txtEmployeegid").val();

        $.ajax({
            url: "../Loginpage/GetLogindetailsnew",
            type: "POST",
            dataType: "json",
            data: { "passward": password, "employeeId": username },
            success: function (data) {

                // $("#ddlloginmode").empty();
                if (data.length > 0) {
                    //$("#ddlloginmode").append("<option value='0' >--Select--</option>");
                    //for (var i = 0; i < data.length; i++) {
                    // var stylesSelect = $('#ddlloginmode');
                    //stylesSelect.attr('disabled', false);
                    //var styleforloginmode = $('#employeelogintype');
                    //styleforloginmode.attr('disabled', false);
                    // $("#ddlloginmode").append("<option value=" + data[i].empname + " >" + data[i].empname + "</option>");
                    //}
                }
                if (data.length == 0) {
                    //var styleforloginmode = $('#employeelogintype');
                    //styleforloginmode.attr('disabled', true);
                    //var stylesSelect = $('#ddlloginmode');
                    //stylesSelect.attr('disabled', true);

                }
            }
        });

    });

    $('#employeelogintype').change(function () {
        var password = $("#txtLoginPassword").val();
        var username = $("#txtEmployeegid").val();
        var loginmode = $('#employeelogintype').val();
        var Student =
       {
           "employeeId": username,
           "passward": password,
       };

        if (loginmode == "select") {
            jAlert("Invalid Login Mode.", "Information")
            return false;
        }
        else if (loginmode == "Self") {
            var stylesSelect = $('#ddlloginmode');
            stylesSelect.attr('disabled', true);
            $('#idproxy').hide();
        }
        else {
            $('#idproxy').show();
            var stylesSelect = $('#ddlloginmode');
            stylesSelect.attr('disabled', false);
            $.ajax({
                // url: '../Loginpage/GetLogindetails/',
                url: '@Url.Action("GetLogindetails", "Loginpage")?' + new Date().getTime(),
                data: JSON.stringify(Student),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#ddlloginmode").empty();
                    if (data.length > 0) {
                        $("#ddlloginmode").append("<option value='0' >--Select--</option>");
                        for (var i = 0; i < data.length; i++) {
                            var stylesSelect = $('#ddlloginmode');
                            stylesSelect.attr('disabled', false);
                            $("#ddlloginmode").append("<option value=" + data[i].employeegid + " >" + data[i].empname + "</option>");
                        }
                    }
                    if (data.length == 0) {
                        $("#ddlloginmode").append("<option value='0' >--Select--</option>");
                        var stylesSelect = $('#ddlloginmode');
                        stylesSelect.attr('disabled', true);
                    }
                },
                error: function (result) {
                    jAlert("Error.", "Error");
                    return false;
                }
            });
        }
    });

    $(document).ready(function () {

        $("input:text,form").attr("autocomplete", "off");
        //window.localStorage.menuclick = 'S';
        localStorage.setItem("previousurlflag", "0");
        $('#idproxy').hide();
        $('#btnLogin').click(function () {
            var raiseProxy = $("#ddlloginmode").val().trim();
            var loginmode = $('#employeelogintype').val();
            if (loginmode == "Proxy") {
                if (raiseProxy == null || raiseProxy == "0") {
                    jAlert("Please Select Proxy Users.", "Message");
                    return false;
                }
            }
        });
        $("#btnClear").click(function () {
            $("#txtEmployeegid").val('');
            $("#txtLoginPassword").val('');
            $("#txtErrorMsgSpan").text("");
        });
        var errmsg = '@ViewBag.ErrMsg';
        if (errmsg != null && errmsg != "") {
            $("#txtErrorMsgSpan").text(errmsg);
        }
        else {
            $("#txtErrorMsgSpan").text("");
        }

    });
    $('#txtLoginPassword').bind("cut copy paste", function (e) {
        e.preventDefault();
    });
    $('#txtLoginPassword').bind("contextmenu", function (e) {
        e.preventDefault();
    });
    $("#txtEmployeegid").keypress(function (event) {
        return isAlphaNumeric(event, this);
    });
    $("#txtEmployeegid").focus();
    $("#txtEmployeegid").keyup(function () {
        if ($("#txtEmployeegid").val() != null) {
            $("#txtEmployeegid").addClass('valid');
            $("#txtEmployeegid").removeClass('required');
        }
        else {
            $("#txtEmployeegid").addClass('required');
            $("#txtEmployeegid").removeClass('valid');
        }
    });
    $("#txtLoginPassword").keyup(function () {
        if ($("#txtLoginPassword").val() != null) {
            $("#txtLoginPassword").addClass('valid');
            $("#txtLoginPassword").removeClass('required');
        }
        else {
            $("#txtLoginPassword").addClass('required');
            $("#txtLoginPassword").removeClass('valid');
        }
    });
    $("#txtLoginPassword").keyup(function () {
        if ($("#txtLoginPassword").val() != null) {
            $("#txtLoginPassword").addClass('valid');
            $("#txtLoginPassword").removeClass('required');
        }
        else {
            $("#txtLoginPassword").addClass('required');
            $("#txtLoginPassword").removeClass('valid');
        }
    });
    $("#btnClosed").click(function () {
        window.close();
    });

</script>