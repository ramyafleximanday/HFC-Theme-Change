@model IEM.Areas.ASMS.Models.ReportModel

@{
    ViewBag.Title = "Report";
    Layout = "~/Views/Shared/_Layout.cshtml";
    // var gridReport = new WebGrid(source: Model.reportList, canPage: true, canSort: true, ajaxUpdateCallback: "AjaxReport()", ajaxUpdateContainerId: "ajaxReport");

}

<b>
    <span style="color: rgb(52, 108, 196);">Vendor Master Report</span>
</b>
<br />
<div id="report">
    @using (Html.BeginForm())
    {
        <div class="well">
            <div class="row">
                <div style="width:100%">
                    <table class="myTableStyleTabNew" align="center">
                        <tr>
                            <td>
                                <table class="myTableStyleTabNew">
                                    <tr>
                                        <td>
                                            <span>
                                                Owner Name
                                            </span><br />
                                            @*<input type="text" class="textboxStyleSearch" id="OwnName"  name="OwnName" />*@
                                            @Html.TextBoxFor(a => a.ownerName, new { @class = "textboxStyleSearch", @id = "ownerName" })
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span>  Vendor Category </span><br />
                                            <select name="categoryddl" id="categoryddl" class="textboxStyleSearch">
                                                @foreach (var pitem in ViewBag.Getcategory)
                                                {
                                                    string selectedValue = "";
                                                    if (ViewBag.categoryID == pitem.Value)
                                                    {
                                                        selectedValue = "selected='selected'";
                                                    }
                                                    <option value="@pitem.Value" @selectedValue>@pitem.Text</option>
                                                }
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span>  Vendor State</span><br />
                                            <select name="VendorStateddl" id="VendorStateddl" class="textboxStyleSearch">
                                                @foreach (var pitem in ViewBag.state)
                                                {
                                                    string selectedValue = "";
                                                    if (ViewBag.stateID == pitem.Value)
                                                    {
                                                        selectedValue = "selected='selected'";
                                                    }
                                                    <option value="@pitem.Value" @selectedValue>@pitem.Text</option>
                                                }
                                            </select>
                                        </td>

                                    </tr>


                                </table>
                            </td>

                            <td>
                                <table class="myTableStyleTabNew">
                                    <tr>
                                        <td>
                                            <span>
                                                Owner Code
                                            </span><br />
                                            @Html.TextBoxFor(a => a.ownerEmployeeCode, new { @class = "textboxStyleSearch", @id = "ownerEmployeeCode" })

                                        </td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <span> Nature of Services - Category</span><br />
                                            <select name="servicetypeddl" id="servicetypeddl" class="textboxStyleSearch">
                                                @foreach (var pitem in ViewBag.Getservicetype)
                                                {
                                                    string selectedValue = "";
                                                    if (ViewBag.service == pitem.Value)
                                                    {
                                                        selectedValue = "selected='selected'";
                                                    }
                                                    <option value="@pitem.Value" @selectedValue>@pitem.Text</option>
                                                }
                                            </select>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <span>  Vendor City</span><br />
                                            <select name="VendorCityddl" id="VendorCityddl" class="textboxStyleSearch">
                                                @foreach (var pitem in ViewBag.city)
                                                {
                                                    string selectedValue = "";
                                                    if (ViewBag.cityID == pitem.Value)
                                                    {
                                                        selectedValue = "selected='selected'";
                                                    }
                                                    <option value="@pitem.Value" @selectedValue>@pitem.Text</option>
                                                }
                                            </select>
                                        </td>
                                    </tr>



                                </table>
                            </td>

                            <td>
                                <table class="myTableStyleTabNew">
                                    @*<tr>
                                        <td>
                                            <span>
                                                Coordinator - Name
                                            </span><br />@Html.TextBoxFor(a => a.coordinatorName, new { @class = "textboxStyleSearch", @id = "coordinatorName" })

                                        </td>
                                    </tr>*@
                                    <tr>
                                        <td>
                                            <span>
                                                Vendor Name
                                            </span><br />@Html.TextBoxFor(a => a.vendorName, new { @class = "textboxStyleSearch", @id = "vendorName" })
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span>
                                                Vendor Code
                                            </span><br />@Html.TextBoxFor(a => a.vendorCode, new { @class = "textboxStyleSearch", @id = "vendorCode" })
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <span>    Type of Agreement</span><br />
                                            <select name="Agreementddl" id="Agreementddl" class="textboxStyleSearch">
                                                @foreach (var pitem in ViewBag.contract)
                                                {
                                                    string selectedValue = "";
                                                    if (ViewBag.contractID == pitem.Value)
                                                    {
                                                        selectedValue = "selected='selected'";
                                                    }
                                                    <option value="@pitem.Value" @selectedValue>@pitem.Text</option>
                                                }
                                            </select>
                                        </td>
                                    </tr>

                                </table>
                            </td>
                            <td>
                                <table>
                                    @*<tr>
                                        <td>
                                            <span>
                                                Coordinator - Code
                                            </span><br />
                                            @Html.TextBoxFor(a => a.coordinatorcode, new { @class = "textboxStyleSearch", @id = "coordinatorcode" })
                                        </td>

                                    </tr>*@
                                   
                                    @*<tr>
                                        <td>
                                            <span>
                                                Vendor Validity Date
                                            </span><br />@Html.TextBoxFor(a => a.agreementEndDate, new { @class = "textboxStyleSearch", @id = "agreementEndDate" })
                                        </td>
                                    </tr>*@
                                </table>
                            </td>
                        </tr>
                    </table>
                    <table class="myTableStyleTabNew" align="center">
                        <tr>
                            <td>
                                <button type="button" onclick="searchReportPara()" id="btnsearchreport" class="btn btn-primary"
                                        value="Search">
                                    <span style="color:white;" class="glyphicon glyphicon-search">
                                    </span>  Search
                                </button>
                                <button type="button" id="btnClearsearch" onclick="clearReportPara()" class="btn btn-primary" value="Clear"><span style="color:white;" class="glyphicon glyphicon-remove-circle"></span>  Clear</button>
                                <a class="btn btn-primary glyphicon glyphicon-export" data-modal="" href="../SupplierReport/downloadsexcel" id="reportDownloadExcel">
                                    Excel
                                </a>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div id="wgAsmsReportgrid" class="OverflowVisible overflowx " style="overflow-x: scroll;">
                @{

                                                var gridReport = new WebGrid(canPage: true, canSort: true);
                                                gridReport.Bind(Model.reportList, autoSortAndPage: true);
                }
                @gridReport.GetHtml(

htmlAttributes: new { id = "wgAsmsReport" },
            // mode: WebGridPagerModes.All,
tableStyle: "tableSmall table-bordered table-hover table-responsive",
columns: gridReport.Columns
(
gridReport.Column(header: "S.No", canSort: false, format: item => item.WebGrid.Rows.IndexOf(item) + 1 + Math.Round(Convert.ToDouble(gridReport.TotalRowCount / gridReport.PageCount) / gridReport.RowsPerPage) * gridReport.RowsPerPage * gridReport.PageIndex),
gridReport.Column("ownerDepartment", header: "Owner - Department", canSort: true),
gridReport.Column("ownerName", header: "Owner - Name", canSort: true),
gridReport.Column("ownerEmployeeCode", header: "Owner - Employee Code", canSort: true),
gridReport.Column("ownerEmailID", header: "Owner - Email ID", canSort: true),
gridReport.Column("coordinatorDepartment", header: "Coordinator - Department", canSort: true),
gridReport.Column("coordinatorName", header: "Coordinator - Name", canSort: true),
gridReport.Column("coordinatorcode", header: "Coordinator - Employee Code", canSort: true),
gridReport.Column("coordinatorEmailID", header: " Coordinator - Email ID", canSort: true),
gridReport.Column("categoryName", header: "Vendor Category", canSort: true),
gridReport.Column("procurableNonProcurablevendor", header: "Procurable/Non Procurable Vendor", canSort: true),
gridReport.Column("natureofServicesCategory", header: "Nature of Services - Category", canSort: true),
gridReport.Column("vendorName", header: "Vendor Name", canSort: true),
gridReport.Column("vendorCode", header: "Vendor Code", canSort: true),
gridReport.Column("vendorAddress", header: "Vendor Address", canSort: true),
gridReport.Column("vendorState", header: "Vendor State", canSort: true),
gridReport.Column("vendorCity", header: "Vendor City", canSort: true),
gridReport.Column("vendorEmpanelmentDate", header: "Vendor Empanelment  Date", canSort: true),
gridReport.Column("typeofAgreement", header: "Type of Agreement", canSort: true),
gridReport.Column("originalAgreementStatus", header: "Original Agreement Status", canSort: true),
gridReport.Column("agreementEndDate", header: "Agreement End Date ", canSort: true),
gridReport.Column("agreementRenewalStatus", header: "Agreement Renewal Status", canSort: true),
gridReport.Column("finalvendorStatus", header: "Final Vendor Status", canSort: true),
gridReport.Column("vendorValidityDate", header: "Vendor Validity Date", canSort: true),
gridReport.Column("pANNumber", header: "PAN Number", canSort: true),
gridReport.Column("procurementName", header: "Procurement Co-ordinator - Name", canSort: true),
gridReport.Column("procurementEmployeeCode", header: "Procurement Co-ordinator - Employee Code", canSort: true),
gridReport.Column("procurementEmailID", header: "Procurement Co-ordinator - Email ID", canSort: true),
gridReport.Column("vendorCoordinatorName", header: "Vendor - Coordinator Name (FPR)", canSort: true),
gridReport.Column("remarks", header: "Remarks", canSort: true),
gridReport.Column("vendorMobileNumber", header: "Vendor - Mobile Number", canSort: true),
gridReport.Column("vendorEmailID", header: " Vendor - Email ID", canSort: true),
gridReport.Column("vendorWebsiteAddress", header: " Vendor - Website Address", canSort: true),
gridReport.Column("vendorOfficeNumber", header: "Vendor - Office Number", canSort: true))
)
                @if (ViewBag.Message != null)
                {  <div align="center" class="borderStyle">
                    <h6 class="row" style="font-weight:bold ;">
                        @ViewBag.Message
                    </h6>
                </div>
                }
            </div>

            <span class="myTableStyleTabNew">Page: @(gridReport.PageIndex + 1) of @gridReport.PageCount</span>  <span class="myTableStyleTabNew"> - Total No Of Records:@Model.reportList.Count()</span>

        </div>
    }
</div>
<script>
    function clearReportPara() {

        $("#ownerName").val("");
        $("#ownerEmployeeCode").val("");
        $("#coordinatorName").val("");
        $("#coordinatorcode").val("");
        $("#categoryddl").val("0");
        $("#servicetypeddl").val("0");
        $("#vendorName").val("");
        $("#vendorCode").val("");
        $("#VendorStateddl").val("0");
        $("#VendorCityddl").val("0");
        $("#Agreementddl").val("0");
        $("#agreementEndDate").val("");
        location = "../SupplierReport/Index?search=search&" + new Date().getTime();
    }
    function searchReportPara() {

        var ownerName = $("#ownerName").val();
        var ownerEmployeeCode = $("#ownerEmployeeCode").val();
        var coordinatorName = $("#coordinatorName").val();
        var coordinatorcode = $("#coordinatorcode").val();
        var categoryddl = $("#categoryddl").val();
        var serviceTypeName = $("#servicetypeddl").val();
        var vendorName = $("#vendorName").val();
        var vendorCode = $("#vendorCode").val();
        var VendorStateddl = $("#VendorStateddl").val();
        var VendorCityddl = $("#VendorCityddl").val();
        var Agreementddl = $("#Agreementddl").val();
        var agreementEndDate = $("#agreementEndDate").val();

        var model = {
            "ownerName": ownerName,
            "ownerEmployeeCode": ownerEmployeeCode,
            "coordinatorName": coordinatorName,
            "coordinatorcode": coordinatorcode,
            "natureofServicesCategory": serviceTypeName,
            "categoryName":categoryddl,
            "vendorName": vendorName,
            "vendorCode": vendorCode,
            "vendorState": VendorStateddl,
            "vendorCity": VendorCityddl,
            "typeofAgreement": Agreementddl,
            "agreementEndDate": agreementEndDate
        };

        $.post('../SupplierReport/Search', model,
           function (data) {
            //   alert(data);
               location = '../SupplierReport/Index';
               // $("#wgAsmsReport").load("../SupplierReport/Index?search=search&" + new Date().getTime());
           }, 'json');
    }

    $("#agreementEndDate").datepicker({
        dateFormat: 'dd/mm/yy',
        changeMonth: true,
        yearRange: new Date().getFullYear().toString() + ':' + new Date().getFullYear().toString(),
        onClose: function (selectedDate) {
            $("#agreementEndDate").datepicker("option", "maxDate", selectedDate);
        }
    });

</script>































@*<table>
        <tr>
            <td>
                <input type="text" multiple="multiple" id="txtSeYear" onclick="check()" class="textboxStyleSearchSearch " placeholder="select year" />
                <div id="panYear" class="overflowx" style="width: 169px;
        height: 100px;
        font-weight: normal;
        padding: 4px 8px;
        font-size: 13px;
        line-height: 1.42857;
        color: #000;
        background-color: #FFF;
        background-image: none;
        border: 1px solid #CCC;
        border-radius: 4px;
        scrollbar-3dlight-color:ActiveBorder;
        scrollbar-arrow-color:darkgrey;
        box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.075) inset;
        transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;">
                    @{     var end = 0;
                         var i = DateTime.Now.Year - 50;
                         for (end = DateTime.Now.Year - 1; i < end; end--)
                         {
                            <div id="show"><input type="checkbox" onclick="checkbox(id)" id="@end" /><span id="id">@end </span> </div>
                         }}
                </div>
            </td>
        </tr>
    </table>
    <script type="text/javascript">
        var id1 = "";
        var b = false;
        $(document).ready(function () { $("#panYear").hide(0); });
        function checkbox(id) {
            if (id1 == '')
            {
                id1 = id;
            }
            else
            {
                id1 = id1 + "," + id;
            }
            $('#txtSeYear').val(id1);
        }
        $('#txtSeYear').change(function () {
            $("#panYear").hide(0);
        });
        function check() {
            $("#panYear").show(0);
            b = true;
        }
        if (b != true) { $("#panYear").hide(0); }
    </script>*@