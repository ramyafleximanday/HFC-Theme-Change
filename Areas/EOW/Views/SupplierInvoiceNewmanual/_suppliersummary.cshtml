<script src="~/Scripts/asms/jQuery1.alert.js"></script>
<script type="text/javascript">
    function testDecimals(currentval) {
        var count;
        currentval.match(/\./g) === null ? count = 0 : count = currentval.match(/\./g);
        return count;
    }
    function replaceCommas(yourNumber) {
        var components = yourNumber.toString().split(".");
        if (components.length === 1)
            components[0] = yourNumber;
        components[0] = components[0].replace(/\D/g, "").replace(/(\d)(?=(\d\d)+\d$)/g, "$1,");
        if (components.length === 2)
            components[1] = components[1].replace(/\D/g, "");
        return components.join(".");
    }
    var currentTab = 0;
    $(function () {
        $("#tabs").tabs({
            select: function (e, i) {
                currentTab = i.index;
            }
        });
    });
    $(document).ready(function () {
        $("#txtInvoicedate").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd-mm-yy',
            maxDate: '-id',
            onSelect: function (selected) {
                $("#txtInvoicedate").addClass('valid');
                var resultr = invoicedatecheck($("#txtInvoicedate").val());
            }
        });
    });
    $(document).ready(function () {
        debugger;
        $("#txtInvoicereceiptdate").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd-mm-yy',
            maxDate: '-id',
            onSelect: function (selected) {
                $("#txtInvoicereceiptdate").addClass('valid');
                var resultr = invoicedatecheckreceipt($("#txtInvoicereceiptdate").val());
            }
        });
        //$(function () {
            $('.monthYearPicker').datepicker({
                changeMonth: true,
                changeYear: true,
                showButtonPanel: true,
                maxDate: '-id',
                dateFormat: 'MM-yy'
            }).focus(function () {
                var thisCalendar = $(this);
                $('.ui-datepicker-calendar').detach();
                $('.ui-datepicker-close').click(function () {
                    var month = $("#ui-datepicker-div .ui-datepicker-month :selected").val();
                    var year = $("#ui-datepicker-div .ui-datepicker-year :selected").val();
                    thisCalendar.datepicker('setDate', new Date(year, month, 1));
                    $("#txtsermonth").removeClass('required');
                    $("#txtsermonth").addClass('valid');
                });
            });
        });
        //$(document).ready(function () {
        //    $("#txtsermonth").datepicker({
        //        changeMonth: true,
        //        changeYear: true,
        //        dateFormat: 'MM-yy',
        //        maxDate: '-id',
        //        onSelect: function (selected) {
        //            $("#txtsermonth").addClass('valid');
        //        }
        //    });
        //});
        $(document).ready(function () {
            var today = new Date();
            $("#txtrelasedate").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'dd-mm-yy',
                maxDate: '-id',
                maxDate: '+90d',
                onSelect: function (selected) {
                    $("#txtrelasedate").addClass('valid');
                }
            });
        });

    function invoicedatecheck(date) {
        var InvoiceDate = date; 
        var ECFdate = $("#txtecfdates").val();
        var MSME = $("#txtSuppliermsme").val();
        
        if (date.length == 10) {
            var Student =
            {
                "InvoiceDate": date,
                "IsMSME": MSME
            };
            $.ajax({
                url: '../SupplierInvoiceNew/invoicedatevat/',
                data: JSON.stringify(Student),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    if (data == "Deviation") {
                        jAlert("The Invoive Date Greather than 90 Days Please Atach Deviation Approval Document", "Message");
                        return true;
                    }
                    else if (data == "MSMEDeviation") {
                        jAlert("The Invoive Date is greather than 30 Days, Please Fill Reason for Delay,Functional Head Approver and also Attach Functional Approval Document!", "Message");
                        return true;
                    }
                },
                error: function (result) {
                    jAlert(result, "Error");
                    return false;
                }
            });
        }
    }

    function invoicedatecheckreceipt(date)//prema added for new CR on 07-03-2022
    {
        debugger;
        var InvoiceDate = $("#txtInvoicedate").val();
        var Invoicereceiptdate = date;
        var ECFdate = $("#txtecfdates").val();
        if (date.length == 10) {
            $.ajax({
                url: "../SupplierInvoiceNew/invoicedatecompare",
                type: "POST",
                dataType: "json",
                data: { INVOICEDate: InvoiceDate,InvoiceReceiptDate: Invoicereceiptdate },
                success: function (data) {
                    debugger;
                    if (data == "Deviation") {
                        jAlert("The Invoice Receipt Date should be greater than Invoice Date", "Message");
                        $("#txtInvoicereceiptdate").val("");
                        return false;
                    }
                    else
                    {
                        $.ajax({
                            url: "../SupplierInvoiceNew/invoicedatereceipt",
                            type: "POST",
                            dataType: "json",
                            data: { InvoiceReceiptDate: Invoicereceiptdate, ECFDate: ECFdate, invdate: InvoiceDate },
                            success: function (data) {
                                if (data == "Deviation") { // ramya modified on 23 may 22 1
                                    jAlert("The Invoice Receipt Date/Invoice Date is greather than 30 Days of ECF Date So, Kindly fill Reason For Delay and also Attach the Functional Head Approval", "Message");
                                    $("#tctreasonfordelay").attr('disabled', false);
                                    $("#ddfunctionalheadapproval").attr('disabled', false);
                                    $("#newinvoiceadds").attr('disabled', true);
                                    $("#newinvoiceaddscal").attr('disabled', true);//ramya added on 25 Apr 22
                                    return false;
                                }
                                else {
                                    $("#tctreasonfordelay").val("");
                                    $("#ddfunctionalheadapproval").val("");
                                    $("#tctreasonfordelay").attr("disabled", true);
                                    $("#ddfunctionalheadapproval").attr("disabled", true);
                                    $("#newinvoiceadds").attr('disabled', false);
                                    $("#newinvoiceaddscal").attr('disabled', false);//ramya added on 25 Apr 22
                                }
                            },
                            error: function (result) {
                                jAlert(result, "Error");
                                return false;
                            }
                        });
                    }
                },
                error: function (result) {
                    jAlert(result, "Error");
                    return false;

                }
            });
            
        }
    }
</script>


<div class="table-responsive" id="Invoicenewadd">
    <br />
    @*Ramya Aug*@
    <input type="hidden" name="hdfEditViewGstChargedFlag" id="hdfEditViewGstChargedFlag" value="N" />
    <div class="well table-responsive" style="width: 99%;border-color: #43B6F5;border-width: 1px;padding: 0px;">
        <table class="myTableStyleTab" style="width: 99%;">
            <tr>
                <td style="padding-left: 15px;">
                    <span>Invoice Date</span><br />
                    <input class="textboxStyle required" type="text" id="txtInvoicedate" maxlength="10" placeholder="dd-mm-yyyy" />
                </td>
                <td>
                    <span>Invoice No</span><br />
                    <input class="textboxStyle required" type="text" id="txtInvoiceno" maxlength="64" />
                </td>
                <td>
                    <span>Service Month</span><br />
                    <input class="textboxStyle required monthYearPicker" type="text" id="txtsermonth" maxlength="10" placeholder="MMM-yyyy" />
                </td>
                <td>
                    <span>Invoice Amount</span><br />
                    <input type="hidden" id="hdinvoiceamt" value="0" />
                    <input class="textboxStyle required" type="text" id="txtInvoiceamount" onkeypress="return isAmount(event);" onkeyup="compare(this)" maxlength="15" />
                </td>
                <td style="padding-bottom: 10px;width:20%;">
                    <span>Provision Flag</span><br />
                    <input type="radio" name="rblProvisionflg" id="rblYesp" value="Yes" />&nbsp;Yes
                    &nbsp;&nbsp;
                    <input type="radio" name="rblProvisionflg" id="rblNop" value="No">&nbsp;No
                </td>
            </tr>
            <tr>

                <td style="padding-left: 15px;padding-bottom: 9px;">
                    <span>Without Tax Amount</span><br />
                    <input class="textboxStyle required" type="text" id="txtWithoutTaxAmount" onkeypress="return isAmount(event);" maxlength="15" />
                </td>
                <td style="padding-left: 15px;" colspan="2">
                    <span>Invoice Description</span><br />
                    <textarea id="tctInvoicedec" maxlength="125" class="textboxStyle" style="height:30px;resize:none;width:100%"></textarea>
                </td>

                <td style="padding-bottom: 10px;">
                    <span>Retention Flag</span><br />
                    <input type="radio" name="rblRetentionflg" id="rblYesr" value="Yes" />&nbsp;Yes
                    &nbsp;&nbsp;
                    <input type="radio" name="rblRetentionflg" id="rblNor" value="No">&nbsp;No
                </td>
                <td style="padding-left: 15px;" id="tdGSTCharged">
                    <span> GST Charged</span>
                    <br />
                    <input checked="checked" id="rdogstChargedFlagYes" name="rdogstChargedFlag" type="radio" value="Y" style="margin-top: 10px; margin-right:5px;">Yes
                    <input id="rdogstChargedFlagNo" name="rdogstChargedFlag" type="radio" value="N" style="margin: 10px 5px 0px 20px;">No
                </td>
            </tr>
            <tr id="MSMEROW">
                @*//Prema added for MSME CR on 07-03-2022*@
                <td style="padding-left: 15px;">
                    <span>Invoice Receipt Date</span><br />
                    <input class="textboxStyle required" type="text" id="txtInvoicereceiptdate" maxlength="10" placeholder="dd-mm-yyyy" />
                </td>
                <td colspan="2">
                    <span>Reason for Delay</span><br />
                    <textarea id="tctreasonfordelay" maxlength="125" class="textboxStyle" style="height:30px;resize:none;width:100%"></textarea>
                </td>
                <td style="padding:3px;">
                    <div style="display:none;" class="divGSTChargedShow">
                        <span>Functional Head Approval</span><br />
                        <select id="ddfunctionalheadapproval" class="fstextbox required"></select>
                    </div>
                </td>
                <td style="padding:5px 10px;">
                    <div style="width:75%; display:none;" class="divGSTChargedShow">
                        <span> Sum of Invoice Amount </span>
                        <br />
                        <input type="text"
                               id="txttotalinvamt" disabled
                               class="fstextbox" maxlength="50" /> @*// Length Modified by selva*@
                        </div>
                    </td>
            </tr>
            @*//Prema Changes End*@
            <tr>
                <td style="padding:5px 10px;">
                    <div style="width:100%; display:none;" class="divGSTChargedShow">
                        <span>Provider Location (state)</span><br />
                        <select id="ddlgstProviderLoc" class="fstextbox required"></select>
                    </div>
                </td>
                <td style="padding:5px 10px;" colspan="2">
                    <table style="width:100%">
                        <tr>
                            <td style="width:33%; padding:3px;">
                                <div style="width:100%; display:none;" class="divGSTChargedShow" id="divGSTTINVendor">
                                    <span>GSTIN Vendor </span>
                                    <br />
                                    <input type="text" disabled
                                           id="txtGSTINVendor"
                                           class="fstextbox" maxlength="50" /> @*// Length Modified by selva*@
                                    </div>
                                </td>
                                <td style="width:33%; padding:3px;">
                                    <div style="width:100%; display:none;" class="divGSTChargedShow">
                                        <span>Receiver Location (state)</span><br />
                                        <select id="ddlgstReceiverLoc" class="fstextbox required"></select>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td style="padding:5px 10px;">
                        <div style="width:100%; display:none;" class="divGSTChargedShow">
                            <span>GSTIN @System.Configuration.ConfigurationManager.AppSettings["CompanyName"] </span>
                            <br />
                            <input type="text"
                                   id="txtGSTINFICCL" disabled
                                   class="fstextbox" maxlength="50" /> @*// Length Modified by selva*@
                            </div>
                        </td>
                        
                            <td align="right">
                                <button type="button" title="Addinvoice" name="Addinvoice" id="idAddinvoice" class="btn btn-primary" onclick="NewAddinvoice()" style="width: 65%;"> Save </button>
                            </td>
                        </tr>
                        <tr>

                            <td style="padding-left: 15px;">
                                <div style="display:none;" id="Retentionflgg">
                                    <span>Retention %</span><br />
                                    <input class="textboxStyle" type="text" id="txtRetentionper" disabled="disabled" onkeypress="return isAmount(event);" maxlength="5" />
                                </div>
                            </td>
                            <td>
                                <div style="display:none" id="Retentionflgg1">
                                    <span>Retention Amount</span><br />
                                    <input class="textboxStyle" type="text" id="txtRetentionamount" disabled="disabled" onkeypress="return isAmount(event);" maxlength="15" />
                                </div>
                            </td>
                            <td>
                                <div style="display:none" id="Retentionflgg2">
                                    <span>Release Date</span><br />
                                    <input class="textboxStyle" type="text" id="txtrelasedate" disabled="disabled" maxlength="10" placeholder="dd-mm-yyyy" />
                                </div>
                            </td>

                            @*<td align="right">
                                    <button type="button" title="Addinvoice" name="Addinvoice" id="idAddinvoice" class="btn btn-primary" onclick="NewAddinvoice()" style="width: 50%;"> Save </button>
                                </td>*@
                        </tr>
                    </table>
                    <br />
                </div>
                <br />
                <div style="padding:0;margin:0; width:99%">
                    <div id="tabs">
                        <ul>
                            @if (@ViewBag.POStatus == "PO" || @ViewBag.POStatus == "WO")
                            {
                                <li><a href="#tabs-4"> Purchase Order </a></li>
                            }
                            <li><a href="#tabs-2"> Debit Line </a></li>
                            <li style="display:none;"><a id="Taxtab" href="#tabs-1" style=" display:none;">Tax Details</a></li>
                            <li><a id="Gsttab" href="#tabs-6" style="display:none;">GST</a></li>
                            <li><a id="RCMtab" href="#tabs-7" style="display:none;">RCM</a></li>
                            <li><a href="#tabs-3">Payment</a></li>
                            <li><a href="#tabs-5">Invoice Attachments</a></li>

            </ul>
            @if (@ViewBag.POStatus == "PO" || @ViewBag.POStatus == "WO")
            {
                <div id="tabs-4">
                    @Html.Partial("_TabPOmapping")
                </div>
            }
            <div id="tabs-1" style="display:none;">
                @Html.Partial("_TabTaxDetails")
            </div>
            <div id="tabs-2">
                @Html.Partial("_Tabdebitline")
            </div>
            <div id="tabs-3">
                @Html.Partial("_SupplierPaymentDetails")
            </div>
            <div id="tabs-5">
                @Html.Partial("_TabIAttachments")
            </div>
            <div id="tabs-6">
                @Html.Partial("_GetGstDetails")
            </div>
            <div id="tabs-7">
                @Html.Partial("_LoadRCMDetails")
            </div>
        </div>
    </div>
    <br />
    <div>
        <center>
            <button type="button" id="newinvoiceadds" class="btn btn-success" value="Save" onclick="Newsupplieeinvoicecreate()"><span class="glyphicon glyphicon-ok" style="color:white;font-size: small;"></span> Save</button>
            &nbsp; &nbsp;
            <button type="button" id="newinvoiceaddscal" value="Cancel" class="btn btn-warning" onclick="Newsupplieeinvoicecancel()"><span style="color:white;font-size: small;" class="glyphicon glyphicon-remove-sign"></span> Cancel</button>
        </center>
    </div>
</div>

<div id="summaryhd1" style="padding-right: 10px;">
    <table class="table-responsive" style="width:100%;">
        <tr>
            <td align="left" style="padding-bottom: 5px;">
                <input type="button" id="viewlastthree" value="View Last Three Month Invoice" class="btn btn-primary" onclick="Newsupplieeinvoicelast()" />
            </td>
            <td align="right" style="padding-bottom: 5px;">
                <button type="button" id="btnempNewExpensddetr" value="New Invoice" onclick="Newsupplieeinvoice()" class="btn btn-primary">
                    <span style="color:white;font-size: 12px;" class="glyphicon glyphicon-plus"></span> New Invoice
                </button>
            </td>
        </tr>
    </table>
</div>
<div id="summaryhd2" style="padding-right: 10px;">
    @Html.Partial("_supplierGridDetails")
</div>

<script>
    $(document).ready(function () {
        $("#txtRetentionper,#txtInvoiceamount").keyup(function () {

            //var curramountexrates = $("#txtInvoiceamount").val();
            //var curramounts = $("#txtRetentionper").val();
            var curramountexrates = $("#txtInvoiceamount").val().replace(/,/g, "");
            var curramounts = $("#txtRetentionper").val();

            if (curramounts != null || curramounts != "" || curramountexrates != null || curramountexrates != "") {

                //var tol = $('#txtRetentionper').val() * ($('#txtInvoiceamount').val() / 100);
                //$('#txtRetentionamount').val(tol.toFixed(2));

                var tol = $('#txtRetentionper').val() * (curramountexrates / 100);
                var currentval = tol.toFixed(2);
                var testDecimal = testDecimals(currentval);
                if (testDecimal.length > 1) {
                    currentval = currentval.slice(0, -1);
                }
                var tolnew = replaceCommas(currentval);
                $('#txtRetentionamount').val(tolnew);

                $("#txtRetentionamount").removeClass('required');
                $("#txtRetentionamount").addClass('valid');
            }
            else {
                $("#txtRetentionamount").removeClass('valid');
                $("#txtRetentionamount").addClass('required');
            }
        });
    });
    $("#txtInvoiceamount").keyup(function (event) {
        if (event.which >= 37 && event.which <= 40) {
            event.preventDefault();
        }

        var currentval = $("#txtInvoiceamount").val();
        var testDecimal = testDecimals(currentval);
        if (testDecimal.length > 1) {
            currentval = currentval.slice(0, -1);
        }
        $("#txtInvoiceamount").val(replaceCommas(currentval));

    });
    $(document).ready(function () {
        $("#Invoicenewadd").hide();
        var doctypeNames = $("#doctypeNames option:selected").text();
        if (doctypeNames == "PO" || doctypeNames == "WO") {
            $("#rblYesr").attr('disabled', false);
            $("#rblNor").attr('disabled', false);
        }
        else {
            $("#rblYesr").attr('disabled', true);
            $("#rblNor").attr('disabled', true);
        }
        //prema added for MSME CR on 07-03-2022
        var MSME = $("#txtSuppliermsme").val();
        if (MSME == "Y") {
            debugger;
            $("#MSMEROW").show();
        }
        else {
            debugger;
            $("#MSMEROW").hide();
        }
        LoadFunctionalHeadApproval();
        function LoadFunctionalHeadApproval() {
            debugger;
            var _tmpFilter = {
                ViewType: "12",
                RefId: "0"
            };
            $.ajax({
                type: "post",
                url: '@Url.Action("GetFunctionalHeadApproval", "SupplierInvoiceNew")',
                data: JSON.stringify(_tmpFilter),
                async: false,
                contentType: "application/json;",
                success: function (response) {
                    var data2 = "";
                    if (response.Data1 != null && response.Data1 != "" && JSON.parse(response.Data1) != null)
                        data2 = JSON.parse(response.Data1);
                    $("#ddfunctionalheadapproval").empty();
                    if (data2.length > 0) {
                        $("#ddfunctionalheadapproval").append("<option value='0' >--Select--</option>");
                        for (var i = 0; i < data2.length; i++) {
                            //alert('testttt');
                            var stylesSelect = $('#ddfunctionalheadapproval');
                            stylesSelect.attr('disabled', false);
                            $("#ddfunctionalheadapproval").append("<option value=" + data2[i].Id + " title=" + data2[i].Value + " >" + data2[i].Value1 + "</option>");

                        }
                    }

                    if (data2.length == 0) {
                        $("#ddfunctionalheadapproval").append("<option value='0' >--Select--</option>");
                        var stylesSelect = $('#ddfunctionalheadapproval');
                        stylesSelect.attr('disabled', true);
                    }

                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {

                }
            });




        };
        //Prema Changes End
    });

    $(document).ready(function () {

        var stylesSelect = $('#txtRetentionper');
        stylesSelect.attr('disabled', true);

        var stylesSelect = $('#txtRetentionamount');
        stylesSelect.attr('disabled', true);

        var stylesSelect = $('#txtrelasedate');
        stylesSelect.attr('disabled', true);

        $('input[type=radio][name=rblRetentionflg]').change(function () {

            if (this.value == 'Yes') {
                $("#Retentionflgg").fadeIn();
                $("#Retentionflgg1").fadeIn();
                $("#Retentionflgg2").fadeIn();
                $("#txtRetentionper").val('');
                $("#txtRetentionamount").val('');
                $("#txtrelasedate").val('');

                var stylesSelect = $('#txtRetentionper');
                stylesSelect.attr('disabled', false);

                var stylesSelect = $('#txtRetentionamount');
                stylesSelect.attr('disabled', false);

                var stylesSelect = $('#txtrelasedate');
                stylesSelect.attr('disabled', false);

                $("#txtRetentionper").addClass('required');
                $("#txtRetentionamount").addClass('required');
                $("#txtrelasedate").addClass('required');

                $('#txtrelasedate').datepicker({
                    defaultDate: '+3m'
                });
            }
            else {
                $("#Retentionflgg").fadeOut();
                $("#Retentionflgg1").fadeOut();
                $("#Retentionflgg2").fadeOut();
                $("#txtRetentionper").val('');
                $("#txtRetentionamount").val('');
                $("#txtrelasedate").val('');

                var stylesSelect = $('#txtRetentionper');
                stylesSelect.attr('disabled', true);

                var stylesSelect = $('#txtRetentionamount');
                stylesSelect.attr('disabled', true);

                var stylesSelect = $('#txtrelasedate');
                stylesSelect.attr('disabled', true);
                $("#txtRetentionper").removeClass('required');
                $("#txtRetentionamount").removeClass('required');
                $("#txtrelasedate").removeClass('required');
                $("#txtRetentionper").removeClass('valid');
                $("#txtRetentionamount").removeClass('valid');
                $("#txtrelasedate").removeClass('valid');
            }
        });
    });
</script>

<script>

    function NewAddinvoice() {

        var doctypeNames = $("#doctypeNames option:selected").text();

        var Invoicedate = $("#txtInvoicedate").val();
        var Invoiceno = $("#txtInvoiceno").val();
        var Invoicedec = $("#tctInvoicedec").val();
        //Prema Changes for MSME CR on 09-03-2022
        var Invoicereceiptdate = $("#txtInvoicereceiptdate").val();
        var reasonfordelay = $("#tctreasonfordelay").val();
        var functionalheadapproval = $("#ddfunctionalheadapproval").val();
        //Prema changes End
        //var Invoiceamount = $("#txtInvoiceamount").val();
        var Invoiceamount = $("#txtInvoiceamount").val().replace(/,/g, "");
        var sermonth = $("#txtsermonth").val();
        var Retentionper = $("#txtRetentionper").val();
        //var Retentionamount = $("#txtRetentionamount").val();
        var Retentionamount = $("#txtRetentionamount").val().replace(/,/g, "");
        var relasedate = $("#txtrelasedate").val();
        var Provision = $("input[name=rblProvisionflg]:checked").val();
        var rodio = $("input[name=rblRetentionflg]:checked").val();

        var TaxableAmount = $("#txtWithoutTaxAmount").val().replace(/,/g, "");
        var providerlocation = $("#ddlgstProviderLoc").val();
        var Receiverlocation = $("#ddlgstReceiverLoc").val();
        var VendorGst = "";
        var Ficcl = "";
        var GstCharged = "N";
        GstCharged = $("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value");
      //  alert(TaxableAmount);
        //if (GstCharged == 'Y')
        //{
             VendorGst = $("#txtGSTINVendor").val();
             Ficcl = $("#txtGSTINFICCL").val();
        //}
        if (Invoicedate == "" || Invoicedate == null) {
            jAlert("Please Select Invoice Date", "Message");
            return false;
        }
            if ((Invoiceno == "" || Invoiceno == null) && GstCharged == "Y") {
            jAlert("Please Enter Invoice No", "Message");
            return false;
        }
        if (Invoicedec == "" || Invoicedec == null) {
            jAlert("Please Enter Invoice Description", "Message");
            return false;
        }

        if (Invoiceamount == "" || Invoiceamount == null) {
            jAlert("Please Enter Invoice Amount", "Message");
            return false;
        }
        if (TaxableAmount == "" || TaxableAmount == null) {
            jAlert("Please Enter Without tax Amount", "Message");
            return false;
        }
        if (sermonth == "" || sermonth == null) {
            jAlert("Please Select Service Month", "Message");
            return false;
        }

        if (rodio == 'undefined' || rodio == null) {
            jAlert("Please Select Retention", "Message");
            return false;
        }

        if (Provision == 'undefined' || Provision == null) {
            jAlert("Please Select Provision", "Message");
            return false;
        }
        if (rodio == "Yes") {
            if (Retentionper == "" || Retentionper == null) {
                jAlert("Please Enter Retention %", "Message");
                return true;
            }
            if (Retentionamount == "" || Retentionamount == null) {
                jAlert("Please Enter Retention Amount", "Message");
                return true;
            }
            if (relasedate == "" || relasedate == null) {
                jAlert(" Please Select Release Date", "Message");
                return true;
            }
        }
        
        if (providerlocation == "0" || providerlocation == "" || providerlocation == null) {
                jAlert(" Please Select Provider Location", "Message");
                return true;
            }
        if (Receiverlocation == "0" || Receiverlocation == "" || Receiverlocation == null)
            {
                jAlert(" Please Select Receiver Location", "Message");
                return true;
        }
        if (GstCharged == 'Y') {
            if(VendorGst=="" || VendorGst==null)
            {
                jAlert(" Please Select Vendor GST", "Message");
                return true;
            }
            if(Ficcl=="" || Ficcl==null)
            {
                jAlert(" Please Select " +@System.Configuration.ConfigurationManager.AppSettings["CompanyName"] +" GST", "Message");
                return true;
            }
        }
        //Prema Changes for MSME CR on 09-03-2022
        var ECFdate = $("#txtecfdates").val();
        var MSME = $("#txtSuppliermsme").val();
        if (MSME == "Y") {
            if (Invoicereceiptdate == "" || Invoicereceiptdate == null) {
                jAlert(" Please Select invoice receipt Date", "Message");
                return true;
            }
            //else {
            //    debugger;
            //    var InvoiceDate = $("#txtInvoicedate").val();
            //    var date = $("#txtInvoicereceiptdate").val();
            //    var Invoicereceiptdate = date;
            //    var ECFdate = $("#txtecfdates").val();
            //    if (date.length == 10) {

            //        $.ajax({
            //            url: "../SupplierInvoiceNew/invoicedatereceipt",
            //            type: "POST",
            //            dataType: "json",
            //            data: { InvoiceReceiptDate: Invoicereceiptdate, ECFDate: ECFdate },
            //            success: function (data) {
            //                if (data == "Deviation") {
            //                    debugger;
            //                    if (reasonfordelay == "" || reasonfordelay == null) {
            //                        jAlert("Please Select the Reason for delay", "Message");
            //                        $("#tctreasonfordelay").attr('disabled', false);
            //                        return false;
            //                        window.stop();
            //                    }


            //                    if (functionalheadapproval == "" || functionalheadapproval == null) {
            //                        jAlert("Please Select the Functional Head Approval", "Message");
            //                        $("#ddfunctionalheadapproval").attr('disabled', false);
            //                        return false;
            //                        window.stop();
            //                    }

            //                }
            //                else {
            //                    $("#tctreasonfordelay").val("");
            //                    $("#ddfunctionalheadapproval").val("");
            //                    $("#tctreasonfordelay").attr('disabled', true);
            //                    $("#ddfunctionalheadapproval").attr('disabled', true);
            //                }
            //            },
            //            error: function (result) {
            //                jAlert("Error.", "Error");
            //                return false;

            //            }
            //        });
            //        $.ajax({
            //            url: "../SupplierInvoiceNew/invoicedatecompare",
            //            type: "POST",
            //            dataType: "json",
            //            data: { INVOICEDate: InvoiceDate, InvoiceReceiptDate: Invoicereceiptdate },
            //            success: function (data) {
            //                if (data == "Deviation") {
            //                    jAlert("The Invoice Receipt Date should be greater than the invoice date", "Message");
            //                    $("#txtInvoicereceiptdate").val(" ");
            //                    return false;
            //                    window.stop();

            //                }
            //            },
            //            error: function (result) {
            //                jAlert("Error.", "Error");
            //                return false;

            //            }
            //        });
            //    }

            //}


        }
        else {
            Invoicereceiptdate = "1900-01-01";
            reasonfordelay = "";
            functionalheadapproval = "0";
        }
        //Prema changes End
            $("#hdfEditViewGstChargedFlag").val(GstCharged);
        var NewAttmodel = {
            "InvoiceDate": Invoicedate,
            "InvoiceNo": Invoiceno,
            "Description": Invoicedec,
            "Amount": Invoiceamount,
            "TaxableAmount": TaxableAmount,
            "SerMonth": Invoicedate,
            "Retensionflg": rodio,
            "Retensionper": Retentionper,
            "Retensionamount": Retentionamount,
            "Retensionrelse": relasedate,
            "potype": doctypeNames,
            "Provision": Provision,
             "GstCharged": GstCharged,
        "ProviderLocation": providerlocation,
        "ReceiverLocation": Receiverlocation,
        "GstinVendor": VendorGst,
        "GstinFiccl": Ficcl,
        "InvoiceReceiptDate": Invoicereceiptdate,
        "ReasonForDelay": reasonfordelay,
        "FunctionalHeadApproval": functionalheadapproval,
        "ECFDate": ECFdate,
        "IsMSME": MSME
        };
        var url = '@Url.Action("_suppliserinvoiceadd", "SupplierInvoiceNewmanual")';
        $.post(url, NewAttmodel,
        function (data) {
            if (data.Errstatusout == "Reason") {
                jAlert("Please Fill Reason for delay", "Message");
                return false;
                //window.stop();
            }
            else if (data.Errstatusout == "FHA") {
                jAlert("Please Select Functional Head Approver", "Message");
                return false;
                //window.stop();
            }
            else if (data.Errstatusout == "InvDeviation") {
                jAlert('Invoice Receipt date must be greater than Invoice Date!', "Message");
                return false;
            }
            else if (data.Errstatusout == "Error") {
                jAlert('Error..........', "Message");
                return false;
            }
            else if (data.Errstatusout == "DuplicateInvoice") {
                jAlert('Duplicate Invoice Number : Invoice Number Already Exists', "Message");
                return false;
            }
            else if (data.Errstatusout == "DuplicateInvoicecrid") {
                jAlert('Delete Records Payment Tab SUS,CRN and PPX ', "Message");
                return false;
            }
            else {
                $("#lblPayMethod").text(data.GSTFlag);
                if (data.Errstatusout == "FinanceApprove") {
                    jAlert("Invoive Date Greather Than 90 Days & Invoive Amount More Then 2 Lakh : Please Atach Finance Approval ", "Message", function (u) {
                        if (u == true) {
                            jAlert("Saved Sucessfully", "Message", function (u) {
                                if (u == true) {
                                    var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                                    var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                                    var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                                    var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();

                                    var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                                    $("#wgAttachmentsupplierinv").load(invatturl);

                                    $("#wgempposupplier").load(pourl);

                                    if (GstCharged == 'Y') {

                                        $("#wgempTaxsupplier").load(taxurl);
                                    }
                                    $("#wgTravelmodeotab2").load(traurl);
                                    $("#wgempPaymensupplier").load(payurl);

                                    var url1 = '@Url.Action("_GetGstDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                                    $("#PoGstGrid").load(url1);
                                    var url2 = '@Url.Action("_LoadRCMDetails", "SupplierInvoiceNewmanual")';
                                    $("#GrdRCMdetls").load(url2);

                                    var stylesSelect = $('#newinvoiceadds');
				    stylesSelect.attr('disabled', false); // ramya added on 25 Apr 22
                                    var stylesSelect = $('#newinvoiceaddscal');
                                    stylesSelect.attr('disabled', false);
                                    var stylesSelect = $('#btndebitlieinvo');
                                    stylesSelect.attr('disabled', false);
                                    var stylesSelect = $('#btnpaymentinvo');
                                    stylesSelect.attr('disabled', false);
                                    var stylesSelect = $('#btntaxdinvo');
                                    stylesSelect.attr('disabled', false);
                                    var stylesSelect = $('#btndebitlieinvoexcel');
                                    stylesSelect.attr('disabled', false);
                                    var stylesSelect = $('#btntaxdinvopo');
                                    stylesSelect.attr('disabled', false);

                                    var stylesSelect = $('#btnInvoiceattmt');
                                    stylesSelect.attr('disabled', false);

                                    var stylesSelect = $('#btnInvoiceattmt');
                                    stylesSelect.attr('disabled', false);

                                    var stylesSelect = $('#idAddinvoice');
                                    stylesSelect.attr('disabled', false);
                                    var stylesSelect = $('#btnempNewExpensddetr');
                                    stylesSelect.attr('disabled', true);
                                    var stylesSelect = $('#viewlastthree');
                                    stylesSelect.attr('disabled', true);
                                    $("#hdinvoiceamt").val('0');
                                        var GstCharged = $("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value");
                                    if (GstCharged == "Y") {
                                        $("#Gsttab").show();
                                        $('#tabs').tabs('select', 1);
                                        $("#Taxtab").hide();
                                        $("#RCMtab").hide();
                                    }
                                    else {
                                        $("#Gsttab").hide();
                                        $("#Taxtab").hide();
                                        $("#RCMtab").show();
                                    }

                                    $('#tabs').tabs('select', 1);
                                }
                            });
                        }
                    });
                }
                else {

                    jAlert("Saved Sucessfully", "Message", function (u) {
                        if (u == true) {
                            var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                            var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                            var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                            var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();

                            var url1 = '@Url.Action("_GetGstDetails", "SupplierInvoiceNewmanual")';
                            $("#PoGstGrid").load(url1);
                            var url2 = '@Url.Action("_LoadRCMDetails", "SupplierInvoiceNewmanual")';
                            $("#GrdRCMdetls").load(url2);

                            var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                            $("#wgAttachmentsupplierinv").load(invatturl);

                            $("#wgempposupplier").load(pourl);
                            
                            if (GstCharged == "Y") {
                                //$("#wgempTaxsupplier").load(taxurl);
                                $("#Gsttab").show();
                                //$('#tabs').tabs('select', 1);
                                $("#Taxtab").hide();
                                $("#RCMtab").hide();
                            }
                            else {
                                $("#Gsttab").hide();
                                $("#Taxtab").hide();
                                $("#RCMtab").show();
                            }

                            $('#tabs').tabs('select', 1); 
                            $("#wgTravelmodeotab2").load(traurl);
                            $("#wgempPaymensupplier").load(payurl);

                            var stylesSelect = $('#newinvoiceadds');
			    stylesSelect.attr('disabled', false); // ramya added on 25 Apr 22
                            var stylesSelect = $('#newinvoiceaddscal');
                            stylesSelect.attr('disabled', false);
                            var stylesSelect = $('#btndebitlieinvo');
                            stylesSelect.attr('disabled', false);
                            var stylesSelect = $('#btnpaymentinvo');
                            stylesSelect.attr('disabled', false);
                            var stylesSelect = $('#btntaxdinvo');
                            stylesSelect.attr('disabled', false);
                            var stylesSelect = $('#btndebitlieinvoexcel');
                            stylesSelect.attr('disabled', false);
                            var stylesSelect = $('#btntaxdinvopo');
                            stylesSelect.attr('disabled', false);

                            var stylesSelect = $('#btnInvoiceattmt');
                            stylesSelect.attr('disabled', false);

                            var stylesSelect = $('#idAddinvoice');
                            stylesSelect.attr('disabled', false);
                            var stylesSelect = $('#btnempNewExpensddetr');
                            stylesSelect.attr('disabled', true);
                            var stylesSelect = $('#viewlastthree');
                            stylesSelect.attr('disabled', true);
                            $("#hdinvoiceamt").val('0');
			    var GstCharged = $("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value");
                                $("#Taxtab").hide();
                                $('#tabs').tabs('select', 0);
                                if (GstCharged == "Y") {
                                    $("#Gsttab").show();
                                    $("#RCMtab").hide();
                                }
                                else {
                                    $("#Gsttab").hide();
                                    $("#RCMtab").show();

                                }
                            }
                    });
                }
            }
        }, 'json');
    }


    function compare(e) {
        //var hdinvoiceamt = $("#hdinvoiceamt").val();
        //var ecfamont = $("#txtecfamont").val();
        //var tolinvoiceamt = $("#suppliertolamt").text();

        var tolinvoiceamt = $("#suppliertolamt").text().replace(/,/g, "");
        var hdinvoiceamt = $("#hdinvoiceamt").val().replace(/,/g, "");
        var ecfamont = $("#txtecfamont").val().replace(/,/g, "");

        var invoamt = $("#txtInvoiceamount").val().replace(/,/g, "");
        //var invoamt = e.value;
        var incuramt = parseFloat(tolinvoiceamt) - parseFloat(hdinvoiceamt);
        var tolecfval = parseFloat(incuramt) + parseFloat(invoamt);
        //var tolecfval = parseFloat(invoamt);

        var val1 = parseFloat(ecfamont);
        var val2 = parseFloat(tolecfval).toFixed(2);

        if (parseFloat(val1) < parseFloat(val2)) {
            jAlert("Invoice Total Amount Should Be Equal To ECF Total Amount", "Message");
            $("#txtInvoiceamount").val(invoamt.slice(0, -1))
            return false;
        }
    }
    function Newsupplieeinvoicecancel() {

        $("#summaryhd1").show();
        $("#summaryhd2").show();

        var Provision = "N";
        var NewAttmodel = {
            "Provision": Provision
        };
        $.post('../SupplierInvoiceNewmanual/_suppliserinvoiceclear', NewAttmodel,
        function (data) {
            if (data == "Error") {
                alert('Error..........');
                return false;
            }
            else {

                $("#Invoicenewadd").slideToggle(500);

                var url = '@Url.Action("_supplierGridDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                $("#wgSuppliersuppliermain").load(url);

                var stylesSelect = $('#btnempNewExpensddetr');
                stylesSelect.attr('disabled', false);
                var stylesSelect = $('#viewlastthree');
                stylesSelect.attr('disabled', false);


                var stylesSelect = $('#btnSubmitfinal');
                stylesSelect.attr('disabled', true); // ramya modified on 22 Apr 22
                var stylesSelect = $('#btnDraftfinal');
                stylesSelect.attr('disabled', false);
                var stylesSelect = $('#btnCancelfinal');
                stylesSelect.attr('disabled', false);
                var stylesSelect = $('#btnCancelfinaldash');
                stylesSelect.attr('disabled', false);
            }
        }, 'json');
    }

    function Newsupplieeinvoicecreate() {

        var doctypeNames = $("#doctypeNames option:selected").text();

        var Invoicedate = $("#txtInvoicedate").val();
        var Invoiceno = $("#txtInvoiceno").val();
        var Invoicedec = $("#tctInvoicedec").val();
        //var Invoiceamount = $("#txtInvoiceamount").val();
        var Invoiceamount = $("#txtInvoiceamount").val().replace(/,/g, "");
        var sermonth = $("#txtsermonth").val();
        var Retentionper = $("#txtRetentionper").val();
        //var Retentionamount = $("#txtRetentionamount").val();
        var Retentionamount = $("#txtRetentionamount").val().replace(/,/g, "");
        var relasedate = $("#txtrelasedate").val();
        var Provision = $("input[name=rblProvisionflg]:checked").val();
        var rodio = $("input[name=rblRetentionflg]:checked").val();

        //var supplierdetlineamt = $("#supplierdetlineamtr").text();
        var supplierdetlineamt = $("#supplierdetlineamtr").text().replace(/,/g, "");
        //var supplierpoamt = $("#supplierpomapamt").text();
        var supplierpoamt = $("#supplierpomapamt").text().replace(/,/g, "");
        //var supplierpaymentd = $("#supplierpaymentd").text();
        var supplierpaymentd = $("#supplierpaymentd").text().replace(/,/g, "");
        //var suppliertaxd = $("#suppliertaxd").text();
        var suppliertaxd = $("#suppliertaxd").text().replace(/,/g, "");
        // alert(suppliertaxd);
        //var hdtolattachment = $("#hdtolattachment").val();
        var hdtolattachmentINVV = $("#hdtolattachmentinvoice").text();
       
        if (Invoicedate == "" || Invoicedate == null) {
            jAlert("Please Select Invoice Date", "Message");
            return false;
        }
        if (Invoiceno == "" || Invoiceno == null) {
            jAlert("Please Enter Invoice No", "Message");
            return false;
        }
        if (Invoicedec == "" || Invoicedec == null) {
            jAlert("Please Enter Invoice Description", "Message");
            return false;
        }

        if (Invoiceamount == "" || Invoiceamount == null || Invoiceamount==0) {
            jAlert("Please Enter Invoice Amount", "Message");
            return false;
        }
        if (sermonth == "" || sermonth == null) {
            jAlert("Please Select Service Month", "Message");
            return false;
        }

        if (rodio == 'undefined' || rodio == null) {
            jAlert("Please Select Retention", "Message");
            return false;
        }

        if (Provision == 'undefined' || Provision == null) {
            jAlert("Please Select Provision", "Message");
            return false;
        }
        if (rodio == "Yes") {
            if (Retentionper == "" || Retentionper == null) {
                jAlert("Please Enter Retention %", "Message");
                return true;
            }
            if (Retentionamount == "" || Retentionamount == null) {
                jAlert("Please Enter Retention Amount", "Message");
                return true;
            }
            if (relasedate == "" || relasedate == null) {
                jAlert(" Please Select Release Date", "Message");
                return true;
            }
        }
        if (hdtolattachmentINVV == "" || hdtolattachmentINVV == "undefined" || hdtolattachmentINVV == null) {
            jAlert('Please Attach Atleast one Attachment ', "Message");
            return false;
        }
        var val1 = parseFloat(Invoiceamount);
        var val2 = parseFloat(supplierdetlineamt);
        var val3 = parseFloat(supplierpaymentd);
        var val4 = parseFloat(supplierdetlineamt) + parseFloat(suppliertaxd);
        var val5 = parseFloat(supplierpoamt);

        if (parseFloat(val1) != parseFloat(val2)) {
            jAlert("Please Check DebitLine Details : The DebitLine Total Amount Should Be Equal To Invoice Amount", "Message");
            return false;
        }
        if (parseFloat(val1) != parseFloat(val3)) {
            jAlert("Please Check Payment Details or Tax Details : The Payment Should Be Equal To Invoice Amount", "Message");
            return false;
        }
        //if (hdtolattachment == 'undefined' || hdtolattachment == null) {
        //    jAlert('Please Attach Atleast one Attachment ', "Message");
        //    return false;
        //}
        //alert(hdtolattachment);
        //if (doctypeNames == "PO" || doctypeNames == "WO") {
        //    if (parseFloat(val1) != parseFloat(val4)) {
        //        jAlert("Please Check PO Mapped Details : The Total PO Mapped Amount Should Be Equal To Invoice Amount", "Message");
        //        return false;
        //    }
        //}
        //Prema added for MSME on 08-03-2022 start
        var functionalheadapproval = "0";
	var Invoicereceiptdate ="";
	var reasonfordelay ="";
        var MSME = $("#txtSuppliermsme").val();
        var ECFdate = $("#txtecfdates").val();
        if (MSME == "Y") {
            Invoicereceiptdate = $("#txtInvoicereceiptdate").val();
            reasonfordelay = $("#tctreasonfordelay").val();
	    functionalheadapproval = $("#ddfunctionalheadapproval").val();
            if (Invoicereceiptdate == "" || Invoicereceiptdate == null) {
                jAlert("Please Select invoice receipt Date", "Message");
                return false;
            }
            //else {
            //    debugger;
            //    var date = Invoicereceiptdate;

            //    if (date.length == 10) {

            //        $.ajax({
            //            url: "../SupplierInvoiceNew/invoicedatereceipt",
            //            type: "POST",
            //            dataType: "json",
            //            data: { InvoiceReceiptDate: Invoicereceiptdate, ECFDate: ECFdate },
            //            success: function (data) {
            //                if (data == "Deviation") {
            //                    if (reasonfordelay == "" || reasonfordelay == null) {
            //                        jAlert("Please Select the Reason for delay", "Message");
            //                        $("#tctreasonfordelay").attr('disabled', false);
            //                        return false;
            //                        window.stop();
            //                    }


            //                    if (functionalheadapproval == "" || functionalheadapproval == null) {
            //                        jAlert("Please Select the Functional Head Approval", "Message");
            //                        $("#ddfunctionalheadapproval").attr('disabled', false);
            //                        return false;
            //                        window.stop();
            //                    }


            //                }
            //                else {
            //                    $("#tctreasonfordelay").val("");
            //                    $("#ddfunctionalheadapproval").val("");
            //                    $("#tctreasonfordelay").attr('disabled', true);
            //                    $("#ddfunctionalheadapproval").attr('disabled', true);
            //                }
            //            },
            //            error: function (result) {
            //                jAlert("Error.", "Error");
            //                return false;
            //                //$("#tctreasonfordelay").attr('disabled', true);
            //            }
            //        });
            //        //var invoicegid = id;
            //        //var invoiceFHAflag = true;
            //        //$.ajax({
            //        //    url: "../SupplierInvoiceNew/FHAattachmenttype",
            //        //    type: "POST",
            //        //    dataType: "json",
            //        //    data: { InvID: invoicegid },
            //        //    success: function (response) {
            //        //        debugger;

            //        //        var data2 = "";
            //        //        if (response != null && response != "" && JSON.parse(response) != null)
            //        //            data2 = JSON.parse(response);
            //        //        if (data2[0].Msg == "Not Exists") {
            //        //            jAlert('Kindly Attach the Functional head approval', "Message");
            //        //            return false;
            //        //            window.stop();
            //        //        }
            //        //    }
            //        //});

            //    }
            //}


        }
        else {
            Invoicereceiptdate = "1900-01-01";
            reasonfordelay = "";
            functionalheadapproval = "0";
        }

        // prema changes end
        var EmpPaymentmodel = { "Amount": Invoiceamount, }
        $.post('../SupplierInvoiceNewmanual/_suppliserinvoicechkppx', EmpPaymentmodel,
      function (data) {
          if (data == "PPX") {
              //jYesNo(result, "Information", function (j) {
              jYesNo("PPX are Available...Do you want add PPX Adjustment?..", "Information", function (u) {
                  if (u == true) {
                      return false;
                  }
                  else {
                      var NewAttmodel = {
                          "InvoiceDate": Invoicedate,
                          "InvoiceNo": Invoiceno,
                          "Description": Invoicedec,
                          "Amount": Invoiceamount,
                          "SerMonth": Invoicedate,
                          "Retensionflg": rodio,
                          "Retensionper": Retentionper,
                          "Retensionamount": Retentionamount,
                          "Retensionrelse": relasedate,
                          "potype": doctypeNames,
                          "TaxableAmount": val5,
                          "Provision": Provision,
                          "InvoiceReceiptDate": Invoicereceiptdate,
                          "ReasonForDelay": reasonfordelay,
                          "FunctionalHeadApproval": functionalheadapproval,
                          "ECFDate": ECFdate,
                          "IsMSME": MSME
                      };
                      $.post('../SupplierInvoiceNewmanual/_suppliserinvoiceCreateb', NewAttmodel,
                      function (data) {
                          debugger;
                          if (data == "Reason") {
                              jAlert("Please Fill Reason for delay", "Message");
                              return false;
                              //window.stop();
                          }
                          else if (data == "FHA") {
                              jAlert("Please Select Functional Head Approver", "Message");
                              return false;
                              //window.stop();
                          }
                          else if (data == "InvDeviation") {
                              jAlert('Invoice Receipt date must be greater than Invoice Date!', "Message");
                              return false;
                          }
                          else if(data=="FHANotExists")
                          {
                              jAlert1('Kindly attach Functional Head Approver proof in the Attachment Tab!', "Message");
                              return false;
                          }
                          else if (data == "Debit") {
                              jAlert("Please Check DebitLine Details : The DebitLine Total Amount Should Be Equal To Invoice Amount", "Message");
                              return false;
                          }
                          else if (data == "Payment") {
                              jAlert("Please Check Payment Details or Tax Details : The Payment Should Be Equal To Invoice Amount", "Message");
                              return false;
                          }
                          else if (data == "POAmt") {
                              jAlert("Please Check PO Mapped Details : The Total PO Mapped Amount Should Be Equal To Invoice Amount", "Message");
                              return false;
                          }
                          else if (data == "Error") {
                              jAlert('Error..........', "Message");
                              return false;
                          }
                          else {
                              jAlert("Saved Sucessfully", "Message", function (u) {
                                  if (u == true) {
                                      $("#summaryhd1").show();
                                      $("#summaryhd2").show();

                                      $("#Invoicenewadd").slideToggle(500);

                                      var url = '@Url.Action("_supplierGridDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                                      $("#wgSuppliersuppliermain").load(url);
                                      $("#txtRetentionper").val('');
                                      $("#txtRetentionamount").val('');
                                      $("#txtrelasedate").val('');
                                      $("#hdinvoiceamt").val('0');
                                      $("#txtInvoicedate").val('');
                                      $("#txtInvoiceno").val('');
                                      $("#tctInvoicedec").val('');
                                      $("#txtInvoiceamount").val('');
                                      $("#txtsermonth").val('');
                                      $("#txtInvoicereceiptdate").val('');
                                      $("#tctreasonfordelay").val('');
                                      $("#ddfunctionalheadapproval").val('');
                                      $("#Retentionflgg").fadeOut();
                                      $("#Retentionflgg1").fadeOut();
                                      $("#Retentionflgg2").fadeOut();
                                      $("#txtInvoicedate").addClass('required');
                                      $("#txtInvoiceno").addClass('required');
                                      $("#tctInvoicedec").addClass('required');
                                      $("#txtInvoiceamount").addClass('required');
                                      $("#txtsermonth").addClass('required');
                                      $("#txtInvoicereceiptdate").addClass('required');
                                      $("#tctreasonfordelay").addClass('required');
                                      $("#ddfunctionalheadapproval").addClass('required');

                                      var $rblrblRetention = $('input:radio[name=rblRetentionflg]');
                                      $rblrblRetention.filter('[value=Yes]').prop('checked', false);
                                      $rblrblRetention.filter('[value=No]').prop('checked', true);

                                      var stylesSelect = $('#btnempNewExpensddetr');
                                      stylesSelect.attr('disabled', false);
                                      var stylesSelect = $('#viewlastthree');
                                      stylesSelect.attr('disabled', false);

                                      var stylesSelect = $('#btnSubmitfinal');
                                      stylesSelect.attr('disabled', false);
                                      var stylesSelect = $('#btnDraftfinal');
                                      stylesSelect.attr('disabled', false);
                                      var stylesSelect = $('#btnCancelfinal');
                                      stylesSelect.attr('disabled', false);
                                      var stylesSelect = $('#btnCancelfinaldash');
                                      stylesSelect.attr('disabled', false);
                                      //$("#wgSuppliersuppliermain").load('../SupplierInvoiceNewmanual/_supplierGridDetails');
                                  }
                              });
                          }
                      }, 'json');
                  }
              });
          }
          else {
              var NewAttmodel = {
                  "InvoiceDate": Invoicedate,
                  "InvoiceNo": Invoiceno,
                  "Description": Invoicedec,
                  "Amount": Invoiceamount,
                  "SerMonth": Invoicedate,
                  "Retensionflg": rodio,
                  "Retensionper": Retentionper,
                  "Retensionamount": Retentionamount,
                  "Retensionrelse": relasedate,
                  "potype": doctypeNames,
                  "TaxableAmount": val5,
                  "Provision": Provision,
                  "InvoiceReceiptDate": Invoicereceiptdate,
                  "ReasonForDelay": reasonfordelay,
                  "FunctionalHeadApproval": functionalheadapproval,
                  "ECFDate": ECFdate,
                  "IsMSME": MSME
              };
              $.post('../SupplierInvoiceNewmanual/_suppliserinvoiceCreateb', NewAttmodel,
              function (data) {
                  if (data == "Reason") {
                              jAlert("Please Fill Reason for delay", "Message");
                              return false;
                              //window.stop();
                          }
                          else if (data == "FHA") {
                              jAlert("Please Select Functional Head Approver", "Message");
                              return false;
                              //window.stop();
                          }
                          else if (data == "InvDeviation") {
                              jAlert('Invoice Receipt date must be greater than Invoice Date!', "Message");
                              return false;
                          }
                          else if(data=="FHANotExists")
                          {
                              jAlert1('Kindly attach Functional Head Approver proof in the Attachment Tab!', "Message");
                              return false;
                          }
                          else if (data == "Debit") {
                      jAlert("Please Check DebitLine Details : The DebitLine Total Amount Should Be Equal To Invoice Amount", "Message");
                      return false;
                  }
                  else if (data == "Payment") {
                      jAlert("Please Check Payment Details or Tax Details : The Payment Should Be Equal To Invoice Amount", "Message");
                      return false;
                  }
                  else if (data == "POAmt") {
                      jAlert("Please Check PO Mapped Details : The Total PO Mapped Amount Should Be Equal To Invoice Amount", "Message");
                      return false;
                  }
                  else if (data == "Error") {
                      jAlert('Error..........', "Message");
                      return false;
                  }
                  else {
                      jAlert("Saved Sucessfully", "Message", function (u) {
                          if (u == true) {
                              $("#summaryhd1").show();
                              $("#summaryhd2").show();

                              $("#Invoicenewadd").slideToggle(500);

                              var url = '@Url.Action("_supplierGridDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                              $("#wgSuppliersuppliermain").load(url);
                              $("#txtRetentionper").val('');
                              $("#txtRetentionamount").val('');
                              $("#txtrelasedate").val('');
                              $("#hdinvoiceamt").val('0');
                              $("#txtInvoicedate").val('');
                              $("#txtInvoiceno").val('');
                              $("#tctInvoicedec").val('');
                              $("#txtInvoiceamount").val('');
                              $("#txtsermonth").val('');
                              $("#Retentionflgg").fadeOut();
                              $("#Retentionflgg1").fadeOut();
                              $("#Retentionflgg2").fadeOut();
                              $("#txtInvoicedate").addClass('required');
                              $("#txtInvoiceno").addClass('required');
                              $("#tctInvoicedec").addClass('required');
                              $("#txtInvoiceamount").addClass('required');
                              $("#txtsermonth").addClass('required');

                              var $rblrblRetention = $('input:radio[name=rblRetentionflg]');
                              $rblrblRetention.filter('[value=Yes]').prop('checked', false);
                              $rblrblRetention.filter('[value=No]').prop('checked', true);

                              var stylesSelect = $('#btnempNewExpensddetr');
                              stylesSelect.attr('disabled', false);
                              var stylesSelect = $('#viewlastthree');
                              stylesSelect.attr('disabled', false);

                              var stylesSelect = $('#btnSubmitfinal');
                              stylesSelect.attr('disabled', false);
                              var stylesSelect = $('#btnDraftfinal');
                              stylesSelect.attr('disabled', false);
                              var stylesSelect = $('#btnCancelfinal');
                              stylesSelect.attr('disabled', false);
                              var stylesSelect = $('#btnCancelfinaldash');
                              stylesSelect.attr('disabled', false);
                              //$("#wgSuppliersuppliermain").load('../SupplierInvoiceNewmanual/_supplierGridDetails');
                          }
                      });
                  }
              }, 'json');
          }
      }, 'json');
    }

    function Newsupplieeinvoice() {

        $("#summaryhd1").hide();
        $("#summaryhd2").hide();

        $("#txtRetentionper").val('');
        $("#txtRetentionamount").val('');
        $("#txtrelasedate").val('');
        $("#txtInvoicedate").val('');
        $("#txtInvoiceno").val('');
        $("#tctInvoicedec").val('');
        $("#txtInvoiceamount").val('');
        $("#txtsermonth").val('');
        $("#hdinvoiceamt").val('0');
        //MSME changes -- ramya addedo n 06 sep 22
        $("#ddfunctionalheadapproval").val("0");
        $("#txtInvoicereceiptdate").val("");
        $("#tctreasonfordelay").val("");
        // end
        $("#txtRetentionper").removeClass('valid');
        $("#txtRetentionamount").removeClass('valid');
        $("#txtrelasedate").removeClass('valid');

        $("#txtInvoicedate").removeClass('valid');
        $("#txtInvoiceno").removeClass('valid');
        $("#tctInvoicedec").removeClass('valid');
        $("#txtInvoiceamount").removeClass('valid');
        $("#txtsermonth").removeClass('valid');

        $("#txtInvoicedate").addClass('required');
        $("#txtInvoiceno").addClass('required');
        $("#tctInvoicedec").addClass('required');
        $("#txtInvoiceamount").addClass('required');
        $("#txtsermonth").addClass('required');

        $("#ddlgstProviderLoc").val(0);
        $("#ddlgstReceiverLoc").val(0);
        $("#txtGSTINVendor").val('');
        $("#txtGSTINFICCL").val('');
        $('#txtInvoiceamount').val('');
        $("#tdGSTCharged").show();
        var stylesSelect = $('#txtRetentionper');
        stylesSelect.attr('disabled', true);

        var stylesSelect = $('#txtRetentionamount');
        stylesSelect.attr('disabled', true);

        var stylesSelect = $('#txtrelasedate');
        stylesSelect.attr('disabled', true);

        var GstCharged = "N";
        GstCharged = $("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value");
        //prema added for msme cr on 07-03-2022
        var ECFdate = $("#txtecfdates").val();
        var MSME = $("#txtSuppliermsme").val();
        if (MSME == "Y") {
            debugger;
            $("#MSMEROW").show();
        }
        else {
            debugger;
            $("#MSMEROW").hide();
        }
        //Ramya Aug

        if (GstCharged == "Y") {
            $("#Gsttab").show();
            //$("#Taxtab").hide();
            $("#RCMtab").hide();
            $("#hdfEditViewGstChargedFlag").val(GstCharged);
        }
        else {
            $("#Gsttab").hide();
            //$("#Taxtab").show();
            $("#RCMtab").show();
            $("#hdfEditViewGstChargedFlag").val("N");
        }

        var id = "";
        var EmpPaymentmodel = { "Invoicegid": id }
        $.post('../SupplierInvoiceNewmanual/createSupplierinvoice', EmpPaymentmodel,
      function (data) {
          if (data == 0) { location = location.href; } else {
              $("#tdGSTCharged").show();
              $("#Invoicenewadd").slideToggle(500);
              //var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNew")?' + new Date().getTime();
              var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNew")?' + new Date().getTime();
              var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNew")?' + new Date().getTime();

              var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              $("#wgempposupplier").load(pourl);

              //$("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);


              var url1 = '@Url.Action("_GetGstDetails", "SupplierInvoiceNewmanual")';
              $("#PoGstGrid").load(url1);
              var url2 = '@Url.Action("_LoadRCMDetails", "SupplierInvoiceNewmanual")';
              $("#GrdRCMdetls").load(url2);

              var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              $("#wgAttachmentsupplierinv").load(invatturl);

              $("#txtInvoicedate").addClass('required');
              $("#txtInvoiceno").addClass('required');
              $("#tctInvoicedec").addClass('required');
              $("#txtInvoiceamount").addClass('required');
              $("#txtsermonth").addClass('required');

              var $rblProvision = $('input:radio[name=rblProvisionflg]');
              $rblProvision.filter('[value=Yes]').prop('checked', true);
              $rblProvision.filter('[value=No]').prop('checked', false);
              $("#Retentionflgg").fadeOut();
              $("#Retentionflgg1").fadeOut();
              $("#Retentionflgg2").fadeOut();
              //console.log('ramya chk');
              var $rblrblRetention = $('input:radio[name=rblRetentionflg]');
              $rblrblRetention.filter('[value=Yes]').prop('checked', false);
              $rblrblRetention.filter('[value=No]').prop('checked', true);

              var stylesSelect = $('#txtInvoicedate');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#txtInvoiceno');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#tctInvoicedec');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#txtInvoiceamount');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#txtsermonth');
              stylesSelect.attr('disabled', false);

              $("#rblYesp").attr('disabled', false);
              $("#rblNop").attr('disabled', false);
              $("#rblYesr").attr('disabled', false);
              $("#rblNor").attr('disabled', false);

              $("#txtInvoicedate").addClass('required');
              $("#txtInvoiceno").addClass('required');
              $("#tctInvoicedec").addClass('required');
              $("#txtInvoiceamount").addClass('required');
              $("#txtsermonth").addClass('required');

              var stylesSelect = $('#newinvoiceadds');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btndebitlieinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnpaymentinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btntaxdinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btndebitlieinvoexcel');
              stylesSelect.attr('disabled', true);
              var stylesSelectpo = $('#btntaxdinvopo');
              stylesSelectpo.attr('disabled', true);

              var stylesSelect = $('#btnInvoiceattmt');
              stylesSelect.attr('disabled', true);

              var stylesSelect = $('#idAddinvoice');
              stylesSelect.attr('disabled', false);

              var stylesSelect = $('#btnempNewExpensddetr');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#viewlastthree');
              stylesSelect.attr('disabled', true);

              var doctypeNames = $("#doctypeNames option:selected").text();
              if (doctypeNames == "PO" || doctypeNames == "WO") {
                  $("#rblYesr").attr('disabled', false);
                  $("#rblNor").attr('disabled', false);
                  $("#rblYesp").attr('disabled', true);
                  $("#rblNop").attr('disabled', true);
              }
              else {
                  $("#rblYesp").attr('disabled', false);
                  $("#rblNop").attr('disabled', false);
                  $("#rblYesr").attr('disabled', true);
                  $("#rblNor").attr('disabled', true);
              }
              var stylesSelect = $('#btnSubmitfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnDraftfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinaldash');
              stylesSelect.attr('disabled', true);

          }
      }, 'json');
    }
    function SupplierInvoiceEdit(id) {
        debugger;
        $("#summaryhd1").hide();
        $("#summaryhd2").hide();
        //prema added for msme cr on 07-03-2022
        var MSME = $("#txtSuppliermsme").val();
        if (MSME == "Y") {
            debugger;
            $("#MSMEROW").show();
        }
        else {
            debugger;
            $("#MSMEROW").hide();
        }
        var EmpPaymentmodel = {
            "Invoicegid": id,
            "Provision": "Edit"
        }
        $.post('../EOW/SupplierInvoiceNewmanual/ViewSupplierinvoice', EmpPaymentmodel,
      function (data) {
          if (data == 0) { location = location.href; } else {
              $("#tdGSTCharged").hide();
              if (data[0].invoice_Cygnet_Gid == 0) {
                  $("#tdGSTCharged").show();
              }
              $("#Invoicenewadd").slideToggle(500);

              var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              $("#wgempposupplier").load(pourl);

              $("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);



              $("#ddlgstProviderLoc").val(data[0].ProviderLocation);
              $("#ddlgstReceiverLoc").val(data[0].ReceiverLocation);
              $("#txtGSTINVendor").val(data[0].GstinVendor);
              $("#txtGSTINFICCL").val(data[0].GstinFiccl);
              $("#ddlgstProviderLoc").addClass('valid');
              $("#ddlgstReceiverLoc").addClass('valid');
              $("#txtGSTINVendor").addClass('valid');
              $("#txtGSTINFICCL").addClass('valid');
              $(".divGSTChargedShow").show();

              //ramya added on 12 Apr 22 on MSME CR
              $("#ddfunctionalheadapproval").val(data[0].FunctionalHeadApproval);
              $("#txtInvoicereceiptdate").val(data[0].InvoiceReceiptDate);
              $("#tctreasonfordelay").val(data[0].ReasonForDelay);
              //ramya
              if (data[0].GstCharged == "Y") {
                  $("input[name=rdogstChargedFlag][value=Y]").prop("checked", true);
 //Ramya Aug
                  $("#hdfEditViewGstChargedFlag").val(data[0].GstCharged);
                  var url1 = '@Url.Action("_GetGstDetails", "SupplierInvoiceNewmanual")';
                  $("#PoGstGrid").load(url1);
                  $("#Gsttab").show();
                  $("#RCMtab").hide();
                  $("#Taxtab").hide();
              }
              else {
                 // $(".divGSTChargedShow").hide();
                  $("input[name=rdogstChargedFlag][value=N]").prop("checked", true);
                  @*var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNew")?' + new Date().getTime();
                  $("#wgempTaxsupplier").load(taxurl);*@
                  $("#Gsttab").hide();
                  $("#Taxtab").hide();
                  $("#RCMtab").show();
                  var url2 = '@Url.Action("_LoadRCMDetails", "SupplierInvoiceNewmanual")';
                  $("#GrdRCMdetls").load(url2);
                 /* $("#ddlgstProviderLoc").val(0);
                  $("#ddlgstReceiverLoc").val(0);
                  $("#txtGSTINVendor").val('');
                  $("#txtGSTINFICCL").val('');*/
              }

              var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              $("#wgAttachmentsupplierinv").load(invatturl);

              $("#txtInvoicedate").val(data[0].InvoiceDate);
              $("#txtInvoiceno").val(data[0].InvoiceNo);
              $("#tctInvoicedec").val(data[0].Description);
              $("#txtInvoicereceiptdate").val(data[0].InvoiceReceiptDate);
              $("#tctreasonfordelay").val(data[0].ReasonForDelay);
              $("#ddfunctionalheadapproval").val(data[0].FunctionalHeadApproval);
              var currentval = data[0].Amount;
              var testDecimal = testDecimals(currentval);
              if (testDecimal.length > 1) {
                  currentval = currentval.slice(0, -1);
              }
              var tolnew = replaceCommas(currentval);
              $('#txtInvoiceamount').val(tolnew);

              var taxableAmount = data[0].TaxableAmount;
              var testDecimal1 = testDecimals(taxableAmount);
              if (testDecimal1.length > 1) {
                  taxableAmount = taxableAmount.slice(0, -1);
              }
              var tolnew1 = replaceCommas(taxableAmount);
              $('#txtWithoutTaxAmount').val(tolnew1);


              //$("#txtInvoiceamount").val(data[0].Amount);
              $("#txtsermonth").val(data[0].SerMonth);
              $("#hdinvoiceamt").val(data[0].Amount);
              var txtsermonthnew = $("#txtInvoicedate").val();
              if (txtsermonthnew.trim() != "") {
                  $("#txtsermonth").addClass('valid');
                  getmonth(txtsermonthnew);
              }
              else {
                  $("#txtsermonth").addClass('required');
              }


              var renflg = data[0].Retensionflg;

              $("#txtInvoicedate").addClass('valid');
              $("#txtInvoiceno").addClass('valid');
              $("#tctInvoicedec").addClass('valid');
              $("#txtInvoiceamount").addClass('valid');
              $("#txtsermonth").addClass('valid');
              $("#txtInvoicereceiptdate").addClass('valid');
              $("#tctreasonfordelay").addClass('valid');
              $("#ddfunctionalheadapproval").addClass('valid');
              var stylesSelect = $('#txtInvoicedate');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#txtInvoiceno');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#tctInvoicedec');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#txtInvoiceamount');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#txtsermonth');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#txtInvoicereceiptdate');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#tctreasonfordelay');
              stylesSelect.attr('disabled', false);
              $("#rblYesp").attr('disabled', false);
              $("#rblNop").attr('disabled', false);
              $("#rblYesr").attr('disabled', false);
              $("#rblNor").attr('disabled', false);

              var $radios = $('input:radio[name=rblRetentionflg]');
              if (renflg == "Y") {
                  $("#Retentionflgg").fadeIn();
                  $("#Retentionflgg1").fadeIn();
                  $("#Retentionflgg2").fadeIn();
                  $radios.filter('[value=Yes]').prop('checked', true);
                  $("#txtRetentionper").val(data[0].Retensionper);

                  var currentval = data[0].Retensionamount;
                  var testDecimal = testDecimals(currentval);
                  if (testDecimal.length > 1) {
                      currentval = currentval.slice(0, -1);
                  }
                  var tolnew = replaceCommas(currentval);
                  $('#txtRetentionamount').val(tolnew);
                  //$("#txtRetentionamount").val(data[0].Retensionamount);
                  $("#txtrelasedate").val(data[0].Retensionrelse);
                  var stylesSelect = $('#txtRetentionper');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#txtRetentionamount');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#txtrelasedate');
                  stylesSelect.attr('disabled', false);
                  $("#txtRetentionper").removeClass('valid');
                  $("#txtRetentionamount").removeClass('valid');
                  $("#txtrelasedate").removeClass('valid');

              }
              else {
                  $radios.filter('[value=No]').prop('checked', true);
                  $("#Retentionflgg").fadeOut();
                  $("#Retentionflgg1").fadeOut();
                  $("#Retentionflgg2").fadeOut();
                  $("#txtRetentionper").val('');
                  $("#txtRetentionamount").val('');
                  $("#txtrelasedate").val('');
                  var stylesSelect = $('#txtRetentionper');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtRetentionamount');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtrelasedate');
                  stylesSelect.attr('disabled', true);
                  $("#txtRetentionper").removeClass('required');
                  $("#txtRetentionamount").removeClass('required');
                  $("#txtRetentionper").removeClass('valid');
                  $("#txtRetentionamount").removeClass('valid');
                  $("#txtrelasedate").removeClass('required');
                  $("#txtrelasedate").removeClass('valid');
              }
              var renflg = data[0].Provision;

              var $rblProvision = $('input:radio[name=rblProvisionflg]');
              if (renflg == "Y") {
                  $rblProvision.filter('[value=Yes]').prop('checked', true);
              }
              else {
                  $rblProvision.filter('[value=No]').prop('checked', true);
              }
              var stylesSelect = $('#newinvoiceadds');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btndebitlieinvo');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btnpaymentinvo');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btntaxdinvo');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btndebitlieinvoexcel');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btntaxdinvopo');
              stylesSelect.attr('disabled', false);

              var stylesSelect = $('#btnInvoiceattmt');
              stylesSelect.attr('disabled', false);

              var stylesSelect = $('#idAddinvoice');
              stylesSelect.attr('disabled', false);
              var stylesSelect = $('#btnempNewExpensddetr');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#viewlastthree');
              stylesSelect.attr('disabled', true);

              var doctypeNames = $("#doctypeNames option:selected").text();
              if (doctypeNames == "PO" || doctypeNames == "WO") {
                  $("#rblYesr").attr('disabled', false);
                  $("#rblNor").attr('disabled', false);
                  $("#rblYesp").attr('disabled', true);
                  $("#rblNop").attr('disabled', true);
              }
              else {
                  $("#rblYesp").attr('disabled', false);
                  $("#rblNop").attr('disabled', false);
                  $("#rblYesr").attr('disabled', true);
                  $("#rblNor").attr('disabled', true);
              }

              var stylesSelect = $('#btnSubmitfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnDraftfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinaldash');
              stylesSelect.attr('disabled', true);


              if (data[0].invoice_Cygnet_Gid != "0") {//IEM_GST_Phase3
                  var stylesSelect = $('#idAddinvoice');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#txtInvoicedate');
                  stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#txtInvoiceno');
                  stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#tctInvoicedec');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#txtInvoiceamount');
                  stylesSelect.attr('disabled', true);
                  //var stylesSelect = $('#txtWithoutTaxAmount');
                  //stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#txtsermonth');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#newinvoiceadds');
                  stylesSelect.attr('disabled', false);
                  //var stylesSelect = $('#btndebitlieinvo');
                  //stylesSelect.attr('disabled', true);
                  //var stylesSelect = $('#btnpaymentinvo');
                  //stylesSelect.attr('disabled', true);
                  //var stylesSelect = $('#btntaxdinvo');
                  //stylesSelect.attr('disabled', true);
                  //var stylesSelect = $('#btndebitlieinvoexcel');
                  //stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#btntaxdinvopo');
                  stylesSelect.attr('disabled', true);

                  //var stylesSelect = $('#btnInvoiceattmt');
                  //stylesSelect.attr('disabled', true);
                  //IEM_GST_Phase3
                  var stylesSelect = $('#ddlgstProviderLoc');
                  stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#ddlgstReceiverLoc');
                  stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#txtGSTINVendor');
                  stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#txtGSTINFICCL');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtWithoutTaxAmount');
                  stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#txtsermonth');
                  stylesSelect.attr('disabled', true);
              }
              else {
                  var stylesSelect = $('#txtInvoicedate');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#txtInvoiceno');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#tctInvoicedec');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#txtInvoiceamount');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#txtWithoutTaxAmount');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#txtsermonth');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#newinvoiceadds');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#btndebitlieinvo');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#btnpaymentinvo');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#btntaxdinvo');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#btndebitlieinvoexcel');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#btntaxdinvopo');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#btnInvoiceattmt');
                  stylesSelect.attr('disabled', false);

                  var stylesSelect = $('#idAddinvoice');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#btnempNewExpensddetr');
                  stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#viewlastthree');
                  stylesSelect.attr('disabled', true);

                  //var stylesSelect = $('#rdogstChargedFlagNo');
                  //stylesSelect.attr('disabled', true);
                  //var stylesSelect = $('#rdogstChargedFlagYes');
                  //stylesSelect.attr('disabled', true);
                  var stylesSelect = $('#txtGSTINFICCL');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#txtGSTINVendor');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#ddlgstReceiverLoc');
                  stylesSelect.attr('disabled', false);
                  var stylesSelect = $('#ddlgstProviderLoc');
                  stylesSelect.attr('disabled', false);

              }
          }
      }, 'json');
    }

    function getmonth(date) {
        if (date.length == 10) {
            var ddd = isgetmonthyear(date);
            if (ddd == "Error") {
                $("#txtsermonth").val('')
            }
            else {
                $("#txtsermonth").val(ddd)
            }
        }
        else {
            $("#txtsermonth").val('')
        }
    }
    function isgetmonthyear(evt) {
        var retnval;
        var str = evt;
        var array = str.split('-');

        if (array[1] == "01") {
            retnval = "January-" + array[2];
            return retnval;
        }
        if (array[1] == "02") {
            retnval = "February-" + array[2]; return retnval;
        }
        if (array[1].trim() == "03") {
            retnval = "March-" + array[2]; return retnval;
        }
        if (array[1].trim() == "04") {
            retnval = "April-" + array[2]; return retnval;
        }
        if (array[1].trim() == "05") {
            retnval = "May-" + array[2]; return retnval;
        }
        if (array[1].trim() == "06") {
            retnval = "June-" + array[2]; return retnval;
        }
        if (array[1].trim() == "07") {
            retnval = "July-" + array[2]; return retnval;
        }
        if (array[1].trim() == "08") {
            retnval = "August-" + array[2]; return retnval;
        }
        if (array[1].trim() == "09") {
            retnval = "September-" + array[2]; return retnval;
        }
        if (array[1].trim() == "10") {
            retnval = "October-" + array[2]; return retnval;
        }
        if (array[1].trim() == "11") {
            retnval = "November-" + array[2]; return retnval;
        }
        if (array[1].trim() == "12") {
            retnval = "December-" + array[2]; return retnval;
        }
        else {
            retnval = "Error"; return retnval;
        }
        return retnval;
    }
    function SupplierInvoiceViewm(id) {
        $("#summaryhd1").hide();
        $("#summaryhd2").hide();
        //prema added for msme cr on 07-03-2022
        var MSME = $("#txtSuppliermsme").val();
        if (MSME == "Y") {
            debugger;
            $("#MSMEROW").show();
        }
        else {
            debugger;
            $("#MSMEROW").hide();
        }
        var EmpPaymentmodel = {
            "Invoicegid": id,
            "Provision": "View"
        }
        $.post('../EOW/SupplierInvoiceNewmanual/ViewSupplierinvoice', EmpPaymentmodel,
      function (data) {
          if (data == 0) { location = location.href; } else {
              $("#tdGSTCharged").hide();
              if (data[0].invoice_Cygnet_Gid == 0) {
                  $("#tdGSTCharged").show();
              }
              $("#Invoicenewadd").slideToggle(500);
              @*var taxurl = "@(Html.Raw(Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewmanual")))";
              var traurl = "@(Html.Raw(Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewmanual")))";
              var payurl = "@(Html.Raw(Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewmanual")))";

              $("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);*@
              //var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              var traurl = '@Url.Action("_TabdebitlineDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              var payurl = '@Url.Action("_SupplierPaymentGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              var pourl = '@Url.Action("_PODetailsGrid", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              $("#wgempposupplier").load(pourl);

              //$("#wgempTaxsupplier").load(taxurl);
              $("#wgTravelmodeotab2").load(traurl);
              $("#wgempPaymensupplier").load(payurl);

              var invatturl = '@Url.Action("_InvoiceAttachmentDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
              $("#wgAttachmentsupplierinv").load(invatturl);

              if (data[0].GstCharged == "Y") {
                  //Ramya Aug
                  $("#hdfEditViewGstChargedFlag").val(data[0].GstCharged);
                  $("input[name=rdogstChargedFlag][value=Y]").prop("checked", true);
                  var url1 = '@Url.Action("_GetGstDetails", "SupplierInvoiceNewmanual")';
                  $("#PoGstGrid").load(url1);
                  $("#Gsttab").show();
                  $("#Taxtab").hide();
                  $("#RCMtab").hide();
              }
              else {
                  //$(".divGSTChargedShow").hide();
                  $("#hdfEditViewGstChargedFlag").val("N");
                  $("input[name=rdogstChargedFlag][value=N]").prop("checked", true);
                  @*var taxurl = '@Url.Action("_SupplierTaxDetailsGrid", "SupplierInvoiceNew")?' + new Date().getTime();
                  $("#wgempTaxsupplier").load(taxurl);*@
                  var url2 = '@Url.Action("_LoadRCMDetails", "SupplierInvoiceNewmanual")';
                  $("#GrdRCMdetls").load(url2);
                  $("#Gsttab").hide();
                  $("#Taxtab").hide();
                  $("#RCMtab").show();
              }
              $("#txtInvoicedate").val(data[0].InvoiceDate);
              $("#txtInvoiceno").val(data[0].InvoiceNo);
              $("#tctInvoicedec").val(data[0].Description);
              $("#txtInvoicereceiptdate").val(data[0].InvoiceReceiptDate);
              $("#tctreasonfordelay").val(data[0].ReasonForDelay);
              $("#ddfunctionalheadapproval").val(data[0].FunctionalHeadApproval);
              var currentval = data[0].Amount;
              var testDecimal = testDecimals(currentval);
              if (testDecimal.length > 1) {
                  currentval = currentval.slice(0, -1);
              }
              var tolnew = replaceCommas(currentval);
              $('#txtInvoiceamount').val(tolnew);
              //$("#txtInvoiceamount").val(data[0].Amount);
              $("#txtsermonth").val(data[0].SerMonth);

              $("#hdinvoiceamt").val(data[0].Amount);

              var txtsermonthnew = $("#txtInvoicedate").val();
              if (txtsermonthnew.trim() != "") {
                  $("#txtsermonth").addClass('valid');
                  getmonth(txtsermonthnew);
              }
              else {
                  $("#txtsermonth").addClass('required');
              }

              $("#txtInvoicedate").addClass('valid');
              $("#txtInvoiceno").addClass('valid');
              $("#tctInvoicedec").addClass('valid');
              $("#txtInvoiceamount").addClass('valid');
              $("#txtsermonth").addClass('valid');
              $("#txtInvoicereceiptdate").addClass('valid');
              $("#tctreasonfordelay").addClass('valid');
              $("#ddfunctionalheadapproval").addClass('valid');
              var renflg = data[0].Retensionflg;
              var stylesSelect = $('#txtInvoicedate');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#txtInvoiceno');
              stylesSelect.attr('disabled', true);
              var renflg = data[0].Retensionflg;
              var stylesSelect = $('#tctInvoicedec');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#txtInvoiceamount');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#txtsermonth');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#txtInvoicereceiptdate');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#tctreasonfordelay');
              stylesSelect.attr('disabled', true);
              //var stylesSelect = $('#rblYes');
              //stylesSelect.attr('disabled', true);
              //var stylesSelect = $('#rblNo');
              //stylesSelect.attr('disabled', true);
              $("#rblYesp").attr('disabled', true);
              $("#rblNop").attr('disabled', true);
              $("#rblYesr").attr('disabled', true);
              $("#rblNor").attr('disabled', true);

              var $radios = $('input:radio[name=rblRetentionflg]');
              if (renflg == "Y") {
                  $radios.filter('[value=Yes]').prop('checked', true);
                  $("#Retentionflgg").fadeIn();
                  $("#Retentionflgg1").fadeIn();
                  $("#Retentionflgg2").fadeIn();
                  $("#txtRetentionper").val(data[0].Retensionper);

                  var currentval = data[0].Retensionamount;
                  var testDecimal = testDecimals(currentval);
                  if (testDecimal.length > 1) {
                      currentval = currentval.slice(0, -1);
                  }
                  var tolnew = replaceCommas(currentval);
                  $('#txtRetentionamount').val(tolnew);

                  // $("#txtRetentionamount").val(data[0].Retensionamount);
                  $("#txtrelasedate").val(data[0].Retensionrelse);
                  var stylesSelect = $('#txtRetentionper');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtRetentionamount');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtrelasedate');
                  stylesSelect.attr('disabled', true);
                  $("#txtRetentionper").removeClass('valid');
                  $("#txtRetentionamount").removeClass('valid');
                  $("#txtrelasedate").removeClass('valid');
              }
              else {
                  $radios.filter('[value=No]').prop('checked', true);
                  $("#Retentionflgg").fadeOut();
                  $("#Retentionflgg1").fadeOut();
                  $("#Retentionflgg2").fadeOut();
                  $("#txtRetentionper").val('');
                  $("#txtRetentionamount").val('');
                  $("#txtrelasedate").val('');
                  var stylesSelect = $('#txtRetentionper');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtRetentionamount');
                  stylesSelect.attr('disabled', true);

                  var stylesSelect = $('#txtrelasedate');
                  stylesSelect.attr('disabled', true);
                  $("#txtRetentionper").removeClass('required');
                  $("#txtRetentionamount").removeClass('required');
                  $("#txtRetentionper").removeClass('valid');
                  $("#txtRetentionamount").removeClass('valid');
                  $("#txtrelasedate").removeClass('required');
                  $("#txtrelasedate").removeClass('valid');
              }
              var renflg = data[0].Provision;

              var $rblProvision = $('input:radio[name=rblProvisionflg]');
              if (renflg == "Y") {
                  $rblProvision.filter('[value=Yes]').prop('checked', true);
              }
              else {
                  $rblProvision.filter('[value=No]').prop('checked', true);
              }
              var stylesSelect = $('#newinvoiceadds');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btndebitlieinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnpaymentinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btntaxdinvo');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btndebitlieinvoexcel');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btntaxdinvopo');
              stylesSelect.attr('disabled', true);

              var stylesSelect = $('#btnInvoiceattmt');
              stylesSelect.attr('disabled', true);

              var stylesSelect = $('#idAddinvoice');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnempNewExpensddetr');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#viewlastthree');
              stylesSelect.attr('disabled', true);


              var stylesSelect = $('#btnSubmitfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnDraftfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinal');
              stylesSelect.attr('disabled', true);
              var stylesSelect = $('#btnCancelfinaldash');
              stylesSelect.attr('disabled', true);
          }
      }, 'json');
    }

    function SupplierInvoiceDeleteMAIN(id) {
        jConfirm("Do you want to delete Invoice...? ", "Message", function (u) {
            if (u == true) {
                var EmpExpensemodel = { "TravelMode_GID": id }
                $.post('../EOW/SupplierInvoiceNewmanual/DeleteSupppersdExpense', EmpExpensemodel,
                function (data) {
                    if (data == 0) { location = location.href; } else {
                        var url = '@Url.Action("_supplierGridDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                        $("#wgSuppliersuppliermain").load(url);

                        var urlatt = '@Url.Action("_supplierAttachmentDetails", "SupplierInvoiceNewmanual")?' + new Date().getTime();
                        $("#wgAttachmentsupplier").load(urlatt);
                    }
                }, 'json');
            }
        });
    }
    function Newsupplieeinvoicelast() {
        var url = '@Url.Action("_Lastthrrmonth", "SupplierInvoiceNewmanual")?' + new Date().getTime();
        objlastthreemontth.load(url);
        objlastthreemontth.dialog({ title: 'Last Three Month Invoice ' });
        objlastthreemontth.dialog("open");
    }

    $(document).ready(function () {

        $("#txtInvoicedate").keyup(function () {
            var txtContractFrom = $("#txtInvoicedate").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoicedate").removeClass('required');
                $("#txtInvoicedate").addClass('valid');
                var resultr = invoicedatecheck($("#txtInvoicedate").val());
            }
            else {
                $("#txtInvoicedate").removeClass('valid');
                $("#txtInvoicedate").addClass('required');
            }
        });
        $("#txtInvoicedate").change(function () {
            var txtContractFrom = $("#txtInvoicedate").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoicedate").removeClass('required');
                $("#txtInvoicedate").addClass('valid');
                var resultr = invoicedatecheck($("#txtInvoicedate").val());
            }
            else {
                $("#txtInvoicedate").removeClass('valid');
                $("#txtInvoicedate").addClass('required');
            }
        });

        $("#txtInvoiceno").keyup(function () {
            var txtContractFrom = $("#txtInvoiceno").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoiceno").removeClass('required');
                $("#txtInvoiceno").addClass('valid');
            }
            else {
                $("#txtInvoiceno").removeClass('valid');
                $("#txtInvoiceno").addClass('required');
            }
        });
        $("#txtInvoiceno").change(function () {
            var txtContractFrom = $("#txtInvoiceno").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoiceno").removeClass('required');
                $("#txtInvoiceno").addClass('valid');
            }
            else {
                $("#txtInvoiceno").removeClass('valid');
                $("#txtInvoiceno").addClass('required');
            }
        });

        $("#tctInvoicedec").keyup(function () {
            var txtContractFrom = $("#tctInvoicedec").val();
            if (txtContractFrom.trim() != "0") {
                $("#tctInvoicedec").removeClass('required');
                $("#tctInvoicedec").addClass('valid');
            }
            else {
                $("#tctInvoicedec").removeClass('valid');
                $("#tctInvoicedec").addClass('required');
            }
        });
        $("#tctInvoicedec").change(function () {
            var txtContractFrom = $("#tctInvoicedec").val();
            if (txtContractFrom.trim() != "0") {
                $("#tctInvoicedec").removeClass('required');
                $("#tctInvoicedec").addClass('valid');
            }
            else {
                $("#tctInvoicedec").removeClass('valid');
                $("#tctInvoicedec").addClass('required');
            }
        });

        $("#txtInvoiceamount").keyup(function () {
            var txtContractFrom = $("#txtInvoiceamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoiceamount").removeClass('required');
                $("#txtInvoiceamount").addClass('valid');
            }
            else {
                $("#txtInvoiceamount").removeClass('valid');
                $("#txtInvoiceamount").addClass('required');
            }
        });
        $("#txtInvoiceamount").change(function () {
            var txtContractFrom = $("#txtInvoiceamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtInvoiceamount").removeClass('required');
                $("#txtInvoiceamount").addClass('valid');
            }
            else {
                $("#txtInvoiceamount").removeClass('valid');
                $("#txtInvoiceamount").addClass('required');
            }
        });

 $("#txtWithoutTaxAmount").change(function () {

            var WTAmount = $("#txtWithoutTaxAmount").val();
            if (WTAmount.trim() != "") {
                $("#txtWithoutTaxAmount").removeClass('required');
                $("#txtWithoutTaxAmount").addClass('valid');
            }
            else {
                $("#txtWithoutTaxAmount").removeClass('valid');
                $("#txtWithoutTaxAmount").addClass('required');
            }
        });

        $("#txtWithoutTaxAmount").keyup(function () {

            var WTAmount = $("#txtWithoutTaxAmount").val();
            if (WTAmount.trim() != "") {
                $("#txtWithoutTaxAmount").removeClass('required');
                $("#txtWithoutTaxAmount").addClass('valid');
            }
            else {
                $("#txtWithoutTaxAmount").removeClass('valid');
                $("#txtWithoutTaxAmount").addClass('required');
            }
        });
        $("#txtsermonth").keyup(function () {
            var txtContractFrom = $("#txtsermonth").val();
            if (txtContractFrom.trim() != "") {
                $("#txtsermonth").removeClass('required');
                $("#txtsermonth").addClass('valid');
            }
            else {
                $("#txtsermonth").removeClass('valid');
                $("#txtsermonth").addClass('required');
            }
        });
        $("#txtsermonth").change(function () {
            var txtContractFrom = $("#txtsermonth").val();
            if (txtContractFrom.trim() != "") {
                $("#txtsermonth").removeClass('required');
                $("#txtsermonth").addClass('valid');
            }
            else {
                $("#txtsermonth").removeClass('valid');
                $("#txtsermonth").addClass('required');
            }
        });


        var rodio = $("input[name=rblRetentionflg]:checked").val()
        if (rodio == 'undefined' || rodio == null) {
            $("#txtRetentionper").removeClass('required');
            $("#txtRetentionamount").removeClass('required');
            $("#txtRetentionper").removeClass('valid');
            $("#txtRetentionamount").removeClass('valid');

            $("#txtrelasedate").removeClass('valid');
            $("#txtrelasedate").removeClass('required');
        }
        else if (rodio == "Yes") {
            $("#Retentionflgg").fadeIn();
            $("#Retentionflgg1").fadeIn();
            $("#Retentionflgg2").fadeIn();
            var txtContractFrom = $("#txtRetentionper").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionper").removeClass('required');
                $("#txtRetentionper").addClass('valid');
            }
            else {
                $("#txtRetentionper").removeClass('valid');
                $("#txtRetentionper").addClass('required');
            }
            var txtContractFrom = $("#txtRetentionamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionamount").removeClass('required');
                $("#txtRetentionamount").addClass('valid');
            }
            else {
                $("#txtRetentionamount").removeClass('valid');
                $("#txtRetentionamount").addClass('required');
            }
            var txtContractFrom = $("#txtrelasedate").val();
            if (txtContractFrom.trim() != "") {
                $("#txtrelasedate").removeClass('required');
                $("#txtrelasedate").addClass('valid');
            }
            else {
                $("#txtrelasedate").removeClass('valid');
                $("#txtrelasedate").addClass('required');
            }
        }
        else if (rodio == "No") {
            $("#Retentionflgg").fadeOut();
            $("#Retentionflgg1").fadeOut();
            $("#Retentionflgg2").fadeOut();
            $("#txtRetentionper").removeClass('required');
            $("#txtRetentionamount").removeClass('required');
            $("#txtRetentionper").removeClass('valid');
            $("#txtRetentionamount").removeClass('valid');
            $("#txtrelasedate").removeClass('required');
            $("#txtrelasedate").removeClass('valid');
        }




        $("#txtRetentionper").keyup(function () {
            var txtContractFrom = $("#txtRetentionper").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionper").removeClass('required');
                $("#txtRetentionper").addClass('valid');
            }
            else {
                $("#txtRetentionper").removeClass('valid');
                $("#txtRetentionper").addClass('required');
            }
        });
        $("#txtRetentionper").change(function () {
            var txtContractFrom = $("#txtRetentionper").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionper").removeClass('required');
                $("#txtRetentionper").addClass('valid');
            }
            else {
                $("#txtRetentionper").removeClass('valid');
                $("#txtRetentionper").addClass('required');
            }
        });

        $("#txtRetentionamount").keyup(function () {
            var txtContractFrom = $("#txtRetentionamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionamount").removeClass('required');
                $("#txtRetentionamount").addClass('valid');
            }
            else {
                $("#txtRetentionamount").removeClass('valid');
                $("#txtRetentionamount").addClass('required');
            }
        });
        $("#txtRetentionamount").change(function () {
            var txtContractFrom = $("#txtRetentionamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtRetentionamount").removeClass('required');
                $("#txtRetentionamount").addClass('valid');
            }
            else {
                $("#txtRetentionamount").removeClass('valid');
                $("#txtRetentionamount").addClass('required');
            }
        });
        $("#txtrelasedate").keyup(function () {
            var txtContractFrom = $("#txtrelasedate").val();
            if (txtContractFrom.trim() != "") {
                $("#txtrelasedate").removeClass('required');
                $("#txtrelasedate").addClass('valid');
            }
            else {
                $("#txtrelasedate").removeClass('valid');
                $("#txtrelasedate").addClass('required');
            }
        });
        $("#txtrelasedate").change(function () {
            var txtContractFrom = $("#txtRetentionamount").val();
            if (txtContractFrom.trim() != "") {
                $("#txtrelasedate").removeClass('required');
                $("#txtrelasedate").addClass('valid');
            }
            else {
                $("#txtrelasedate").removeClass('valid');
                $("#txtrelasedate").addClass('required');
            }
        });

    });
</script>



<script>

    var UrlHelper = "@Url.Action("GetAutoCompleteCourier", "EOWHelper")"
    UrlHelper = UrlHelper.replace("GetAutoCompleteCourier", "");

    $(document).ready(function () { 
        $("#txtGSTINVendor,#txtGSTINFICCL").val("");
        $("#ddlgstReceiverLoc,#ddlgstProviderLoc").removeClass("valid").removeClass("required").addClass("required");
        $("input[name=rdogstChargedFlag][value=N]").prop("checked", true);
        $(".viewForIvoice").css("display", "");
        $('#divInvoice').attr("style", "display:block;");
        $(".divGSTChargedShow").show();
        $("#Gsttab").hide();
        $("#Taxtab").hide();
        $("#RCMtab").hide();

        /*  $("#rdogstChargedFlagNo").change(function () {
            $("#ddlgstProviderLoc").val("0");
            $("#ddlgstReceiverLoc").val("0");
            $("#txtGSTINVendor").val("");
            $("#txtGSTINFICCL").val("");

            $("#ddlgstProviderLoc,#ddlgstReceiverLoc").removeClass("valid").removeClass("required");
            $("#ddlgstProviderLoc,#ddlgstReceiverLoc").addClass("required");

            if ($("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value") == "Y" && $("#doctypeNames").val() != "1" && $("#doctypeNames").val() != "2") {
                $(".divGSTChargedShow").show();
            }
            else
                $(".divGSTChargedShow").hide();
        });

        $("#rdogstChargedFlagYes").change(function () {

            $("#ddlgstProviderLoc").val("0");
            $("#ddlgstReceiverLoc").val("0");
            $("#txtGSTINVendor").val("");
            $("#txtGSTINFICCL").val("");

            $("#ddlgstProviderLoc,#ddlgstReceiverLoc").removeClass("valid").removeClass("required");
            $("#ddlgstProviderLoc,#ddlgstReceiverLoc").addClass("required");

            if ($("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value") == "Y" && $("#doctypeNames").val() != "1" && $("#doctypeNames").val() != "2")
                $(".divGSTChargedShow").show();
            else
                $(".divGSTChargedShow").hide();

        });*/

        LoadGSTINCategory();
       
        $("#ddlgstReceiverLoc").change(function () {
            $("#ddlgstReceiverLoc").removeClass("valid").removeClass("required");
            var value = $(this).val();
            if (value != null && value != "0" && value != "") {
                $("#ddlgstReceiverLoc").addClass("valid");
            } else { $("#ddlgstReceiverLoc").addClass("required"); }

            var _text = $('#ddlgstReceiverLoc option:selected').attr('title');
            $("#txtGSTINFICCL").val(_text);
        });
        $("#ddlgstProviderLoc").change(function () {
            $("#ddlgstProviderLoc").removeClass("valid").removeClass("required");
            var value = $(this).val();
            if (value != null && value != "0" && value != "") {
                $("#ddlgstProviderLoc").addClass("valid");
            } else { $("#ddlgstProviderLoc").addClass("required"); }

            var _text = $('#ddlgstProviderLoc option:selected').attr('title');
            $("#txtGSTINVendor").val(_text);
        });
    });

    function LoadGSTINCategory() {
        var _tmpFilter = {
            ViewType: "5",
            RefId: "0"
        };
        $.ajax({
            type: "post",
            url: '../EOWHelper/GetGSTINArray/',
            data: JSON.stringify(_tmpFilter),
            async: false,
            contentType: "application/json;",
            success: function (response) {
                var data2 = "";
                if (response.Data1 != null && response.Data1 != "" && JSON.parse(response.Data1) != null)
                    data2 = JSON.parse(response.Data1);
                $("#ddlgstReceiverLoc").empty();
                if (data2.length > 0) {
                    //$("#ddlgstReceiverLoc").append("<option value='0' >--Select--</option>");
                    for (var i = 0; i < data2.length; i++) {
                        var stylesSelect = $('#ddlgstReceiverLoc');
                        stylesSelect.attr('disabled', false);
                        $("#ddlgstReceiverLoc").append("<option value=" + data2[i].Id + " title=" + data2[i].Value1 + " >" + data2[i].Value + "</option>");
                        var stylesSelect = $('#ddlgstProviderLoc');
                        stylesSelect.attr('disabled', false);
                        $("#ddlgstProviderLoc").append("<option value=" + data2[i].Id + " title=" + data2[i].Value1 + " >" + data2[i].Value + "</option>");
                    }
                }
                if (data2.length == 0) {
                    $("#ddlgstReceiverLoc").append("<option value='0' >--Select--</option>");
                    var stylesSelect = $('#ddlgstReceiverLoc');
                    stylesSelect.attr('disabled', true);
                }
                if (data2.length == 0) {
                    $("#ddlgstProviderLoc").append("<option value='0' >--Select--</option>");
                    var stylesSelect = $('#ddlgstProviderLoc');
                    stylesSelect.attr('disabled', true);
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {

                }
            });


            var RefId = $("#txtSuppliercodegid").val(); //var RefId = "5838";
            //alert($("#txtSuppliercodegid").val());
            var _Filter = {
                ViewType: "1",
                RefId: RefId
            };
            $.ajax({
                type: "post",
                url: UrlHelper + "GetGSTINArray",
                data: JSON.stringify(_Filter),
                async: false,
                contentType: "application/json;",
                success: function (response) {
                    var data2 = "";
                    if (response.Data1 != null && response.Data1 != "" && JSON.parse(response.Data1) != null)
                        data2 = JSON.parse(response.Data1);
                    $("#ddlgstProviderLoc").empty();
                    if (data2.length > 0) {
                        //$("#ddlgstProviderLoc").append("<option value='0' >--Select--</option>");
                        for (var i = 0; i < data2.length; i++) {
                            var stylesSelect = $('#ddlgstProviderLoc');
                            stylesSelect.attr('disabled', false);
                            $("#ddlgstProviderLoc").append("<option value=" + data2[i].Id + " title=" + data2[i].Value1 + " >" + data2[i].Value + "</option>");
                        }
                    }

                    if (data2.length == 0) {
                        $("#ddlgstProviderLoc").append("<option value='0' >--Select--</option>");
                        var stylesSelect = $('#ddlgstProviderLoc');
                        stylesSelect.attr('disabled', true);
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {

                }
            });


    };
    </script>