@model IEM.Areas.EOW.Models.EOW_TravelClaim
@using IEM.Areas.EOW.Models

@{
    EOW_TravelClaim tsh = (EOW_TravelClaim)ViewBag.EOW_EmployeeeExpenseheader;
    EOW_EmployeeeExpense sh = (EOW_EmployeeeExpense)ViewBag.EOW_Employeeheader;
}

<style>
    .wht {
        width: 100%;
    }

    .txtarea {
        width: 100%;
        height: 50px;
        resize: none;
    }

    .withd {
        width: 100%;
    }

    .disp {
        display: none;
    }

    .diapy {
        display: none;
    }

    .wth {
        width: 100%;
        height: 60px;
    }
</style> 

<div id="createTravelmoceqwer"> 
    @using (Html.BeginForm())
    {
        <div style="padding:0;margin:0;">
        
            <input type="hidden" id="ecfamomtssessiontmnew" value="@Session["Ecfamountvalmain"]" />
            <input type="hidden" id="ecfamomtssessiontm" value="@Session["Ecfamountvaltm"]" />
            <input type="hidden" id="newadding" value="@Session["Ecfrowtolamt"]" />
            <input type="hidden" id="hdraiserfcc" value="@Session["raiserfcc"]" />
            <input type="hidden" id="hdraiserccc" value="@Session["raiserccc"]" />
            <input type="hidden" id="hdnExpids" value="0" />
            <table style="width: 100%;">
                <tr>
                    <td style="width: 75%;background-color: #F5F5F5;border-radius: 10px;padding: 2px 12px 0px 10px; vertical-align:top;">

                        <table class="myTableStyleTabNew">
                            <tr>
                                <td style="width:15%">
                                    <span>Nature of Expenses</span><br />
                                    @Html.DropDownListFor(model => model.NatureofExpensesId, tsh.ExpNatureofExpdata, new { @class = "textboxStyle required", @id = "ddlNatureofExpensest" })
                                </td>
                                <td style="width:15%">
                                    <span>Expense Category</span><br />
                                    @Html.DropDownListFor(model => model.ExpenseCategoryId, Enumerable.Empty<SelectListItem>(), "--Select--", new { @class = "textboxStyle required", @id = "ddlExpenseCategoryt" })
                                </td>
                                <td style="width:17%">
                                    <span>Sub Category</span><br />
                                    @Html.DropDownListFor(model => model.SubCategoryId, Enumerable.Empty<SelectListItem>(), "--Select--", new { @class = "wht textboxStyle required", @id = "ddlSubCategoryt", @style = "width:85% !important;" })
                                    &nbsp; <input type="button" value="?" style="margin-top: 5px;" disabled="disabled" id="Getpolicypopupt" onclick="Newpolicypopup()" />
                                </td>
                                @*<td style="width:5%">
                                    <span>&nbsp;</span><br />
                                    <input type="button" value="?" style="margin-top: 5px;" disabled="disabled" id="Getpolicypopupt" onclick="Newpolicypopup()" />
                                    </td>*@
                                <td style="width:15%">
                                    <span>Amount</span><br />
                                    @Html.TextBoxFor(model => model.Amount, new { disable = true, @class = "textboxStyle required", @id = "txtAmountt", @onkeypress = "return isAmount(event);", @maxlength = "15" })
                                </td>


                            </tr>
                            <tr>
                                <td>
                                    <span>Claim Period From</span><br />
                                    @Html.TextBoxFor(model => model.ClaimPeriodFrom, new { disable = true, @class = "textboxStyle required", @id = "txtPeriodFromdate", @maxlength = "10", @placeholder = "dd-mm-yyyy" })
                                </td>
                                <td>
                                    <span>Claim Period To</span><br />
                                    @Html.TextBoxFor(model => model.ClaimPeriodTo, new { disable = true, @class = "textboxStyle required", @id = "txtPeriodTodata", @maxlength = "10", @placeholder = "dd-mm-yyyy" })
                                </td>

                                <td>
                                    <span>Place From</span><br />
                                    @Html.DropDownListFor(model => model.PlaceFrom, tsh.Citydata, "--Select--", new { @class = "textboxStyle required", @id = "ddlPlaceFromt" })
                                </td>
                                <td>
                                    <span>Place To</span><br />
                                    @Html.DropDownListFor(model => model.PlaceTo, tsh.Citydata, "--Select--", new { @class = "textboxStyle required", @id = "ddlPlaceTot" })
                                </td>
                            </tr>
                            @*<tr id="nontravelmode" style="display:none">
                                <td>
                                    <span>Travel Mode</span><br />
                                    @Html.DropDownListFor(model => model.TravelModeId, tsh.TravelModedata, new { @class = "textboxStyle required", @id = "ddlTravelModet" })
                                </td>
                                <td>
                                    <span>Travel Class</span><br />
                                    @Html.DropDownListFor(model => model.TravelClassId, Enumerable.Empty<SelectListItem>(), "--Select--", new { @class = "textboxStyle required", @id = "ddlTravelClasst" })
                                </td>
                                <td>
                                    <span>Rate</span><br />
                                    @Html.TextBoxFor(model => model.Rate, new { disable = true, @class = "textboxStyle", @id = "txtRatet", @maxlength = "8", @onkeypress = "return isAmount(event);", @disabled = "disabled" })
                                </td>
                                <td>
                                    <span>Distance</span><br />
                                    @Html.TextBoxFor(model => model.Distance, new { disable = true, @class = "textboxStyle", @id = "txtDistancet", @maxlength = "8", @onkeypress = "return isNumber(event);", @disabled = "disabled" })
                                </td>
                            </tr>*@
                            <tr>
                                <td style="width: 15%;">
                                    <span>Business Segment(BU)</span><br />
                                    @Html.DropDownListFor(model => model.FC, tsh.Exp_FCC, new { @class = "textboxStyle ", @id = "txtFCt", @disabled = "disabled" })
                                </td>
                                <td style="padding-right: 2%;">
                                    <span>Cost Center(CC)</span><br />
                                    @Html.DropDownListFor(model => model.CC, tsh.Exp_CCC, new { @class = "textboxStyle ", @id = "txtCCt" })
                                </td>
                                <td>
                                    <span>Product Code</span><br />
                                    @Html.TextBoxFor(model => model.ProductCode, new { disable = true, @class = "textboxStyle", @id = "txtProductCodet", @maxlength = "16" })
                                    @Html.TextBoxFor(model => model.Exp_FCCC, new { disable = true, @class = "textboxStyle disp", @id = "txtFCCC", @maxlength = "58", @disabled = "disabled" })
                                </td>
                                <td>
                                    <span>Location Code(OUCode)</span><br />
                                    @Html.TextBoxFor(model => model.OUCode, new { disable = true, @class = "textboxStyle withd", @id = "txtOUCodet", @maxlength = "8" })
                                </td>
                            </tr>
                            <tr>

                                <td style="width:15%">
                                    <span>Service Month</span><br />
                                    @Html.TextBoxFor(model => model.ClaimMonth, new { disable = true, @class = "textboxStyle", @id = "txtClaimMontht", @maxlength = "10" })
                                </td>
                                <td style="width: 15%;">
                                    <span>HSN Code</span><br />
                                    @Html.DropDownListFor(model => model.HsnId, Enumerable.Empty<SelectListItem>(), "--Select--", new { @class = "wht textboxStyle required", @id = "txtHsnIdd" })
                                </td>
                                <td>
                                    <span> Hsn Description</span><br />
                                    @Html.TextAreaFor(model => model.TravelHsnDesc, new { disable = true, @class = "textboxStyle", @id = "txthsndescc", @maxlength = "250", @disabled = "disabled" })
                                </td>
                                @*<td>
                                    <span>Description</span><br />
                                    @Html.TextAreaFor(model => model.travelDescription, new { disable = true, @class = "textboxStyle txtarea", @id = "txttravelDescription", @maxlength = "250" })
                                </td>*@
                            </tr> 
                            <tr>
                                <td colspan="2">
                                    <span>Description</span><br />
                                    @Html.TextAreaFor(model => model.travelDescription, new { disable = true, @class = "textboxStyle txtarea", @id = "txttravelDescription", @maxlength = "350" })
                                </td>
                            </tr>



                            @*<tr>
                                @*Ramya Added
                                <td style="width:33%; padding:3px;" colspan="6">
                                <span> RCM Flag</span>
                                @Html.RadioButtonFor(model => model.RCMFlag, "Y", new { @id = "rdorcmChargedYes", @name = "rdorcmChargedFlag", @disabled = "disabled" })<span>Yes</span>
                                @Html.RadioButtonFor(model => model.RCMFlag, "N", new { @id = "rdorcmChargedNo", @checked = "checked", @name = "rdorcmChargedFlag", @disabled = "disabled" })<span>No</span>
                                </td>
                                </tr>*@

                        </table>
                         
                    </td>
                    <td align="left" style="width:25%; background-color: #E3E3E3; border-radius: 10px; padding: 2px 6px 2px 6px;padding-top:3%">

                        <fieldset>
                            <legend><center> <span style="font-weight:bold; font-size:14px; padding:3px;">RAISER DETAILS</span></center></legend>
                            <table class="myTableStyleTabNew" style="border-top:solid 1px black; width:100%">
                                <tr>
                                    <td>
                                        <span>Raiser Mode</span>
                                    </td>
                                    <td style="width:1%; padding-right:3px; padding-left:3px;">:</td>
                                    <td>
                                        @Html.DropDownListFor(n => n.raisermodeId, sh.Raiser_Modedata, new { @class = "textboxStyle required diapy", @id = "raisermodeNamet", @disabled = "disabled" })
                                        <label id="txtmodest"></label>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span>Raiser Code</span>
                                    </td>
                                    <td style="width:1%; padding-right:3px; padding-left:3px;">:</td>
                                    <td>
                                        <label id="txtraisercodet">@sh.Raiser_Code</label>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span>Raiser Name</span>
                                    </td>
                                    <td style="width:1%; padding-right:3px; padding-left:3px;">:</td>
                                    <td>
                                        <label id="txtraisernamet">@sh.Raiser_Name</label>
                                        <input type="hidden" id="payBeneficiaryname" value="@sh.Raiser_Name" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <span>Grade</span>
                                    </td>
                                    <td style="width:1%; padding-right:3px; padding-left:3px;">:</td>
                                    <td>
                                        <label id="txtgradet">@sh.Grade</label>
                                    </td>
                                </tr>
                            </table>
                        </fieldset>

                    </td>
                </tr>
                <tr>
                    <td style="padding-top: 10px;" colspan="6" align="center">
                        <center>
                            <input type="hidden" id="istravelss" />
                            <button type="button" title="Save" name="Save" disabled="disabled" id="btnsavexpp" class="btn btn-primary" onclick="SaveTravelmode()"><span style="color:white;" class="glyphicon glyphicon-floppy-disk"></span> Save</button>
                            <button type="button" id="btncanexp" title="Cancel" name="Cancel" class="btn btn-warning" onclick="Clear()"><span style="color:white;" class="glyphicon glyphicon-remove-sign"></span>Clear</button>
                        </center>
                        <label id="lblIFSCCode" style="font-weight:normal;color:red"></label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align:center;font-size:20px;color:red;">
                        @*<label id="lblIFSCCode" style="font-weight:normal">@ViewBag.IFSCCodemsg</label>*@
                    </td>
                </tr>
            </table>
            @*<div id="wgTravelmodett">
                @Html.Partial("TravelModeDetail")
                 </div>*@
        </div>
    }
</div>


 

<link href="@Url.Content("~/Content/RMchosen/chosen.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/RMScript/chosen.jquery.js")" type="text/javascript"></script>
<script type="text/javascript">
    var UrlHelper = "@Url.Action("CheckrcmExists", "TravelClaimNew")"
</script>
<script> 
 
    $(document).ready(function () { 
        var selmode = $("#raisermodeNamet option:selected").text();
        if (selmode.trim() != "") {
            $("#txtmodest").text(selmode);
        }
        else {
            $("#txtmodest").text('Self');
        }


        $("#txtAmountt").keyup(function (event) {
            if (event.which >= 37 && event.which <= 40) {
                event.preventDefault();
            }

            var currentval = $("#txtAmountt").val();
            var testDecimal = testDecimals(currentval);
            if (testDecimal.length > 1) {
                currentval = currentval.slice(0, -1);
            }
            $("#txtAmountt").val(replaceCommas(currentval));

        });

        $('#txtFCt').change(function () {
            var txtFC = $(this).val();
            var hdraiserfcc = $("#hdraiserfcc").val();
            if (txtFC != hdraiserfcc) {
                jAlert("To take additional approval", "Message");
                return false;
            }
        });
   
        $('#txtCCt').change(function () {
            var txtCC = $(this).val();
            var hdraiserccc = $("#hdraiserccc").val();
            if (txtCC != hdraiserccc) {
                jAlert("To take additional approval", "Message");
                return false;
            }
        });
    
        $("#txtOUCodet").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "../EmployeeClaimNew/AutoCompleteoucode",
                    type: "POST",
                    dataType: "json",
                    data: { term: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.raiserccName, value: item.raiserccName };
                        }))

                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });
   
        $("#txtProductCodet").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "../EmployeeClaimNew/AutoCompleteproductcode",
                    type: "POST",
                    dataType: "json",
                    data: { term: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.raiserccName, value: item.raiserccName };
                        }))

                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });
  
        $("#nontravelmode").hide();
        $("#txtPeriodFromdate").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd-mm-yy',
            maxDate: '-id',
            numberOfMonths: 1,
            onSelect: function (selected) {
                $("#txtPeriodFromdate").addClass('valid');
                $("#txtPeriodTodata").datepicker("option", "minDate", selected);
                cheval();
            }
        });
        $("#txtPeriodTodata").datepicker({
            changeMonth: true,
            changeYear: true,
            maxDate: '-id',
            dateFormat: 'dd-mm-yy',
            numberOfMonths: 1,
            onSelect: function (selected) {
                $("#txtPeriodTodata").addClass('valid');
                $("#txtPeriodFromdate").datepicker("option", "maxDate", selected);
                var txtContractFrom = $("#txtPeriodTodata").val();
                getmonth(txtContractFrom);
                cheval();
            }
        });
 
            var HsnArray;
            $("#ddlNatureofExpensest").append("<option selected='selected' value='0' >--Select--</option>");
            $("#ddlTravelModet").append("<option selected='selected' value='0' >--Select--</option>");
            $("#txtHsnIdd").append("<option value='0' >--Select--</option>");

            $('#ddlNatureofExpensest').change(function () {
                var brandID = $(this).val();
                $("#txthsndescc").val("");
                $("#txtHsnIdd").empty();
                var Student =
               {
                   "NatureofExpensesId": brandID
               };
                $.ajax({
                    url: '../TravelClaimNew/GetExpenseCategory/',
                    data: JSON.stringify(Student),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        cheval();
                        $("#ddlExpenseCategoryt").empty();
                        $("#ddlSubCategoryt").empty();
                        if (data.length > 0) {
                            $("#ddlSubCategoryt").append("<option value='0' >--Select--</option>");
                            $("#ddlExpenseCategoryt").append("<option value='0' >--Select--</option>");
                            for (var i = 0; i < data.length; i++) {
                                var stylesSelect = $('#ddlExpenseCategoryt');
                                stylesSelect.attr('disabled', false);
                                $("#ddlExpenseCategoryt").append("<option value=" + data[i].ExpenseCategoryId + " >" + data[i].ExpenseCategoryName + "</option>");
                            }

                            var Studentnew =
                                {
                                    "NatureofExpensesId": brandID
                                };
                            $.ajax({
                                url: '../TravelClaimNew/GetExpenseCategoryflag/',
                                data: JSON.stringify(Studentnew),
                                type: 'POST',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {
                                    if (data == "T") {
                                        $("#istravelss").val(data);
                                        $("#nontravelmode").show();
                                        cheval();
                                    }
                                    else {
                                        $("#istravelss").val(data);
                                        $("#nontravelmode").hide();
                                        cheval();
                                    }
                                },
                                error: function (result) {
                                    jAlert("Error.", "Error");
                                    return false;
                                }
                            });

                        }
                        if (data.length == 0) {
                            $("#ddlSubCategoryt").append("<option value='0' >--Select--</option>");
                            $("#ddlExpenseCategoryt").append("<option value='0' >--Select--</option>");
                            var stylesSelect = $('#ddlExpenseCategoryt');
                            stylesSelect.attr('disabled', true);
                            var stylesSelect = $('#ddlSubCategoryt');
                            stylesSelect.attr('disabled', true);
                            cheval();
                        }
                    },
                    error: function (result) {
                        jAlert("Error.", "Error");
                        return false;
                    }
                });
            });

            $('#ddlExpenseCategoryt').change(function () {
                $("#txthsndescc").val("");
                $("#txtHsnIdd").empty();
                var brandID = $(this).val();
                if (brandID != 0) {
                    var Student =
                   {
                       "ExpenseCategoryId": brandID
                   };
                    $.ajax({
                        url: '../TravelClaimNew/GetSubCategory/',
                        data: JSON.stringify(Student),
                        type: 'POST',
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            cheval();
                            if (data.Data1 != "" || data.Data1 != null) {
                                var data1 = JSON.parse(data.Data1);
                                $("#ddlSubCategoryt").empty();
                                if (data1.length > 0) {
                                    $("#ddlSubCategoryt").append("<option value='0' >--Select--</option>");
                                    for (var i = 0; i < data1.length; i++) {
                                        var stylesSelect = $('#ddlSubCategoryt');
                                        stylesSelect.attr('disabled', false);
                                        $("#ddlSubCategoryt").append("<option value=" + data1[i].expsubcat_gid + " >" + data1[i].expsubcat_name + "</option>");
                                    }
                                }
                                if (data.length == 0) {
                                    $("#ddlSubCategoryt").append("<option value='0' >--Select--</option>");
                                    var stylesSelect = $('#ddlSubCategoryt');
                                    stylesSelect.attr('disabled', true);
                                }
                            }

                        },
                        error: function (result) {
                            jAlert("Error.", "Error");
                            return false;
                        }
                    });
                }
            });
            $('#txtHsnIdd').change(function () {
                if (HsnArray.length > 0) {
                    var hsnid = $("#txtHsnIdd").val();
                    $("#rdorcmChargedNo").prop("checked", true);
                    if (parseInt(hsnid) != 0) {
                        for (var i = 0; i < HsnArray.length; i++) {
                            if (parseInt(hsnid) == parseInt(HsnArray[i].hsnid)) {
                                $("#txthsndescc").val(HsnArray[i].Hsndesc);
                                //Ramya Aug
                                var GSTCharged = $("#hdfEditViewGstChargedFlag").val();
                                if (GSTCharged == "N") {
                                    LoadRCMonHSNChange(hsnid);
                                }
                                break;
                            }
                        }
                    }
                    else {
                        $("#txthsndescc").val("");
                    }
                }
            });

            $('#ddlPlaceFromt').change(function () {
                concatfilds();
            });
            $('#ddlPlaceTot').change(function () {
                concatfilds();
            });
            $('#txtPeriodFromdate').change(function () {
                concatfilds();
            });
            $('#txtPeriodTodata').change(function () {
                concatfilds();
            });
            function concatfilds() {
                var SubCategoryt = $("#ddlSubCategoryt option:selected").text();
                if (SubCategoryt != "--Select--") {
                    SubCategoryt = SubCategoryt.split('-');

                    var Beneficiary = $("#txtraisernamet").text();

                    var placefroms = $("#ddlPlaceFromt option:selected").text();
                    var placetos = $("#ddlPlaceTot option:selected").text();

                    var ClaimPeriodFroms = $("#txtPeriodFromdate").val();
                    var ClaimPeriodTos = $("#txtPeriodTodata").val();

                    if (placefroms == "--Select--" && placetos == "--Select--" && ClaimPeriodFroms == "" && ClaimPeriodTos == "") {
                        $("#txttravelDescription").val(SubCategoryt[0] + '-' + Beneficiary);
                    }
                    else if (placefroms == "--Select--" && placetos == "--Select--" && ClaimPeriodFroms != "" && ClaimPeriodTos == "") {
                        $("#txttravelDescription").val(SubCategoryt[0] + '-' + '-' + ClaimPeriodFroms + Beneficiary);
                    }
                    else if (placefroms == "--Select--" && placetos == "--Select--" && ClaimPeriodFroms != "" && ClaimPeriodTos != "") {
                        $("#txttravelDescription").val(SubCategoryt[0] + '-' + '-' + ClaimPeriodFroms + '-' + ClaimPeriodTos + '-' + Beneficiary);
                    }
                    else if (placefroms != "--Select--" && placetos == "--Select--" && ClaimPeriodFroms == "" && ClaimPeriodTos == "") {
                        $("#txttravelDescription").val(SubCategoryt[0] + '-' + placefroms + '-' + Beneficiary);
                    }
                    else if (placefroms != "--Select--" && placetos != "--Select--" && ClaimPeriodFroms == "" && ClaimPeriodTos == "") {
                        $("#txttravelDescription").val(SubCategoryt[0] + '-' + placefroms + '-' + placetos + '-' + Beneficiary);
                    }
                    else if (placefroms != "--Select--" && placetos != "--Select--" && ClaimPeriodFroms != "" && ClaimPeriodTos == "") {
                        $("#txttravelDescription").val(SubCategoryt[0] + '-' + placefroms + '-' + placetos + '-' + ClaimPeriodFroms + '-' + Beneficiary);
                    }
                    else if (placefroms != "--Select--" && placetos != "--Select--" && ClaimPeriodFroms != "" && ClaimPeriodTos != "") {
                        $("#txttravelDescription").val(SubCategoryt[0] + '-' + placefroms + '-' + placetos + '-' + ClaimPeriodFroms + '-' + ClaimPeriodTos + '-' + Beneficiary);
                    }
                }
                else {
                    $("#txttravelDescription").val('');
                }
            }

            $('#ddlSubCategoryt').change(function () {
                var brandID = $(this).val();
                if (brandID != "0") {
                    concatfilds();

                    var Student =
                   {
                       "ExpenseCategoryId": brandID
                   };
                    $.ajax({
                        url: '../TravelClaimNew/GetSubCategorypolicy/',
                        data: JSON.stringify(Student),
                        type: 'POST',
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            cheval();
                            if (data.policy != "") {
                                var stylesSelect = $('#Getpolicypopupt');
                                stylesSelect.attr('disabled', false);
                            }
                            $("#txtHsnIdd").empty();

                            if (data.Data2 != "" && data.Data2 != null) {
                                HsnArray = JSON.parse(data.Data2);
                                var data2 = JSON.parse(data.Data2);
                                $("#txtHsnIdd").empty();
                                if (HsnArray.length > 0) {
                                    $("#txtHsnIdd").append("<option value='0' >--Select--</option>");
                                    for (var i = 0; i < HsnArray.length; i++) {
                                        var stylesSelect1 = $('#txtHsnIdd');
                                        stylesSelect1.attr('disabled', false);
                                        $("#txtHsnIdd").append("<option value=" + HsnArray[i].hsnid + " >" + HsnArray[i].hsncode + "</option>");
                                    }
                                }
                                else {

                                    $("#txtHsnIdd").empty();
                                    $("#txtHsnIdd").append("<option value='0' >--Select--</option>");
                                    var stylesSelect1 = $('#txtHsnIdd');
                                    stylesSelect1.attr('disabled', true);
                                }
                            }


                            else {
                                var stylesSelect = $('#Getpolicypopupt');
                                stylesSelect.attr('disabled', true);
                                $("#txtHsnIdd").empty();
                                $("#txtHsnIdd").append("<option value='0' >--Select--</option>");
                                var stylesSelect1 = $('#txtHsnIdd');
                                stylesSelect1.attr('disabled', true);
                                $("#txtHsnIdd").removeClass('valid');
                                $("#txtHsnIdd").addClass('required');
                                cheval();

                            }
                        },
                        error: function (result) {

                            $("#txtHsnIdd").empty();
                            $("#txtHsnIdd").append("<option value='0' >--Select--</option>");
                            var stylesSelect1 = $('#txtHsnIdd');
                            stylesSelect1.attr('disabled', true);

                            jAlert("Error.", "Error");
                            return false;
                        }
                    });
                }
                else {
                    var stylesSelect = $('#Getpolicypopupt');
                    stylesSelect.attr('disabled', true);
                    $("#txtHsnIdd").empty();
                    $("#txtHsnIdd").append("<option value='0' >--Select--</option>");
                    var stylesSelect1 = $('#txtHsnIdd');
                    stylesSelect1.attr('disabled', true);
                }
            });

            $('#ddlTravelModet').change(function () {
                var brandID = $(this).val();
                var Student =
               {
                   "TravelModeId": brandID
               };
                $.ajax({
                    url: '../TravelClaimNew/GetTravelClassdata/',
                    data: JSON.stringify(Student),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        cheval();
                        $("#ddlTravelClasst").empty();
                        if (data.length > 0) {
                            $("#ddlTravelClasst").append("<option value='0' >--Select--</option>");
                            for (var i = 0; i < data.length; i++) {
                                var stylesSelect = $('#ddlTravelClasst');
                                stylesSelect.attr('disabled', false);
                                $("#ddlTravelClasst").append("<option value=" + data[i].TravelClassId + " >" + data[i].TravelClassName + "</option>");
                            }

                            $("#txtDistancet").removeClass('required');
                            $("#txtRatet").removeClass('required');
                            $("#txtDistancet").removeClass('valid');
                            $("#txtRatet").removeClass('valid');
                            $('#txtAmountt').attr('disabled', false);
                            //$('#txtAmountt').attr('disabled', false);
                            //$("#txtAmountt").val('');
                            //$("#txtAmountt").addClass('required');

                            var Studentnew =
                              {
                                  "TravelModeId": brandID
                              };
                            $.ajax({
                                url: '../TravelClaimNew/GetTravelClassdataflag/',
                                data: JSON.stringify(Studentnew),
                                type: 'POST',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {
                                    if (data == "Y") {
                                        $('#txtDistancet').attr('disabled', false);
                                        $("#txtDistancet").val('');
                                        $('#txtRatet').attr('disabled', false);
                                        $("#txtRatet").val('');

                                        $("#txtDistancet").removeClass('valid');
                                        $("#txtDistancet").addClass('required');
                                        $("#txtRatet").removeClass('valid');
                                        $("#txtRatet").addClass('required');
                                        cheval();
                                    }
                                    else {
                                        $('#txtDistancet').attr('disabled', true);
                                        $("#txtDistancet").val('');
                                        $('#txtRatet').attr('disabled', true);
                                        $("#txtRatet").val('');

                                        cheval();
                                    }
                                },
                                error: function (result) {
                                    jAlert("Error.", "Error");
                                    return false;
                                }
                            });
                        }
                        if (data.length == 0) {
                            var stylesSelect = $('#ddlTravelClasst');
                            stylesSelect.attr('disabled', true);
                            $("#ddlTravelClasst").append("<option value='0' >--Select--</option>");
                        }
                    },
                    error: function (result) {
                        jAlert("Error.", "Error");
                        return false;
                    }
                });
            });

            $('#txtCCt').change(function () {
                var ccs = $("#txtCCt option:selected").text();
                var fcs = $("#txtFCt option:selected").text();
                concode(fcs, ccs);
            });
            $('#txtFCt').change(function () {
                var ccs = $("#txtCCt option:selected").text();
                var fcs = $("#txtFCt option:selected").text();
                concode(fcs, ccs);
            });


            $("#txtDistancet").keyup(function () {
                var txtContractFrom = $("#txtDistancet").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtDistancet").removeClass('required');
                    $("#txtDistancet").addClass('valid'); cheval();
                }
                else {
                    $("#txtDistancet").removeClass('valid');
                    $("#txtDistancet").addClass('required'); cheval();
                }
            });
            $("#txtDistancet").change(function () {
                var txtContractFrom = $("#txtDistancet").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtDistancet").removeClass('required');
                    $("#txtDistancet").addClass('valid'); cheval();
                }
                else {
                    $("#txtDistancet").removeClass('valid');
                    $("#txtDistancet").addClass('required'); cheval();
                }
            });

            $("#txtRatet").keyup(function () {
                var txtContractFrom = $("#txtRatet").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtRatet").removeClass('required');
                    $("#txtRatet").addClass('valid'); cheval();
                }
                else {
                    $("#txtRatet").removeClass('valid');
                    $("#txtRatet").addClass('required'); cheval();
                }
            });
            $("#txtRatet").change(function () {
                var txtContractFrom = $("#txtRatet").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtRatet").removeClass('required');
                    $("#txtRatet").addClass('valid'); cheval();
                }
                else {
                    $("#txtRatet").removeClass('valid');
                    $("#txtRatet").addClass('required'); cheval();
                }
            });

            $("#ddlPlaceTot").keyup(function () {
                var txtContractFrom = $("#ddlPlaceTot option:selected").text();
                if (txtContractFrom.trim() != "--Select--") {
                    $("#ddlPlaceTot").removeClass('required');
                    $("#ddlPlaceTot").addClass('valid'); cheval();
                }
                else {
                    $("#ddlPlaceTot").removeClass('valid');
                    $("#ddlPlaceTot").addClass('required'); cheval();
                }
            });
            $("#ddlPlaceTot").change(function () {
                var txtContractFrom = $("#ddlPlaceTot option:selected").text();
                if (txtContractFrom.trim() != "--Select--") {
                    $("#ddlPlaceTot").removeClass('required');
                    $("#ddlPlaceTot").addClass('valid'); cheval();
                }
                else {
                    $("#ddlPlaceTot").removeClass('valid');
                    $("#ddlPlaceTot").addClass('required'); cheval();
                }
            });

            $("#ddlPlaceFromt").keyup(function () {
                var txtContractFrom = $("#ddlPlaceFromt option:selected").text();
                if (txtContractFrom.trim() != "--Select--") {
                    $("#ddlPlaceFromt").removeClass('required');
                    $("#ddlPlaceFromt").addClass('valid'); cheval();
                }
                else {
                    $("#ddlPlaceFromt").removeClass('valid');
                    $("#ddlPlaceFromt").addClass('required'); cheval();
                }
            });
            $("#ddlPlaceFromt").change(function () {
                var txtContractFrom = $("#ddlPlaceFromt option:selected").text();
                if (txtContractFrom.trim() != "--Select--") {
                    $("#ddlPlaceFromt").removeClass('required');
                    $("#ddlPlaceFromt").addClass('valid'); cheval();
                }
                else {
                    $("#ddlPlaceFromt").removeClass('valid');
                    $("#ddlPlaceFromt").addClass('required'); cheval();
                }
            });


            $("#txtDistancet").keyup(function () {
                var txtContractFrom = $("#txtDistancet").val();
                var txtRatet = $("#txtRatet").val();
                if (txtContractFrom.trim() != "" || txtRatet.trim() != "") {
                    //$("#txtDistancet").removeClass('required');
                    //$("#txtDistancet").addClass('valid');
                    cheval();
                    $("#txtAmountt").removeClass('required');
                    $("#txtAmountt").removeClass('valid');
                    $('#txtAmountt').attr('disabled', true);

                    //var tol = $('#txtDistancet').val() * ($('#txtRatet').val());
                    //$('#txtAmountt').val(tol.toFixed(2)); cheval()
                    var currentvalnew = $('#txtDistancet').val() * ($('#txtRatet').val());
                    var currentval = currentvalnew.toFixed(2);
                    var testDecimal = testDecimals(currentval);
                    if (testDecimal.length > 1) {
                        currentval = currentval.slice(0, -1);
                    }
                    var tolnew = replaceCommas(currentval);
                    $('#txtAmountt').val(tolnew);
                    cheval();

                }
                else {
                    //$("#txtDistancet").removeClass('valid');
                    //$("#txtDistancet").addClass('required');
                    cheval();
                    $("#txtAmountt").addClass('required');
                    $("#txtAmountt").removeClass('valid');
                    $('#txtAmountt').attr('disabled', false);
                    $("#txtAmountt").val(''); cheval()
                }
            });
            $("#txtDistancet").change(function () {
                var txtContractFrom = $("#txtDistancet").val();
                var txtRatet = $("#txtRatet").val();
                if (txtContractFrom.trim() != "" || txtRatet.trim() != "") {
                    //$("#txtDistancet").removeClass('required');
                    //$("#txtDistancet").addClass('valid');
                    cheval();
                    $("#txtAmountt").removeClass('required');
                    $("#txtAmountt").removeClass('valid');
                    $('#txtAmountt').attr('disabled', true);

                    //var tol = $('#txtDistancet').val() * ($('#txtRatet').val());
                    //$('#txtAmountt').val(tol.toFixed(2)); cheval()
                    var currentvalnew = $('#txtDistancet').val() * ($('#txtRatet').val());
                    var currentval = currentvalnew.toFixed(2);
                    var testDecimal = testDecimals(currentval);
                    if (testDecimal.length > 1) {
                        currentval = currentval.slice(0, -1);
                    }
                    var tolnew = replaceCommas(currentval);
                    $('#txtAmountt').val(tolnew);
                    cheval();
                }
                else {
                    //$("#txtDistancet").removeClass('valid');
                    //$("#txtDistancet").addClass('required');
                    cheval();
                    $("#txtAmountt").addClass('required');
                    $("#txtAmountt").removeClass('valid');
                    $('#txtAmountt').attr('disabled', false);
                    $("#txtAmountt").val(''); cheval()
                }
            });

            $("#txtRatet").keyup(function () {
                var txtContractFrom = $("#txtRatet").val();
                var txtDistancet = $("#txtDistancet").val();
                if (txtContractFrom.trim() != "" || txtDistancet.trim() != "") {
                    //$("#txtRatet").removeClass('required');
                    //$("#txtRatet").addClass('valid');
                    cheval();
                    $("#txtAmountt").removeClass('required');
                    $("#txtAmountt").removeClass('valid');
                    $('#txtAmountt').attr('disabled', true);

                    //var tol = $('#txtDistancet').val() * ($('#txtRatet').val());
                    //$('#txtAmountt').val(tol.toFixed(2)); cheval()
                    var currentvalnew = $('#txtDistancet').val() * ($('#txtRatet').val());
                    var currentval = currentvalnew.toFixed(2);
                    var testDecimal = testDecimals(currentval);
                    if (testDecimal.length > 1) {
                        currentval = currentval.slice(0, -1);
                    }
                    var tolnew = replaceCommas(currentval);
                    $('#txtAmountt').val(tolnew);
                    cheval();
                }
                else {
                    //$("#txtRatet").removeClass('valid');
                    //$("#txtRatet").addClass('required');
                    cheval();
                    $("#txtAmountt").addClass('required');
                    $("#txtAmountt").removeClass('valid');
                    $('#txtAmountt').attr('disabled', false);
                    $("#txtAmountt").val(''); cheval()
                }
            });
            $("#txtRatet").change(function () {

                var txtContractFrom = $("#txtRatet").val();
                var txtDistancet = $("#txtDistancet").val();
                if (txtContractFrom.trim() != "" || txtDistancet.trim() != "") {
                    cheval();
                    $("#txtAmountt").removeClass('required');
                    $("#txtAmountt").removeClass('valid');
                    $('#txtAmountt').attr('disabled', true);

                    //    var tol = $('#txtDistancet').val() * ($('#txtRatet').val());
                    //    $('#txtAmountt').val(tol.toFixed(2)); cheval()
                    var currentvalnew = $('#txtDistancet').val() * ($('#txtRatet').val());
                    var currentval = currentvalnew.toFixed(2);
                    var testDecimal = testDecimals(currentval);
                    if (testDecimal.length > 1) {
                        currentval = currentval.slice(0, -1);
                    }
                    var tolnew = replaceCommas(currentval);
                    $('#txtAmountt').val(tolnew);
                    cheval();
                }
                else {
                    //$("#txtRatet").removeClass('valid');
                    //$("#txtRatet").addClass('required');
                    cheval();
                    $("#txtAmountt").addClass('required');
                    $("#txtAmountt").removeClass('valid');
                    $('#txtAmountt').attr('disabled', false);
                    $("#txtAmountt").val(''); cheval()
                }
            });

            $("#ddlTravelClasst").keyup(function () {
                var txtContractFrom = $("#ddlTravelClasst").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlTravelClasst").removeClass('required');
                    $("#ddlTravelClasst").addClass('valid'); cheval();
                }
                else {
                    $("#ddlTravelClasst").removeClass('valid');
                    $("#ddlTravelClasst").addClass('required'); cheval();
                }
            });
            $("#ddlTravelClasst").change(function () {
                var txtContractFrom = $("#ddlTravelClasst").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlTravelClasst").removeClass('required');
                    $("#ddlTravelClasst").addClass('valid'); cheval();
                }
                else {
                    $("#ddlTravelClasst").removeClass('valid');
                    $("#ddlTravelClasst").addClass('required'); cheval();
                }
            });

            $("#ddlTravelModet").keyup(function () {
                var txtContractFrom = $("#ddlTravelModet").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlTravelModet").removeClass('required');
                    $("#ddlTravelModet").addClass('valid'); cheval();
                }
                else {
                    $("#ddlTravelModet").removeClass('valid');
                    $("#ddlTravelModet").addClass('required'); cheval();
                }
            });
            $("#ddlTravelModet").change(function () {
                var txtContractFrom = $("#ddlTravelModet").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlTravelModet").removeClass('required');
                    $("#ddlTravelModet").addClass('valid'); cheval();
                }
                else {
                    $("#ddlTravelModet").removeClass('valid');
                    $("#ddlTravelModet").addClass('required'); cheval();
                }
            });

            $("#ddlNatureofExpensest").keyup(function () {
                var txtContractFrom = $("#ddlNatureofExpensest").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlNatureofExpensest").removeClass('required');
                    $("#ddlNatureofExpensest").addClass('valid'); cheval();
                }
                else {
                    $("#ddlNatureofExpensest").removeClass('valid');
                    $("#ddlNatureofExpensest").addClass('required'); cheval();
                }
            });
            $("#ddlNatureofExpensest").change(function () {
                var txtContractFrom = $("#ddlNatureofExpensest").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlNatureofExpensest").removeClass('required');
                    $("#ddlNatureofExpensest").addClass('valid'); cheval();
                }
                else {
                    $("#ddlNatureofExpensest").removeClass('valid');
                    $("#ddlNatureofExpensest").addClass('required'); cheval();
                }
            });

            $("#ddlExpenseCategoryt").keyup(function () {
                var txtContractFrom = $("#ddlExpenseCategoryt").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlExpenseCategoryt").removeClass('required');
                    $("#ddlExpenseCategoryt").addClass('valid'); cheval();
                }
                else {
                    $("#ddlExpenseCategoryt").removeClass('valid');
                    $("#ddlExpenseCategoryt").addClass('required'); cheval();
                }
            });
            $("#ddlExpenseCategoryt").change(function () {
                var txtContractFrom = $("#ddlExpenseCategoryt").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlExpenseCategoryt").removeClass('required');
                    $("#ddlExpenseCategoryt").addClass('valid'); cheval();
                }
                else {
                    $("#ddlExpenseCategoryt").removeClass('valid');
                    $("#ddlExpenseCategoryt").addClass('required'); cheval();
                }
            });

            $("#ddlSubCategoryt").keyup(function () {
                var txtContractFrom = $("#ddlSubCategoryt").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlSubCategoryt").removeClass('required');
                    $("#ddlSubCategoryt").addClass('valid'); cheval();
                }
                else {
                    $("#ddlSubCategoryt").removeClass('valid');
                    $("#ddlSubCategoryt").addClass('required'); cheval();
                }
            });
            $("#ddlSubCategoryt").change(function () {
                var txtContractFrom = $("#ddlSubCategoryt").val();
                if (txtContractFrom.trim() != "0") {
                    $("#ddlSubCategoryt").removeClass('required');
                    $("#ddlSubCategoryt").addClass('valid'); cheval();
                }
                else {
                    $("#ddlSubCategoryt").removeClass('valid');
                    $("#ddlSubCategoryt").addClass('required'); cheval();
                }
            });

            $("#txtClaimMontht").keyup(function () {
                var txtContractFrom = $("#txtClaimMontht").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtClaimMontht").removeClass('required');
                    $("#txtClaimMontht").addClass('valid'); cheval();
                }
                else {
                    $("#txtClaimMontht").removeClass('valid');
                    $("#txtClaimMontht").addClass('required'); cheval();
                }
            });
            $("#txtClaimMontht").change(function () {
                var txtContractFrom = $("#txtClaimMontht").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtClaimMontht").removeClass('required');
                    $("#txtClaimMontht").addClass('valid'); cheval();
                }
                else {
                    $("#txtClaimMontht").removeClass('valid');
                    $("#txtClaimMontht").addClass('required'); cheval();
                }
            });

            $("#txtAmountt").keyup(function () {
                var txtContractFrom = $("#txtAmountt").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtAmountt").removeClass('required');
                    $("#txtAmountt").addClass('valid'); cheval();
                }
                else {
                    $("#txtAmountt").removeClass('valid');
                    $("#txtAmountt").addClass('required'); cheval();
                }
            });
            $("#txtAmountt").change(function () {
                var txtContractFrom = $("#txtAmountt").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtAmountt").removeClass('required');
                    $("#txtAmountt").addClass('valid'); cheval();
                }
                else {
                    $("#txtAmountt").removeClass('valid');
                    $("#txtAmountt").addClass('required'); cheval();
                }
            });

            $("#txtPeriodFromdate").keyup(function () {
                var txtContractFrom = $("#txtPeriodFromdate").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtPeriodFromdate").removeClass('required');
                    $("#txtPeriodFromdate").addClass('valid'); cheval();
                }
                else {
                    $("#txtPeriodFromdate").removeClass('valid');
                    $("#txtPeriodFromdate").addClass('required'); cheval();
                }
            });
            $("#txtPeriodFromdate").change(function () {
                var txtContractFrom = $("#txtPeriodFromdate").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtPeriodFromdate").removeClass('required');
                    $("#txtPeriodFromdate").addClass('valid'); cheval();
                }
                else {
                    $("#txtPeriodFromdate").removeClass('valid');
                    $("#txtPeriodFromdate").addClass('required'); cheval();
                }
            });

            $("#txtPeriodTodata").keyup(function () {
                var txtContractFrom = $("#txtPeriodTodata").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtPeriodTodata").removeClass('required');
                    $("#txtPeriodTodata").addClass('valid');
                    getmonth(txtContractFrom); cheval();
                }
                else {
                    $("#txtPeriodTodata").removeClass('valid');
                    $("#txtPeriodTodata").addClass('required'); cheval();
                }
            });
            $("#txtPeriodTodata").change(function () {
                var txtContractFrom = $("#txtPeriodTodata").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtPeriodTodata").removeClass('required');
                    $("#txtPeriodTodata").addClass('valid');
                    getmonth(txtContractFrom); cheval();
                }
                else {
                    $("#txtPeriodTodata").removeClass('valid');
                    $("#txtPeriodTodata").addClass('required'); cheval();
                }
            });

            $("#txtProductCodet").keyup(function () {
                var txtContractFrom = $("#txtProductCodet").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtProductCodet").removeClass('required');
                    $("#txtProductCodet").addClass('valid');
                    cheval();
                }
                else {
                    $("#txtProductCodet").removeClass('valid');
                    $("#txtProductCodet").addClass('required');
                    cheval();
                }
            });
            $("#txtProductCodet").change(function () {
                var txtContractFrom = $("#txtProductCodet").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtProductCodet").removeClass('required');
                    $("#txtProductCodet").addClass('valid');
                    cheval();
                }
                else {
                    $("#txtProductCodet").removeClass('valid');
                    $("#txtProductCodet").addClass('required');
                    cheval();
                }
            });
            $("#txtOUCodet").keyup(function () {
                var txtContractFrom = $("#txtOUCodet").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtOUCodet").removeClass('required');
                    $("#txtOUCodet").addClass('valid');
                    cheval();
                }
                else {
                    $("#txtOUCodet").removeClass('valid');
                    $("#txtOUCodet").addClass('required');
                    cheval();
                }
            });
            $("#txtOUCodet").change(function () {
                var txtContractFrom = $("#txtOUCodet").val();
                if (txtContractFrom.trim() != "") {
                    $("#txtOUCodet").removeClass('required');
                    $("#txtOUCodet").addClass('valid');
                    cheval();
                }
                else {
                    $("#txtOUCodet").removeClass('valid');
                    $("#txtOUCodet").addClass('required');
                    cheval();
                }
            });

            $("#ddlNatureofExpensest").focus();
            var stylesSelect = $('#txtClaimMontht');
            stylesSelect.attr('disabled', true);

             

    });


    function Newpolicypopup() {
        var SubCategory = $("#ddlSubCategoryt").val();
        if (SubCategory != "0") {
            var url = '@Url.Action("_Emppolicypopup", "TravelClaimNew")?id=' + SubCategory + '&' + new Date().getTime();
            objDialogpolicypopupce.load(url);
            objDialogpolicypopupce.dialog({
                autoOpen: false,
                cache: false,
                modal: true,
                show: 'fade-in',
                close: 'fade-out',
                title: 'Policy Help',
                width: 860,
                height: 400
            });
            objDialogpolicypopupce.dialog("open");
        }
    }
  
    function GotoIndexExpense() {
        objDialogTravelmodenew.dialog("close");
        window.parent.jQuery('#ForPartialViewTravelmodenew').dialog('close');
    }
    function SaveTravelmode() {
        debugger;
       // alert('SaveTravel');
        var Ecfrowtolamtnew = $("#newadding").val();

        var ecfclaimmon = $("#txtclaimmontht").val();

        var ecfamomtssessionnew = $("#ecfamomtssessiontmnew").val();
        var ecfamomtssession = $("#ecfamomtssessiontm").val();
        var InvAmount = 0;
        //    $("#txtInvoiceAmount").val();
        //if (InvAmount == null || InvAmount == "0") {
        //    jAlert("The Invoice Amount is Zero....", "Message");
        //    return false;
        //}
        var NatureofExpenses = $("#ddlNatureofExpensest").val();
        var ExpenseCategory = $("#ddlExpenseCategoryt").val();
        var SubCategory = $("#ddlSubCategoryt").val();
        var PlaceFrom1 = $("#ddlPlaceFromt").val();
        var PlaceFrom = $("#ddlPlaceFromt option:selected").text();
        var PlaceTo1 = $("#ddlPlaceTot").val();
        var PlaceTo = $("#ddlPlaceTot option:selected").text();
        var ClaimPeriodFrom = $("#txtPeriodFromdate").val();
        var ClaimPeriodTo = $("#txtPeriodTodata").val();
        var ClaimMonth = $("#txtClaimMontht").val();
        var TravelMode = $("#ddlTravelModet").val();
        var TravelClass = $("#ddlTravelClasst").val();
        var Rate = $("#txtRatet").val();
        var Distance = $("#txtDistancet").val();
        var FC = $("#txtFCt").val();
        var CC = $("#txtCCt").val();
        var ProductCode = $("#txtProductCodet").val();
        var OUCode = $("#txtOUCodet").val();
        //var Amount = $("#txtAmountt").val();
        var Amount = $("#txtAmountt").val().replace(/,/g, "");
        var travelDescription = $("#txttravelDescription").val();
        var istravelss = $("#istravelss").val();
        var Hsnid = $("#txtHsnIdd").val();
        var invid = $("#hfInvId").val();
        var RCMFlag = "S";

        //if ($("input[id=rdorcmChargedYes]:radio[checked=checked]").attr("value")) {
        //    RCMFlag = "Y";
        //}
        //else {
        //    RCMFlag = "N";
        //}

        if (NatureofExpenses == null || NatureofExpenses == "" || NatureofExpenses == "0") {
            jAlert("Please select the Nature of Expenses.", "Message");
            return false;
        }
        if (ExpenseCategory == null || ExpenseCategory == "0") {
            jAlert("Please select The Expense Category", "Message");
            return false;
        }
        if (SubCategory == null || SubCategory == "0") {
            jAlert("Please select the Sub Category", "Message");
            return false;
        }
        //if ($("input[name=rdogstChargedFlag]:radio[checked=checked]").attr("value") == "Y") {
        if (Hsnid == null || Hsnid == "" || Hsnid == "0") {
            jAlert("Please select the HSN Code.", "Message");
            $("#ddlNatureofExpensest").focus();
            return false;
        }
        //}
        //else {
        //    Hsnid = "0";
        //}
        if (PlaceFrom == null || PlaceFrom == "--Select--") {
            jAlert("Please Select 'PLACE FROM' field", "Message");
            return false;
        }
        if (PlaceTo == null || PlaceTo == "--Select--") {
            jAlert("Please Select 'PLACE TO' field", "Message");
            return false;
        }
        if (ClaimPeriodFrom == null || ClaimPeriodFrom == "") {
            jAlert("Enter 'CLAIM PERIOD FROM' date", "Message");
            return false;
        }
        if (ClaimPeriodTo == null || ClaimPeriodTo == "") {
            jAlert("Please Enter Claim Period To.", "Message");
            return false;
        }
        if (ClaimMonth == null || ClaimMonth == "") {
            jAlert("Please Enter Claim Month.", "Message");
            return false;
        }
        //if (ecfclaimmon != ClaimMonth) {
        //    jAlert("Month mismatch between 'SERVICE MONTH' & 'CLAIM PERIOD TO' fields", "Message");
        //    return false;
        //}
        if (istravelss == "T") {
            if (TravelMode == null || TravelMode == "0") {
                jAlert(" Please select the Travel Mode", "Message");
                return false;
            }
            if (TravelClass == null || TravelClass == "0") {
                jAlert("Please Select the Travel Class", "Message");
                return false;
            }
        }
        else {
            TravelMode = "0";
            TravelClass = "0";
        }

        if (FC == null || FC == "") {
            jAlert("Please Enter FC.", "Message");
            return false;
        }
        if (CC == null || CC == "") {
            jAlert("Please Enter the Cost Center(CC)", "Message");
            return false;
        }
        if (ProductCode == null || ProductCode == "") {
            jAlert("Please Enter the Product Code", "Message");
            return false;
        }
        if (OUCode == null || OUCode == "") {
            jAlert("Please Enter Location (OU Code)", "Message");
            return false;
        }
        //if (Rate == null || Rate == "") {
        //    jAlert("Please Enter Rate.", "Message");
        //    return false;
        //}
        //if (Distance == null || Distance == "") {
        //    jAlert("Please Enter Distance.", "Message");
        //    return false;
        //}
        if (PlaceFrom == PlaceTo) {
            jAlert("PlaceFrom and PlaceTo cann't be the same.", "Message");
            return false;
        }
        if (Amount == null || Amount == "") {
            jAlert("Please enter the Amount", "Message");
            return false;
        }
        if (Amount == "NAN" || Amount == "0.00" || Amount == "0") {
            jAlert("Please Enter Rate or Distance.", "Message");
            return false;
        }
        var val1 = parseFloat(InvAmount);
        var val2 = parseFloat(Amount);
        var sumamts = parseFloat(Ecfrowtolamtnew) + parseFloat(Amount);
        //if (parseFloat(val1) < parseFloat(val2)) {
        //    jAlert("The debit lines Amount must be equal to ECF Amount", "Message");
        //    return false;
        //}
        //if (parseFloat(sumamts) > parseFloat(InvAmount)) {
        //    jAlert("The debit lines Amount must be equal to ECF Amount", "Message");
        //    return false;
        //}
        //else {
            var NewExpensemodel = {
                "NatureofExpensesName": NatureofExpenses,
                "ExpenseCategoryName": ExpenseCategory,
                "SubCategoryName": SubCategory,
                "PlaceFrom": PlaceFrom,
                "PlaceTo": PlaceTo,
                "ClaimPeriodFrom": ClaimPeriodFrom,
                "ClaimPeriodTo": ClaimPeriodTo,
                "ClaimMonth": ClaimMonth,
                "TravelModeName": TravelMode,
                "TravelClassName": TravelClass,
                "Rate": Rate,
                "Distance": Distance,
                "FC": FC,
                "CC": CC,
                "ProductCode": ProductCode,
                "OUCode": OUCode,
                "travelDescription": travelDescription,
                "Traveltypes": istravelss,
                "Amount": Amount,
                "TravelHsnid": Hsnid,
                "InvGid": invid,
                "RCMFlag": RCMFlag,
               
            };
            $.post('../NonTravelClaimNewGST/TravelModeCreate', NewExpensemodel,
            function (data) {
                if (data == "Success") {
                    debugger;
                    jAlert("Saved Successfully.", "Message", function (u) {
                        if (u == true) {
                            debugger;
                          
                            $("#processworking").attr("style", "display:block;");
                            var urlEcf = '@Url.Action("ECFDetails", "NonTravelClaimNewGST")?' + new Date().getTime();
                            $("#tabsmaintravel-6").load(urlEcf);
                            var url = '@Url.Action("TravelModeDetail", "NonTravelClaimNewGST")?' + new Date().getTime();
                            $("#tabsmaintravel-1").load(url);
                            var url1 = '@Url.Action("EmployeeList", "NonTravelClaimNewGST")?' + new Date().getTime();
                            $("#tabsmaintravel-3").load(url1);

                        
                            if (Ecfrowtolamtnew == null || Ecfrowtolamtnew == "0" || Ecfrowtolamtnew == "") {
                           
                                $("#newadding").val(Amount);
                                $("#txtAmountt").val('');
                                $("#txtAmountt").removeClass('valid');
                                $("#txtAmountt").addClass('required');

                                $("#ddlNatureofExpensest").val('0');
                                $("#ddlNatureofExpensest").removeClass('valid');
                                $("#ddlNatureofExpensest").addClass('required');

                                $("#ddlExpenseCategoryt").val('0');
                                $("#ddlExpenseCategoryt").removeClass('valid');
                                $("#ddlExpenseCategoryt").addClass('required');

                                $("#ddlSubCategoryt").val('0');
                                $("#ddlSubCategoryt").removeClass('valid');
                                $("#ddlSubCategoryt").addClass('required');

                                $("#ddlTravelModet").val('0');
                                $("#ddlTravelModet").removeClass('valid');
                                $("#ddlTravelModet").addClass('required');

                                $("#ddlTravelClasst").val('0');
                                $("#ddlTravelClasst").removeClass('valid');
                                $("#ddlTravelClasst").addClass('required');

                                $("#nontravelmode").hide();
                                $("#txttravelDescription").val('');
                                $("#txtRatet").val('');
                                $("#txtDistancet").val('');
                                $('#txtAmountt').attr('disabled', false);

                               // $("#txtPeriodFromdate,#txtPeriodTodata,#txtRatet,#txtDistancet,#txtFCt,#txtCCt,#txtProductCodet,#txtFCCC,#txtOUCodet,#txtClaimMontht,#txtHsnIdd,#txthsndescc,#txttravelDescription").val("");

                                //selva 04-02-2021 change Cost center and Busines Segment for should not refresh
                                $("#txtPeriodFromdate,#txtPeriodTodata,#txtRatet,#txtDistancet,#txtProductCodet,#txtFCCC,#txtOUCodet,#txtClaimMontht,#txtHsnIdd,#txthsndescc,#txttravelDescription").val("");

                                $("#ddlPlaceFromt,#ddlPlaceTot,#ddlTravelClasst").val('0');
                                cheval();
                                var sumamt = parseFloat(Ecfrowtolamtnew) + parseFloat(Amount);
                                var addedval = parseFloat(sumamt);
                                var ecfaddedval = parseFloat(InvAmount);

                                if (ecfaddedval == addedval) {
                                    GotoIndexExpense();
                                    window.parent.jQuery('#ForPartialViewTravelmodenew').dialog('close');
                                }
                            }
                            else {
                               // alert('b');
                                var sumamt = parseFloat(Ecfrowtolamtnew) + parseFloat(Amount);
                                $("#newadding").val(sumamt);
                                var addedval = parseFloat(sumamt);
                                var ecfaddedval = parseFloat(InvAmount);

                                if (ecfaddedval == addedval) {
                                   // alert('c');
                                    GotoIndexExpense();
                                    window.parent.jQuery('#ForPartialViewTravelmodenew').dialog('close');
                                }
                                else {
                                    //alert('d');
                                   
                                    $("#txtAmountt").val('');
                                    $("#txtAmountt").removeClass('valid');
                                    $("#txtAmountt").addClass('required');

                                    $("#ddlNatureofExpensest").val('0');
                                    $("#ddlNatureofExpensest").removeClass('valid');
                                    $("#ddlNatureofExpensest").addClass('required');

                                    $("#ddlExpenseCategoryt").val('0');
                                    $("#ddlExpenseCategoryt").removeClass('valid');
                                    $("#ddlExpenseCategoryt").addClass('required');

                                    $("#ddlSubCategoryt").val('0');
                                    $("#ddlSubCategoryt").removeClass('valid');
                                    $("#ddlSubCategoryt").addClass('required');

                                    $("#nontravelmode").hide();
                                    $("#txttravelDescription").val('');

                                    $("#ddlTravelModet").val('0');
                                    $("#ddlTravelModet").removeClass('valid');
                                    $("#ddlTravelModet").addClass('required');

                                    $("#ddlTravelClasst").val('0');
                                    $("#ddlTravelClasst").removeClass('valid');
                                    $("#ddlTravelClasst").addClass('required');

                                    $("#nontravelmode").hide();
                                    $("#txttravelDescription").val('');
                                    $("#txtRatet").val('');
                                    $("#txtDistancet").val('');
                                    $('#txtAmountt').attr('disabled', false);
                                    // $("#txtPeriodFromdate,#txtPeriodTodata,#txtRatet,#txtDistancet,#txtFCt,#txtCCt,#txtProductCodet,#txtFCCC,#txtOUCodet,#txtClaimMontht,#txtHsnIdd,#txthsndescc,#txttravelDescription").val("");
                                    //selva change Cost center and Busines Segment for should not refresh
                                    $("#txtPeriodFromdate,#txtPeriodTodata,#txtRatet,#txtDistancet,#txtProductCodet,#txtFCCC,#txtOUCodet,#txtClaimMontht,#txtHsnIdd,#txthsndescc,#txttravelDescription").val("");

                                $("#ddlPlaceFromt,#ddlPlaceTot,#ddlTravelClasst").val('0');
                                    cheval();
                                }
                            }
                        }
                    });
                }
                else if (data == "duplicate") {
                    jAlert("Duplicate Data: Data Already Exits.", "Message");
                    return false;
                }
                else {
                    jAlert(data, "Message");
                    return false;
                }
            }, 'json');
       // }
    }
 

    function concode(fcs, ccs) {
        var fc = fcs.split('-');
        var cc = ccs.split('-');
        $("#txtFCCC").val(fc[1] + "-" + cc[1]);
    }



    function getmonth(date) {
        if (date.length == 10) {
            var ddd = isgetmonthyear(date);
            if (ddd == "Error") {
                $("#txtClaimMontht").val('')
            }
            else {
                $("#txtClaimMontht").val(ddd)
            }
        }
        else {
            $("#txtClaimMontht").val('')
        }
    }
    function isgetmonthyear(evt) {
        var retnval;
        var str = evt;
        var array = str.split('-');

        if (array[1] == "01") {
            retnval = "January-" + array[2];
            return retnval;
        }
        if (array[1] == "02") {
            retnval = "February-" + array[2]; return retnval;
        }
        if (array[1].trim() == "03") {
            retnval = "March-" + array[2]; return retnval;
        }
        if (array[1].trim() == "04") {
            retnval = "April-" + array[2]; return retnval;
        }
        if (array[1].trim() == "05") {
            retnval = "May-" + array[2]; return retnval;
        }
        if (array[1].trim() == "06") {
            retnval = "June-" + array[2]; return retnval;
        }
        if (array[1].trim() == "07") {
            retnval = "July-" + array[2]; return retnval;
        }
        if (array[1].trim() == "08") {
            retnval = "August-" + array[2]; return retnval;
        }
        if (array[1].trim() == "09") {
            retnval = "September-" + array[2]; return retnval;
        }
        if (array[1].trim() == "10") {
            retnval = "October-" + array[2]; return retnval;
        }
        if (array[1].trim() == "11") {
            retnval = "November-" + array[2]; return retnval;
        }
        if (array[1].trim() == "12") {
            retnval = "December-" + array[2]; return retnval;
        }
        else {
            retnval = "Error"; return retnval;
        }
        return retnval;
    }


    function cheval() {

        debugger;
       
        var ddlNatureofExpenses1 = $("#ddlNatureofExpensest").val();
        var ddlExpenseCategory1 = $("#ddlExpenseCategoryt").val();
        var ddlSubCategory1 = $("#ddlSubCategoryt").val();

        var ddlNatureofExpenses = $("#ddlNatureofExpensest option:selected").text();
        var ddlExpenseCategory = $("#ddlExpenseCategoryt option:selected").text();
        var ddlSubCategory = $("#ddlSubCategoryt option:selected").text();

        var txtClaimPeriodFrom = $("#txtPeriodFromdate").val();
        var txtClaimPeriodTo = $("#txtPeriodTodata").val();
        var txtAmount = $("#txtAmountt").val();
        var txtProductCode = $("#txtProductCodet").val();
        var txtOUCode = $("#txtOUCodet").val();

        //var TravelMode = $("#ddlTravelModet option:selected").text();
        //var TravelClass = $("#ddlTravelClasst option:selected").text();
        //var TravelMode1 = $("#ddlTravelModet").val();
        //var TravelClass1 = $("#ddlTravelClasst").val();

        var PlaceFrom1 = $("#ddlPlaceFromt").val();
        var PlaceTo1 = $("#ddlPlaceTot").val();
       

        if (txtAmount != "0.00" && txtProductCode != "" && txtOUCode != "" && ddlNatureofExpenses1 != null && ddlExpenseCategory1 != null && ddlSubCategory1 != null && ddlNatureofExpenses1 != "0" && ddlExpenseCategory1 != "0" && ddlSubCategory1 != "0" && ddlNatureofExpenses != "--Select--" && ddlExpenseCategory != "--Select--" && ddlSubCategory != "--Select--" && txtClaimPeriodFrom != "" && txtClaimPeriodTo != "" && txtAmount != "") {

            var ddlNaturelocal = $("#ddlNatureofExpenses option:selected").text();
            if (ddlNaturelocal == "Local Conveyance") {
                if (txtAmount != "0.00" &&
                    PlaceFrom1 != null && TravelClass1 != null &&
               PlaceFrom1 != "" && TravelClass1 != "0" &&
               TravelMode1 != null && PlaceTo1 != null &&
               TravelMode1 != "0" && PlaceTo1 != "" &&
               TravelMode != "--Select--" && TravelClass != "--Select--" && txtProductCode != "" && txtOUCode != "" && ddlNatureofExpenses1 != null && ddlExpenseCategory1 != null && ddlSubCategory1 != null && ddlNatureofExpenses1 != "0" && ddlExpenseCategory1 != "0" && ddlSubCategory1 != "0" && ddlNatureofExpenses != "--Select--" && ddlExpenseCategory != "--Select--" && ddlSubCategory != "--Select--" && txtClaimPeriodFrom != "" && txtClaimPeriodTo != "" && txtAmount != "") {
                    $('#btnsavexpp').attr('disabled', false);
                }
                else {
                    $('#btnsavexpp').attr('disabled', true);
                }
            }
            else {
                $('#btnsavexpp').attr('disabled', false);
            }
        }
        else {
            $('#btnsavexpp').attr('disabled', true);
        }
    }

    //function cheval() {
     

    //    var Rate = $("#txtRatet").val();
    //    var Distance = $("#txtDistancet").val();
    //    var ProductCode = $("#txtProductCodet").val();
    //    var OUCode = $("#txtOUCodet").val();

    //    var ddlNatureofExpenses1 = $("#ddlNatureofExpensest").val();
    //    var ddlExpenseCategory1 = $("#ddlExpenseCategoryt").val();
    //    var ddlSubCategory1 = $("#ddlSubCategoryt").val();
    //    var PlaceFrom1 = $("#ddlPlaceFromt").val();
    //    var PlaceTo1 = $("#ddlPlaceTot").val();

    //    var TravelMode1 = $("#ddlTravelModet").val();
    //    var TravelClass1 = $("#ddlTravelClasst").val();

    //    var ddlNatureofExpenses = $("#ddlNatureofExpensest option:selected").text();
    //    var ddlExpenseCategory = $("#ddlExpenseCategoryt option:selected").text();
    //    var ddlSubCategory = $("#ddlSubCategoryt option:selected").text();
    //    var PlaceFrom = $("#ddlPlaceFromt option:selected").text();
    //    var PlaceTo = $("#ddlPlaceTot option:selected").text();

    //    var TravelMode = $("#ddlTravelModet option:selected").text();
    //    var TravelClass = $("#ddlTravelClasst option:selected").text();

    //    var txtClaimPeriodFrom = $("#txtPeriodFromdate").val();
    //    var txtClaimPeriodTo = $("#txtPeriodTodata").val();
    //    var txtAmount = $("#txtAmountt").val();

    //    var istravel = $("#istravelss").val();
    //    if (istravel == "T") {
    //        if (txtAmount != "0.00" && ddlNatureofExpenses1 != null && ddlExpenseCategory1 != null && ddlSubCategory1 != null &&
    //            ddlNatureofExpenses1 != "0" && ddlNatureofExpenses1 != "0" && ddlNatureofExpenses1 != "0" &&
    //            ddlNatureofExpenses != "--Select--" && ddlExpenseCategory != "--Select--" && ddlSubCategory != "--Select--" &&
    //            PlaceFrom1 != null && TravelClass1 != null &&
    //            PlaceFrom1 != "0" && TravelClass1 != "0" &&
    //            PlaceFrom != "--Select--" && PlaceTo != "--Select--" &&
    //            TravelMode1 != null && PlaceTo1 != null &&
    //            TravelMode1 != "0" && PlaceTo1 != "0" &&
    //            TravelMode != "--Select--" && TravelClass != "--Select--" &&
               
    //            ProductCode != "" && OUCode != "" &&
    //            txtClaimPeriodFrom != "" && txtClaimPeriodTo != "" && txtAmount != "") {
    //            $('#btnsavexpp').attr('disabled', false);
    //        }
    //        else {
    //            $('#btnsavexpp').attr('disabled', true);
    //        }
    //    }
    //    else if (istravel == "O") {
    //        if (txtAmount != "0.00" && ddlNatureofExpenses1 != null && ddlExpenseCategory1 != null && ddlSubCategory1 != null &&
    //           ddlNatureofExpenses1 != "0" && ddlNatureofExpenses1 != "0" && ddlNatureofExpenses1 != "0" &&
    //           ddlNatureofExpenses != "--Select--" && ddlExpenseCategory != "--Select--" && ddlSubCategory != "--Select--" &&
    //           PlaceFrom1 != null &&
    //           PlaceFrom1 != "0" &&
    //           PlaceFrom != "--Select--" && PlaceTo != "--Select--" &&
    //           PlaceTo1 != null &&
    //           PlaceTo1 != "0" &&
    //           ProductCode != "" && OUCode != "" &&
    //           txtClaimPeriodFrom != "" && txtClaimPeriodTo != "" && txtAmount != "") {
    //            $('#btnsavexpp').attr('disabled', false);
    //        }
    //        else {
    //            $('#btnsavexpp').attr('disabled', true);
    //        }
    //    }
    //    else {
    //        $('#btnsavexpp').attr('disabled', true);
    //    }
    //}




    //Ramya Added
    function LoadRCMonHSNChange(txtHsnIdd) {
        //hsn+provider location state
        var DebitlineGId = 0;
        var ECFId = 0;
        var invid = 0;
        var ProviderLocation = 0;
        var GstinVendor = 0;
        var hsngid = txtHsnIdd;

        var rcmflagparam = {
            DebitlineGId: DebitlineGId,
            ECFId: ECFId,
            invid: invid,
            hsngid: hsngid,
            ProviderLocation: ProviderLocation,
            action: 'single'

        };
        $.ajax({
            type: "post",

            url: "../TravelClaimNew/CheckrcmExists",
            data: JSON.stringify(rcmflagparam),
            contentType: "application/json;",
            success: function (response) {
                var Data1 = "";
                if (response.Data1 != null && response.Data1 != "" && JSON.parse(response.Data1) != null) {
                    Data1 = JSON.parse(response.Data1);
                    if (Data1[0].STATUS == 'EXISTS')
                        $("#rdorcmChargedYes").prop("checked", true);
                    else {
                        $("#rdorcmChargedNo").prop("checked", true);
                    }
                }


            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(errorThrown);
            }
        });

    };
    $('#txtOUCodet').blur(function () {
        var OucodeBussiness = document.getElementById('txtOUCodet').value;
            var Student =
           {
               "OUCode": OucodeBussiness
           };
            $.ajax({
                url: '../TravelClaimNew/ChangeBussinessSegment/',
                data: JSON.stringify(Student),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#txtFCt").val(data[0].OUCode);
                },
                error: function (result) {
                    jAlert("Error.", "Error");
                    return false;
                }
            });
    });

    function Clear() {

        $("#txtAmountt").val('');
        $("#txtPeriodFromdate").val('');
        $("#txtPeriodTodata").val('');
        $("#txtClaimMontht").val('');
        $("#ddlNatureofExpensest").val('0');
        $("#FC").val('0');
        $("#CC").val('0');
        $("#txtProductCodet").val('0');
        $("#txtOUCodet").val('0');
        $("#txtHsnIdd").val('0');
        $("#ddlExpenseCategoryt").val('0');
        $("#ddlSubCategoryt").val('0');
        $("#txttravelDescription").val('');
        $("#ddlTravelModet").val('0');
        $("#ddlTravelClasst").val('0');
        $("#txthsndescc").val('');
        $("#txttravelDescription").val('');
    }

</script>