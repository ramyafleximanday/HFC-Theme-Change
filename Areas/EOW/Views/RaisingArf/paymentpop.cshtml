@model  IEM.Areas.EOW.Models.EOW_arfraising
@using System.Data
@using IEM.Areas.EOW.Models
@{
    var vl = 0;
    var viewfor = (string)ViewBag.viewfor;
    var dis = "";
    dis = ViewBag.viewfor;
    if (viewfor == "edit")
    {
        ViewBag.viewmode = "";
        vl = 1;
    }
    else if (viewfor == "view")
    {
        ViewBag.viewmode = "disabled";
        vl = 1;
    }
    else if (viewfor == "Delete")
    {
        ViewBag.viewmode = "disabled";
        vl = 1;
    }
    if (vl == 0)
    {
        dis = null;
    }
   
    DataTable getadvancetype = new DataTable();
    List<EOW_arfraising> list = new List<EOW_arfraising>();
    ArfRaising rais = new ArfRaising();
    //list = rais.Selectpayment().ToList();
    EOW_arfraising get = new EOW_arfraising();
    EOW_arfraising get1 = new EOW_arfraising();
    get.GetPaymode = new SelectList(rais.GetPaymode(Session["employeesupplier"].ToString(),Convert.ToString(Session["Supplierecfid"])), "paymode_gid", "paymode_name", get.creditline_pay_mode);
    get.GetRef = new SelectList(rais.GetRefant(Session["employeesupplier"].ToString()), "payment_accountno", "payment_accountno", get.creditline_ref_no);
    //get.GetBenificary = new SelectList(rais.GetBenificary(), "payment_benificary", "payment_benificary", get.creditline_beneficiary);
    WebGrid grid = new WebGrid(source: list, canSort: true, canPage: true, rowsPerPage: 5, ajaxUpdateContainerId: "grid", ajaxUpdateCallback: "grid", selectionFieldName: "SelectedRow");

    //grid.Pager(WebGridPagerModes.All);
}
@*<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.24.min.js")" type="text/javascript"></script>*@
<div id="pppay">
    @using (Html.BeginForm())
    {
        <table class="myTableStyleTabNew" align="left">
            <tr>
                <td style="display:none;">
                    @if (dis != null)
                    {
                        <input name="DocNameID" id="creditline_gid" type="text" placeholder="DocName ID" data-val="true" value="@Model.creditline_gid" />
                    }
                    else
                    {
                        <input name="DocNameID" id="creditline_gid" type="text" placeholder="DocName ID" data-val="true" value="" />
                    }
                </td>

            </tr>
            <tr>
                <td style="display:none;">
                    @if (dis != null)
                    {
                        <input name="DocNameID" id="ecfarf_ecf_gid" type="text" placeholder="DocName ID" data-val="true" value="@Model.ecfarf_ecf_gid" />
                    }
                    else
                    {
                        <input name="DocNameID" id="ecfarf_ecf_gid" type="text" placeholder="DocName ID" data-val="true" value="" />
                    }
                </td>

            </tr>
            <tr>
                <td>
                    <div id="txtdocgrpname">
                        <span>PayMode</span>
                        <br />
                        @if (dis == null)
                        {
                            @Html.DropDownListFor(m => m.paymode_gid, Model.GetPaymode, "--select--", new { @class = "textboxStyle required ", @style = "display: block", @id = "creditline_pay_mode" })
                        }
                        @if (viewfor == "edit")
                        {
                            @Html.DropDownListFor(e => e.creditline_pay_mode, Model.GetPaymode, "---select---", new { @class = "textboxStyle valid ", @style = "display: block", @id = "creditline_pay_mode" })
                        }
                        else if (viewfor == "view")
                        {
                            @Html.DropDownListFor(e => e.creditline_pay_mode, Model.GetPaymode, "---select---", new { @class = "textboxStyle valid ", @style = "display: block", @id = "creditline_pay_mode", @disabled = "disabled" })
                        }
                        else if (viewfor == "Delete")
                        {
                            @Html.DropDownListFor(e => e.creditline_pay_mode, Model.GetPaymode, "---select---", new { @class = "textboxStyle valid ", @style = "display: block", @id = "creditline_pay_mode", @disabled = "disabled" })
                        }
                    </div>


                </td>
                <td>
                    <div id="txtTypeName">
                        <span> Ref No </span>
                        <br />
                        @if (dis == null)
                        {
                            @Html.DropDownListFor(m => m.payment_accountno, Model.GetRef, "--select--", new { @class = "textboxStyle", @style = "display: block", @id = "creditline_ref_no" })
                        }
                        @if (viewfor == "edit")
                        {
                            @Html.DropDownListFor(e => e.creditline_ref_no, Model.GetRef, "---select---", new { @class = "textboxStyle", @style = "display: block", @id = "creditline_ref_no" })
                        }
                        else if (viewfor == "view")
                        {
                            @Html.DropDownListFor(e => e.creditline_ref_no, Model.GetRef, "---select---", new { @class = "textboxStyle", @style = "display: block", @id = "creditline_ref_no", @disabled = "disabled" })
                        }
                        else if (viewfor == "Delete")
                        {
                            @Html.DropDownListFor(e => e.creditline_ref_no, Model.GetRef, "---select---", new { @class = "textboxStyle", @style = "display: block", @id = "creditline_ref_no", @disabled = "disabled" })
                        }
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div id="txtdocgrpname">
                        <span>Benificiary</span>
                        <br />
                        
                              <input name="creditline_beneficiary" id="creditline_beneficiary" class="textboxStyle valid" maxlength="64" type="text" data-val="true" value="@Session["supname"].ToString()" readonly="readonly" />
                        
                        @*@if (dis == null)
                            {
                                @Html.DropDownListFor(m => get.payment_benificary, get.GetBenificary, "--select--", new { @class = "form-control ", @style = "display: block", @id = "creditline_beneficiary" })
                            }
                            @if (viewfor == "edit1")
                            {
                                @Html.DropDownListFor(e => get.payment_benificary, Model.GetBenificary, "---select---", new { @class = "textboxStyle valid ", @style = "display: block", @id = "creditline_beneficiary" })
                            }
                            else if (viewfor == "view1")
                            {
                                @Html.DropDownListFor(e => get.payment_benificary, Model.GetBenificary, "---select---", new { @class = "textboxStyle valid ", @style = "display: block", @id = "creditline_beneficiary", @disabled = "disabled" })
                            }
                            else if (viewfor == "Delete1")
                            {
                                @Html.DropDownListFor(e => get.payment_benificary, Model.GetBenificary, "---select---", new { @class = "textboxStyle valid ", @style = "display: block", @id = "creditline_beneficiary", @disabled = "disabled" })
                            }*@
                    </div>
                </td>
                <td>
                    <div id="txtTypeName">
                        <span>Amount</span>
                        <br />
                        @if (dis == null)
                        {
                            <input name="CategoryName" id="_amount" class="textboxStyle required" maxlength="9" type="text" data-val="true" value="" />
                        }
                        else
                        {
                            <input name="CategoryName" id="_amount" class="textboxStyle valid" maxlength="9" type="text" data-val="true" value="@Model.creditline_amount" @ViewBag.viewmode />
                        }
                    </div>
                </td>
            </tr>
        </table>
        <br />
        <table class="myTableStyleTabNew" align="left">
            <tr>
                <td>
                    <div id="txtTypeName">
                        <span>Description</span>
                        <br />
                        @if (dis == null)
                        {
                            @*<input name="CategoryName" id="_Descri" class="textboxStyle required" maxlength="255" type="text" data-val="true" value="" />*@
                            <textarea name="CategoryName" id="_Descri" cols="30" rows="5" maxlength="225" class="textboxStyle required " style="display: block; width:344px; height:27px;"></textarea>
                        }
                        else
                        {
                            <textarea name="CategoryName" id="_Descri" cols="30" rows="5" maxlength="225" class="textboxStyle valid " style="display: block; width:344px; height:27px;">@Model.creditline_desc</textarea>
                            @*<input name="CategoryName" id="_Descri" class="textboxStyle valid" maxlength="255" type="text" data-val="true" value="@Model.creditline_desc" @ViewBag.viewmode />*@
                        }

                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="margin-left:85px;">
                        <br />
                        @if (dis == null)
                        {
                            <button type="button" id="btnupdate1" class="btn btn-success" value="Submit" onclick="Savepayment()"><span class="glyphicon glyphicon-ok" style="color:white;"></span> Submit</button>
                        }
                        @if (viewfor == "edit")
                        {
                            <button type="button" id="btnupdate1" class="btn btn-success" value="Submit" onclick="Savepayment()"><span class="glyphicon glyphicon-ok" style="color:white;"></span> Submit</button>
                        }
                        @if (viewfor == "Delete")
                        {
                            <button type="button" id="btnpaydel" class="btn btn-danger" value="Delete" onclick="Delete()"> <span class="glyphicon glyphicon-trash" style="color:white;"></span>Delete</button>
                        }
                        <button type="button" value="Cancel" class="btn btn-warning" onclick="GotoIndexPayment()"><span style="color:white;" class="glyphicon glyphicon-remove-sign"></span> Clear</button>
                    </div>
                </td>
            </tr>
        </table>
    }
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $('#btnupdate1').attr('disabled', true);
        // $('#btnpaydel').hide();
        var typearf = $('#ddlarftype').val();
        //$.post('../RaisingArf/Getpaymentdata',
        //          function (data) {
        //              var num = 0;
        //              var Snumber = 0;
        //              var newrow;

        //              if (data == 0 || data == "") { } else {
        //                  if (data.length > 0) {
        //                      for (var gh = 0; gh < data.length ; gh++) {
        //                          newrow = "<tr id='trpayment" + data[gh].creditline_gid + "'><td><label for=titlename id='" + data[gh].creditline_pay_mode + "'> " + data[gh].creditline_pay_mode + " </label></td>";
        //                          newrow += " <td><label for=titlename id='" + data[gh].creditline_ref_no + "'> " + data[gh].creditline_ref_no + " </label></td>";
        //                          newrow += " <td><label for=titlename id='" + data[gh].creditline_beneficiary + "'>" + data[gh].creditline_beneficiary + "</label></td> ";
        //                          newrow += " <td><label for=titlename id='" + data[gh].creditline_desc + "'> " + data[gh].creditline_desc + " </label></td>";
        //                          newrow += " <td><label for=titlename id='" + data[gh].creditline_amount + "'> " + data[gh].creditline_amount + " </label></td>";
        //                          newrow += " <td style='display:none;'><label for=titlename id='" + data[gh].ecfarf_ecf_gid + "'> " + data[gh].ecfarf_ecf_gid + " </label></td>";
        //                          if (typearf != "E") {
        //                              if (typearf != "Employee") {
        //                                  newrow += " <td ></a> <a title='View' id=" + data[gh].creditline_gid + "  onclick='ViewTypepayment(this, id)'> <span class='glyphicon glyphicon-eye-open'> </span> </a> </a> <a title='Edit' id=" + data[gh].creditline_gid + "  onclick='EditTypepayment(this, id)'> <span class='glyphicon glyphicon-edit'> </span> </a> </a> <a title='Delete' id=" + data[gh].creditline_gid + "  onclick='DeleteTypepayment(this, id)'> <span class='glyphicon glyphicon-trash'> </span> </a> </td></tr>";
        //                              }
        //                          }
        //                          var controlToBeRemoved = "#trpayment" + data[gh].creditline_gid;

        //                          $(controlToBeRemoved).remove();
        //                          $('#paygrid tbody:last').append(newrow);
        //                      }
        //                  }
        //              }
        //          });
        if (typearf != "E") {
            if (typearf != "Employee") {
                $('#pay_ment').attr('disabled', false);
            }
            else {
                $('#_Descri').attr('disabled', true);
                $('#_amount').attr('disabled', true);
                $('#creditline_pay_mode').attr('disabled', true);
                $('#creditline_ref_no').attr('disabled', true);
                $('#creditline_beneficiary').attr('disabled', true);
                $('#pay_ment').attr('disabled', true);
            }
        }
        else {
            $('#_Descri').attr('disabled', true);
            $('#_amount').attr('disabled', true);
            $('#creditline_pay_mode').attr('disabled', true);
            $('#creditline_ref_no').attr('disabled', true);
            $('#creditline_beneficiary').attr('disabled', true);
            $('#pay_ment').attr('disabled', true);
        }
    });
    //function isNumberKey(evt) {
    //    var charCode = (evt.which) ? evt.which : event.keyCode
    //    if (charCode > 31 && (charCode < 48 || charCode > 57))
    //        return false;
    //    return true;
    //}


    $("#_amount").keypress(function (event) {

        return isNumber1(event);

    });

    $("#_amount").change(function () {
        var paymode_gid = $('#creditline_pay_mode').val();
        var ddlraisermode = $('#creditline_ref_no').val();
        var ddlbenific = $('#creditline_beneficiary').val();
        var _Descri = $('#_Descri').val();
        var _amount = $('#_amount').val();

        if (paymode_gid == "" || _Descri == "" || _amount == "") {
            $('#btnupdate1').attr('disabled', true);
        }

        else {
            $('#btnupdate1').attr('disabled', false);
        }

        var txtSupplierName = $("#_amount").val();
        if (txtSupplierName.trim() != "") {
            $("#_amount").removeClass('required');
            $("#_amount").addClass('valid');
        }
        else {
            $("#_amount").removeClass('valid');
            $("#_amount").addClass('required');
        }
    });
    $("#_Descri").change(function () {
        var paymode_gid = $('#creditline_pay_mode').val();
        var ddlraisermode = $('#creditline_ref_no').val();
        var ddlbenific = $('#creditline_beneficiary').val();
        var _Descri = $('#_Descri').val();
        var _amount = $('#_amount').val();

        if (paymode_gid == "" || _Descri == "" || _amount == "") {
            $('#btnupdate1').attr('disabled', true);
        }

        else {
            $('#btnupdate1').attr('disabled', false);
        }

        var txtSupplierName = $("#_Descri").val();
        if (txtSupplierName.trim() != "") {
            $("#_Descri").removeClass('required');
            $("#_Descri").addClass('valid');
        }
        else {
            $("#_Descri").removeClass('valid');
            $("#_Descri").addClass('required');
        }
    });
    $("#creditline_beneficiary").change(function () {
        var paymode_gid = $('#creditline_pay_mode').val();
        var ddlraisermode = $('#creditline_ref_no').val();
        var ddlbenific = $('#creditline_beneficiary').val();
        var _Descri = $('#_Descri').val();
        var _amount = $('#_amount').val();

        if (paymode_gid == "" || _Descri == "" || _amount == "") {
            $('#btnupdate1').attr('disabled', true);
        }

        else {
            $('#btnupdate1').attr('disabled', false);
        }

        var txtSupplierName = $("#creditline_beneficiary").val();
        if (txtSupplierName.trim() != "") {
            $("#creditline_beneficiary").removeClass('required');
            $("#creditline_beneficiary").addClass('valid');
        }
        else {
            $("#creditline_beneficiary").removeClass('valid');
            $("#creditline_beneficiary").addClass('required');
        }
    });
    $("#creditline_pay_mode").change(function () {
        var ddlid = $(this).val();

        var expensen =
            {
                "creditline_pay_mode": ddlid
            };

        $.ajax({
            url: '@Url.Action("GetRefamount", "RaisingArf")',

            data: JSON.stringify(expensen),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',

            success: function (data) {

                $("#creditline_ref_no").empty();

                if (data.length > 0) {


                    for (var i = 0; i < data.length; i++) {
                        $('#creditline_ref_no').attr('disabled', false);
                        $("#creditline_ref_no").append("<option value=" + data[i].payment_accountno + " >" + data[i].payment_accountno + "</option>");
                    }
                }

                if (data.length == 0) {
                    $("#creditline_ref_no").append("<option value='0' >--Select--</option>");
                    $('#creditline_ref_no').attr('disabled', true);
                }
                if (data.length == null) {
                    alert("3");
                }
            },
            error: function (result) {
                alert("Error");
            }
        });
    });
    $("#creditline_ref_no").change(function () {
        var paymode_gid = $('#creditline_pay_mode').val();
        var ddlraisermode = $('#creditline_ref_no').val();
        var ddlbenific = $('#creditline_beneficiary').val();
        var _Descri = $('#_Descri').val();
        var _amount = $('#_amount').val();

        if (paymode_gid == "" || _Descri == "" || _amount == "") {
            $('#btnupdate1').attr('disabled', true);
        }

        else {
            $('#btnupdate1').attr('disabled', false);
        }

        //var txtSupplierName = $("#creditline_ref_no").val();
        //if (txtSupplierName.trim() != "") {
        //    $("#creditline_ref_no").removeClass('required');
        //    $("#creditline_ref_no").addClass('valid');
        //}
        //else {
        //    $("#creditline_ref_no").removeClass('valid');
        //    $("#creditline_ref_no").addClass('required');
        //}
    });
    $("#creditline_pay_mode").change(function () {
        var paymode_gid = $('#creditline_pay_mode').val();
        var ddlraisermode = $('#creditline_ref_no').val();
        var ddlbenific = $('#creditline_beneficiary').val();
        var _Descri = $('#_Descri').val();
        var _amount = $('#_amount').val();

        if (paymode_gid == "" || _Descri == "" || _amount == "") {
            $('#btnupdate1').attr('disabled', true);
        }

        else {
            $('#btnupdate1').attr('disabled', false);
        }

        var txtSupplierName = $("#creditline_pay_mode").val();
        if (txtSupplierName.trim() != "") {
            $("#creditline_pay_mode").removeClass('required');
            $("#creditline_pay_mode").addClass('valid');
        }
        else {
            $("#creditline_pay_mode").removeClass('valid');
            $("#creditline_pay_mode").addClass('required');
        }
    });
    function GotoIndexPayment() {
        $('#btnupdate1').attr('disabled', true);
        $('#_Descri').val("");
        $('#_Descri').attr('disabled', false);
        $("#_Descri").removeClass('valid');
        $("#_Descri").addClass('required');
        $('#_amount').val("");
        $('#_amount').attr('disabled', false);
        $("#_amount").removeClass('valid');
        $("#_amount").addClass('required');

        $('#creditline_gid').val("0");
        $("#btnpaydel").hide();
        $('#btnsavevl').show();

        var typearf = $('#ddlarftype').val();
        if (typearf != "E") {
            if (typearf != "Employee") {

            }
            else {
                $('#_Descri').attr('disabled', true);
                $('#_amount').attr('disabled', true);
                $('#creditline_pay_mode').attr('disabled', true);
                $('#creditline_ref_no').attr('disabled', true);
                $('#creditline_beneficiary').attr('disabled', true);
            }
        }
        else {
            $('#_Descri').attr('disabled', true);
            $('#_amount').attr('disabled', true);
            $('#creditline_pay_mode').attr('disabled', true);
            $('#creditline_ref_no').attr('disabled', true);
            $('#creditline_beneficiary').attr('disabled', true);
        }
        var val = 0;
        var Student = {
            "creditline_pay_mode": val,
        };
        $.ajax({
            url: '@Url.Action("Paymode", "RaisingArf")',

            data: JSON.stringify(Student),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',

            success: function (data) {

                $("#creditline_pay_mode").empty();

                if (data.length > 0) {

                    $("#creditline_pay_mode").append("<option value='0' >---Select---</option>");
                    for (var i = 0; i < data.length; i++) {

                        $("#creditline_pay_mode").append("<option value=" + data[i].paymode_gid + " >" + data[i].paymode_name + "</option>");
                        $('#creditline_pay_mode').attr('disabled', false);
                        $("#creditline_pay_mode").removeClass('valid');
                        $("#creditline_pay_mode").addClass('required');
                    }
                }

                if (data.length == 0) {
                    $("#creditline_pay_mode").append("<option value='0' >--Select--</option>");
                    $('#creditline_pay_mode').attr('disabled', true);
                }
                if (data.length == null) {
                    alert("3");
                }
            },
            error: function (result) {
                alert("Error");
            }
        });
        var val = 0;
        var Student = {
            "creditline_ref_no": val,
        };
        $.ajax({
            url: '@Url.Action("Refno", "RaisingArf")',

            data: JSON.stringify(Student),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',

            success: function (data) {

                $("#creditline_ref_no").empty();

                if (data.length > 0) {

                    $("#creditline_ref_no").append("<option value='0' >---Select---</option>");
                    for (var i = 0; i < data.length; i++) {

                        $("#creditline_ref_no").append("<option value=" + data[i].payment_accountno + " >" + data[i].payment_accountno + "</option>");
                        $('#creditline_ref_no').attr('disabled', false);
                        $("#creditline_ref_no").removeClass('valid');
                        $("#creditline_ref_no").addClass('required');
                    }
                }

                if (data.length == 0) {
                    $("#creditline_ref_no").append("<option value='0' >---Select---</option>");
                    $('#creditline_ref_no').attr('disabled', true);
                }
                if (data.length == null) {
                    alert("3");
                }
            },
            error: function (result) {
                alert("Error");
            }
        });
        window.parent.jQuery('#ForPartialViewpayment_pop').dialog('close');
    }
    function updatepayment() {
        var paymode_gid = $('#creditline_pay_mode').val();
        var ddlraisermode = $('#creditline_ref_no').val();
        var ddlbenific = $('#creditline_beneficiary').val();
        var _Descri = $('#_Descri').val();
        var _amount = $('#_amount').val();
        var ecfarf_ecf_gid = $('#ecfarf_ecf_gid').val();
        var creditline_gid = $('#creditline_gid').val();

        var Student = {
            "ecfarf_ecf_gid": ecfarf_ecf_gid,
            "creditline_ecf_gid": creditline_gid,
            "creditline_pay_mode": paymode_gid,
            "creditline_ref_no": ddlraisermode,
            "creditline_beneficiary": ddlbenific,
            "creditline_desc": _Descri,
            "creditline_amount": _amount
        };
        $.ajax({
            url: '../RaisingArf/updatePayment/',
            data: JSON.stringify(Student),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (result) {
                if (result == "Exists") {
                    if (confirm("Duplicate Record !")) {
                        //InsertPouch();
                        return;
                    }
                }
                if (result == "NotExists") {
                    jAlert('Record Updated Successfully !', "Information");
                    // $("#gridPayment").load('../RaisingArf/ArfPayment?id=' + 0 + '&viewfor=""');
                    $.post('../RaisingArf/Getpaymentdata',
                  function (data) {
                      var num = 0;
                      var Snumber = 0;
                      var newrow;
                      if (data == 0 || data == "") { } else {
                          if (data.length > 0) {

                              for (var gh = 0; gh < data.length ; gh++) {

                                  newrow = "<tr id='trpayment" + data[gh].creditline_gid + "'><td><label for=titlename id='" + data[gh].creditline_pay_mode + "' style='font-weight:normal;'> " + data[gh].creditline_pay_mode + " </label></td>";
                                  newrow += " <td><label for=titlename id='" + data[gh].creditline_ref_no + "' style='font-weight:normal;'> " + data[gh].creditline_ref_no + " </label></td>";
                                  newrow += " <td><label for=titlename id='" + data[gh].creditline_beneficiary + "' style='font-weight:normal;'>" + data[gh].creditline_beneficiary + "</label></td> ";
                                  newrow += " <td><label for=titlename id='" + data[gh].creditline_desc + "' style='font-weight:normal;'> " + data[gh].creditline_desc + " </label></td>";
                                  newrow += " <td><label for=titlename id='" + data[gh].creditline_amount + "' style='font-weight:normal;'> " + data[gh].creditline_amount + " </label></td>";
                                  newrow += " <td style='display:none;'><label for=titlename id='" + data[gh].ecfarf_ecf_gid + "'> " + data[gh].ecfarf_ecf_gid + " </label></td>";
                                  if (gh != 0) {
                                      newrow += " <td></a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp <a title='View' id=" + data[gh].creditline_gid + "  onclick='ViewTypepayment(this, id)'> <span class='glyphicon glyphicon-eye-open'> </span> </a> </a>&nbsp;&nbsp <a title='Edit' id=" + data[gh].creditline_gid + "  onclick='EditTypepayment(this, id)'> <span class='glyphicon glyphicon-edit'> </span> </a> </a>&nbsp;&nbsp <a title='Delete' id=" + data[gh].creditline_gid + "  onclick='DeleteTypepayment(this, id)'> <span class='glyphicon glyphicon-trash'> </span> </a> </td></tr>";
                                  }
                                  var controlToBeRemoved = "#trpayment" + data[gh].creditline_gid;

                                  $(controlToBeRemoved).remove();
                                  $('#paygrid tbody:last').append(newrow);
                                  window.parent.jQuery('#ForPartialViewpayment_pop').dialog('close');
                              }
                          }
                          GotoIndexPayment();
                      }
                  });
                }
            },
        });
    }
    function Delete() {
        var id = $("#creditline_gid").val();
        var taxModel = {
            "creditline_gid": id
        };
        jConfirm("Do you want to delete this Payment ? ", "Delete Payment", function (j) {
            if (j == true) {
                $.post('../RaisingArf/DeletePayment', taxModel,
                     function (data) {
                         if (data != "NotExists") {
                             alert(data);
                             return false;
                         }
                         else {
                             //location = '../IEM_TAX/Index';
                             // $("#gridPayment").load('../RaisingArf/ArfPayment?id=' + 0 + '&viewfor=""');
                             $.post('../RaisingArf/Getpaymentdata',
                 function (data) {
                     var num = 0;
                     var Snumber = 0;
                     var newrow;
                     if (data == 0 || data == "") {
                         var controlToBeRemoved = "#trpayment" + id;
                         $(controlToBeRemoved).remove();
                         GotoIndexPayment();
                     } else {
                         if (data.length > 0) {
                             var controlToBeRemoved = "#trpayment" + id;

                             $(controlToBeRemoved).remove();
                             for (var gh = 0; gh < data.length ; gh++) {
                                 newrow = "<tr id='trpayment" + data[gh].creditline_gid + "'><td><label for=titlename id='" + data[gh].creditline_pay_mode + "' style='font-weight:normal;'> " + data[gh].creditline_pay_mode + " </label></td>";
                                 newrow += " <td><label for=titlename id='" + data[gh].creditline_ref_no + "' style='font-weight:normal;'> " + data[gh].creditline_ref_no + " </label></td>";
                                 newrow += " <td><label for=titlename id='" + data[gh].creditline_beneficiary + "' style='font-weight:normal;'>" + data[gh].creditline_beneficiary + "</label></td> ";
                                 newrow += " <td><label for=titlename id='" + data[gh].creditline_desc + "' style='font-weight:normal;'> " + data[gh].creditline_desc + " </label></td>";
                                 newrow += " <td><label for=titlename id='" + data[gh].creditline_amount + "' style='font-weight:normal;'> " + data[gh].creditline_amount + " </label></td>";
                                 newrow += " <td style='display:none;'><label for=titlename id='" + data[gh].ecfarf_ecf_gid + "'> " + data[gh].ecfarf_ecf_gid + " </label></td>";
                                 if (gh != 0) {
                                  
                                     newrow += " <td></a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp <a title='View' id=" + data[gh].creditline_gid + "  onclick='ViewTypepayment(this, id)'> <span class='glyphicon glyphicon-eye-open'> </span> </a>&nbsp;&nbsp </a> <a title='Edit' id=" + data[gh].creditline_gid + "  onclick='EditTypepayment(this, id)'> <span class='glyphicon glyphicon-edit'> </span> </a> </a>&nbsp;&nbsp <a title='Delete' id=" + data[gh].creditline_gid + "  onclick='DeleteTypepayment(this, id)'> <span class='glyphicon glyphicon-trash'> </span> </a> </td></tr>";
                                 }
                                 var controlToBeRemoved = "#trpayment" + data[gh].creditline_gid;

                                 $(controlToBeRemoved).remove();
                                 $('#paygrid tbody:last').append(newrow);
                                 window.parent.jQuery('#ForPartialViewpayment_pop').dialog('close');
                             }
                         }
                         GotoIndexPayment();
                     }
                 });
                         }
                     }, 'json');
            }
            else { return false; }
        });
    }
    function Savepayment() {
        var creditline_gid = $('#creditline_gid').val();

        if (creditline_gid == 0) {
            var paymode_gid = $('#creditline_pay_mode').val();
            var ddlraisermode = $('#creditline_ref_no').val();
            var ddlbenific = $('#creditline_beneficiary').val();
            var _Descri = $('#_Descri').val();
            var _amount = $('#_amount').val();


            var Student = {
                "creditline_pay_mode": paymode_gid,
                "creditline_ref_no": ddlraisermode,
                "creditline_beneficiary": ddlbenific,
                "creditline_desc": _Descri,
                "creditline_amount": _amount
            };
            $.ajax({
                url: '../RaisingArf/SavePayment/',
                data: JSON.stringify(Student),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (result) {
                    if (result != "NotExists") {
                        jAlert(result, "error");

                    }
                    if (result == "NotExists") {
                        jAlert('Record Added Sucessfully !', "Information");
                        //  $("#gridPayment").load('../RaisingArf/ArfPayment?id=' + 0 + '&viewfor=""');
                        $.post('../RaisingArf/Getpaymentdata',
                  function (data) {
                      var num = 0;
                      var Snumber = 0;
                      var newrow;
                      if (data == 0 || data == "") { } else {
                          if (data.length > 0) {

                              for (var gh = 0; gh < data.length ; gh++) {
                                  var refno = data[gh].ecfarf_desc;
                                  if (refno == null) {
                                      refno = "";
                                  }
                                  newrow = "<tr id='trpayment" + data[gh].creditline_gid + "'><td><label for=titlename id='" + data[gh].creditline_pay_mode + "' style='font-weight:normal;'> " + data[gh].creditline_pay_mode + " </label></td>";
                                  newrow += " <td><label for=titlename id='" + data[gh].creditline_ref_no + "' style='font-weight:normal;'> " + data[gh].creditline_ref_no + " </label></td>";
                                  newrow += " <td><label for=titlename id='" + data[gh].creditline_beneficiary + "' style='font-weight:normal;'>" + data[gh].creditline_beneficiary + "</label></td> ";
                                  newrow += " <td><label for=titlename id='" + data[gh].creditline_desc + "' style='font-weight:normal;'> " + data[gh].creditline_desc + " </label></td>";
                                  newrow += " <td><label for=titlename id='" + data[gh].creditline_amount + "' style='font-weight:normal;'> " + data[gh].creditline_amount + " </label></td>";
                                  newrow += " <td style='display:none;'><label for=titlename id='" + data[gh].ecfarf_ecf_gid + "'> " + data[gh].ecfarf_ecf_gid + " </label></td>";
                                 
                                      newrow += " <td></a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp <a title='View' id=" + data[gh].creditline_gid + "  onclick='ViewTypepayment(this, id)'> <span class='glyphicon glyphicon-eye-open'> </span> </a> </a>&nbsp;&nbsp <a title='Edit' id=" + data[gh].creditline_gid + "  onclick='EditTypepayment(this, id)'> <span class='glyphicon glyphicon-edit'> </span> </a> </a>&nbsp;&nbsp <a title='Delete' id=" + data[gh].creditline_gid + "  onclick='DeleteTypepayment(this, id)'> <span class='glyphicon glyphicon-trash'> </span> </a> </td></tr>";
                                  
                                  var controlToBeRemoved = "#trpayment" + data[gh].creditline_gid;

                                  $(controlToBeRemoved).remove();
                                  $('#paygrid tbody:last').append(newrow);
                                  window.parent.jQuery('#ForPartialViewpayment_pop').dialog('close');
                              }
                          }
                          GotoIndexPayment();
                      }
                  });
                    }
                },
            });
        }
        else {
            var paymode_gid = $('#creditline_pay_mode').val();
            var ddlraisermode = $('#creditline_ref_no').val();
            var ddlbenific = $('#creditline_beneficiary').val();
            var _Descri = $('#_Descri').val();
            var _amount = $('#_amount').val();
            var ecfarf_ecf_gid = $('#ecfarf_ecf_gid').val();
            var creditline_gid = $('#creditline_gid').val();

            var Student = {
                "ecfarf_ecf_gid": ecfarf_ecf_gid,
                "creditline_ecf_gid": creditline_gid,
                "creditline_pay_mode": paymode_gid,
                "creditline_ref_no": ddlraisermode,
                "creditline_beneficiary": ddlbenific,
                "creditline_desc": _Descri,
                "creditline_amount": _amount
            };
            $.ajax({
                url: '../RaisingArf/updatePayment/',
                data: JSON.stringify(Student),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (result) {
                    if (result == "Exists") {
                        if (confirm("Duplicate Record !")) {
                            //InsertPouch();
                            return;
                        }
                    }
                    if (result == "NotExists") {
                        jAlert('Record Updated Successfully !', "Information");
                        // $("#gridPayment").load('../RaisingArf/ArfPayment?id=' + 0 + '&viewfor=""');
                        $.post('../RaisingArf/Getpaymentdata',
                   function (data) {
                       var num = 0;
                       var Snumber = 0;
                       var newrow;

                       if (data == 0 || data == "") { } else {
                           if (data.length > 0) {
                               for (var gh = 0; gh < data.length ; gh++) {
                                   newrow = "<tr id='trpayment" + data[gh].creditline_gid + "'><td><label for=titlename id='" + data[gh].creditline_pay_mode + "' style='font-weight:normal;'> " + data[gh].creditline_pay_mode + " </label></td>";
                                   newrow += " <td><label for=titlename id='" + data[gh].creditline_ref_no + "' style='font-weight:normal;'> " + data[gh].creditline_ref_no + " </label></td>";
                                   newrow += " <td><label for=titlename id='" + data[gh].creditline_beneficiary + "' style='font-weight:normal;'>" + data[gh].creditline_beneficiary + "</label></td> ";
                                   newrow += " <td><label for=titlename id='" + data[gh].creditline_desc + "' style='font-weight:normal;'> " + data[gh].creditline_desc + " </label></td>";
                                   newrow += " <td><label for=titlename id='" + data[gh].creditline_amount + "' style='font-weight:normal;'> " + data[gh].creditline_amount + " </label></td>";
                                   newrow += " <td style='display:none;'><label for=titlename id='" + data[gh].ecfarf_ecf_gid + "'> " + data[gh].ecfarf_ecf_gid + " </label></td>";
                                 
                                       newrow += " <td>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp<a title='View' id=" + data[gh].creditline_gid + "  onclick='ViewTypepayment(this, id)'> <span class='glyphicon glyphicon-eye-open'> </span> </a> &nbsp;&nbsp <a title='Edit' id=" + data[gh].creditline_gid + "  onclick='EditTypepayment(this, id)'> <span class='glyphicon glyphicon-edit'> </span> </a> &nbsp;&nbsp <a title='Delete' id=" + data[gh].creditline_gid + "  onclick='DeleteTypepayment(this, id)'> <span class='glyphicon glyphicon-trash'> </span> </a> </td></tr>";
                                  
                                   var controlToBeRemoved = "#trpayment" + data[gh].creditline_gid;

                                   $(controlToBeRemoved).remove();
                                   $('#paygrid tbody:last').append(newrow);
                                   window.parent.jQuery('#ForPartialViewpayment_pop').dialog('close');
                               }
                           }
                           GotoIndexPayment();
                       }
                   });
                    }
                    else {
                        jAlert(result, "Error");
                    }
                },
            });
        }
    }
</script>
