@using IEM.Helper;
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/Rmax_Site.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.24.min.js")" type="text/javascript"></script>
<style>
    table, th, td {
        white-space: nowrap;
    }
</style>
<div class="pageHeadingLayout">
    <span class="pageHeading">Cheque Despatch AWB Updation</span>
</div>
<div class="well" style="padding:10px;">
    <table class="myTableStyleTabNew" style="width:100%;">
        <tr>
            <td style="width:20%; padding:0px 10px;">
                <span>Chq Date </span>
                <br />
                <input type="text"
                       id="txtChqDate"
                       onkeypress="return isEvent(event)"
                       name="txtChqDate"
                       class="fstextbox" />
            </td>
            <td style="width:20%; padding:0px 10px;">
                <span> PV No</span>
                <br />
                <input type="text"
                       name="txtPVNo"
                       id="txtPVNo"
                       maxlength="20"
                       class="fstextbox" />
            </td>
            <td style="width:20%; padding:0px 10px;">
                <span> Payment Batch No</span>
                <br />
                <input type="text"
                       name="txtPayBatchNo"
                       id="txtPayBatchNo"
                       maxlength="15"
                       class="fstextbox" />
            </td>
            <td style="width:20%; padding:0px 10px;">
                <span>Payment Date </span>
                <br />
                <input type="text"
                       id="txtPayDate"
                       onkeypress="return isEvent(event)"
                       name="txtPayDate"
                       class="fstextbox" />
            </td>
            <td style="padding:0px 10px;">
                <span> Courier Name</span>
                <br />
                <input type="hidden" name="hdfCourierId1" id="hdfCourierId1" value="" />
                <input type="text"
                       id="txtCourierName1"
                       name="txtCourierName1"
                       class="fstextbox" />
            </td>
        </tr>
        <tr>

            <td style="padding:0px 10px;">
                <span>Location</span>
                <br />
                <input type="hidden" name="hdfBranchId" id="hdfBranchId" value="0" />
                <input type="text"
                       id="txtBranch"
                       name="txtBranch"
                       class="fstextbox" />
            </td>
            <td style="padding:0px 10px;">
                <span> Raiser Branch</span>
                <br />
                <input type="hidden" name="hdfRaiserBranchId" id="hdfRaiserBranchId" value="0" />
                <input type="text"
                       id="txtRaiserBranch"
                       name="txtRaiserBranch"
                       class="fstextbox" />
            </td>
            <td colspan="3" style="padding:0px 10px; vertical-align:bottom; text-align:right;">
                <button class="btn btn-primary" accesskey="q" id="btnsearch" data-bind="click: $root.search" style="margin-top:10px;  color:white;">
                    <span style="color:white; font-size:12px;" class="glyphicon glyphicon-search"></span>
                    Search
                </button>
                <button class="btn btn-warning" accesskey="c" data-bind="click: $root.ClearSearch" style="margin-top:10px;  color:white;">
                    <span style="color:white; font-size:12px;" class="glyphicon glyphicon-refresh"></span>
                    Clear
                </button>
                <button class="btn btn-success" accesskey="x" id="btnSaveXLBulk" type="button" data-bind="click: function() { $root.XlUpdate(); }" style="margin-top:10px;  color:white;">
                    <span style="color:white;" class="glyphicon glyphicon-open"></span>
                    XL Bulk Update
                </button>
            </td>
        </tr>
    </table>

    <div style="width:100%; padding:20px 10px 5px;">
        <div style="width:100%; border-bottom: 1px solid #ccc;">

        </div>
    </div>

    <table class="myTableStyleTabNew" style="width:100%;" data-bind="visible: ChqDespatchAwbUpdArray().length > 0">
        <tr>
            <td style="width:20%; padding:0px 10px;">
                <span>Despatch Date </span>
                <br />
                <input type="text"
                       id="txtDespatchDate"
                       onkeypress="return isEvent(event)"
                       name="txtDespatchDate"
                       class="fstextbox required " />
            </td>
            <td style="width:20%; padding:0px 10px;">
                <span> Courier Name</span>
                <br />
                <input type="hidden" name="hdfCourierId" id="hdfCourierId" value="" />
                <input type="text"
                       id="txtCourierName"
                       name="txtCourierName"
                       class="fstextbox required" />
            </td>
            <td style="width:20%; padding:0px 10px;">
                <span> AWB No</span>
                <br />
                <input type="text"
                       name="txtAWBNo"
                       id="txtAWBNo"
                       maxlength="20"
                       class="fstextbox required" />
            </td>

            <td style="width:40%; padding:0px 10px; vertical-align:bottom; text-align:right;" colspan="2">
                <button class="btn btn-primary" accesskey="d" id="btnDefaultvalue" data-bind="click: $root.searchDefaultvalue" style="margin-top:10px;  color:white; display:none;">
                    <span style="color:white; font-size:12px;" class="glyphicon glyphicon-upload"></span>
                    Default Value
                </button>
                <button class="btn btn-primary" accesskey="c" data-bind="click: $root.ClearSearch1" style="margin-top:10px;  color:white; display:none;">
                    <span style="color:white; font-size:12px;" class="glyphicon glyphicon-refresh"></span>
                    Clear
                </button>



                <button class="btn btn-primary" accesskey="s" id="btnSaveUpdate" data-bind="click: $root.Update" type="button" style="margin-top:10px;  color:white;">
                    <span style="color:white;" class="glyphicon glyphicon-upload"></span>
                    Update
                </button>
                <button class="btn btn-warning" accesskey="c" id="btnSaveCancel" type="button" data-bind="click: $root.Cancel" style="margin-top:10px;  color:white;">
                    <span style="color:white;" class="glyphicon glyphicon-remove"></span>
                    Cancel
                </button>
                <button data-bind="click: function() { $root.DownloadTemplate(); }" accesskey="e" class="btn btn-success" id="btnExporExcel" @*onclick="fnExcelExport();"*@ style="margin-top:10px;  color:white;">
                    <span style="color:white; font-size:12px;" class="glyphicon glyphicon-export"></span>
                    Export to Excel
                </button>
            </td>


        </tr>
    </table>
    <div style="width:100%; padding: 0px 10px;">
        <div style="width:100%; overflow:auto; margin-top: 15px;">
            <table class="tableSmall table-bordered table-hover table-responsive" id="gvChequeDespathAWBUpdation" data-bind="visible: ChqDespatchAwbUpdArray().length > 0">
                <thead>
                    <tr>
                        <th style="width:5%; min-width:40px; padding-right: 15px;">
                            SlNo
                        </th>
                        <th style="width:7%; min-width:100px; padding-right: 15px;">
                            PV No
                        </th>
                        <th style="width:8%; min-width:100px; padding-right: 15px;" class="colDate">
                            PV Date
                        </th>
                        <th style="width:4%; min-width:50px; padding-right: 15px;">
                            PV Amount
                        </th>
                        <th style="width:5%; min-width:50px; padding-right: 15px;">
                            Payment Batch No
                        </th>
                        <th style="width:9%; min-width:50px; padding-right: 15px;">
                            Beneficiary Name
                        </th>
                        <th style="width:8%; min-width:50px; padding-right: 15px;">
                            Chq No
                        </th>
                        <th style="width:6%; min-width:50px; padding-right: 15px;" class="colDate">
                            Chq Date
                        </th>
                        <th style="width:5%; min-width:50px; padding-right: 15px;">
                            Chq Amount
                        </th>
                        <th style="width:4%; min-width:50px; padding-right: 15px;">
                            Location
                        </th>
                        <th style="width:9%; min-width:50px; padding-right: 15px;" class="colDate">
                            Despatch Date
                        </th>
                        <th style="width:10%; min-width:50px; padding-right: 15px;">
                            Courier Name
                        </th>
                        <th style="width:6%; min-width:50px; padding-right: 15px;">
                            AWB No
                        </th>
                        <th style="width:6%; min-width:50px; padding-right: 15px;" class="nosort">
                            Select
                            <input type="checkbox" id="chkHSelete">
                        </th>
                    </tr>
                </thead>

                <tbody id="contentChequePrinting" data-bind="foreach:{ data: ChqDespatchAwbUpdArray, afterRender: DatatableCall }, visible: ChqDespatchAwbUpdArray().length > 0">
                    <tr>
                        <td align="center">
                            <span data-bind="text: SlNo"></span>
                        </td>
                        <td>
                            <span data-bind="text: PvNo"></span>
                        </td>
                        <td align="center">
                            <span data-bind="text:PvDate"></span>
                        </td>
                        <td align="right">
                            <span data-bind="text: $root.formatNumber(PvAmount)"></span>
                        </td>
                        <td>
                            <span data-bind="text:PaymentBatchNo"></span>
                        </td>
                        <td>
                            <span data-bind="text: BeneficiaryName"></span>
                        </td>
                        <td>
                            <span data-bind="text: ChqNo"></span>
                        </td>
                        <td align="center">
                            <span data-bind="text: ChqDate"></span>
                        </td>
                        <td align="right">
                            <span data-bind="text: $root.formatNumber(ChqAmount)"></span>
                        </td>
                        <td>
                            <span data-bind="text: Location"></span>
                        </td>
                        <td align="center">
                            <span data-bind="text:DespatchDate"></span>
                        </td>
                        <td>
                            <span data-bind="text:CourierName"></span>
                        </td>
                        <td>
                            <span data-bind="text:AwbNo"></span>
                        </td>
                        <td style="width:8%; min-width:100px; text-align:center;">
                            <input type="checkbox" data-bind="attr: { name: 'chk_'+ PvNo, id: 'chk_'+ PvNo }, event:{ change:$root.checkChange }" />
                        </td>
                    </tr>
                </tbody>
                <tfoot data-bind="visible: ChqDespatchAwbUpdArray().length > 0">
                    <tr>
                        <th colspan="14" style="width:100%; padding-left:10px;">
                            <span style="font-weight: normal;">Total No.Of Documents:</span><label id="lblTotalCount" style="padding-left:3px;">0</label>
                        </th>
                    </tr>
                </tfoot>
            </table>
            <table class="tableSmall table-bordered table-hover table-responsive" id="gvChequeDespathAWBUpdationExcel" data-bind="visible:false">
                <thead>
                    <tr>
                        <th style="width:5%; min-width:40px;">
                            SlNo
                        </th>
                        <th style="width:10%; min-width:100px;">
                            PV No
                        </th>
                        <th style="width:9%; min-width:100px;" class="colDate">
                            PV Date
                        </th>
                        <th style="width:5%; min-width:50px;">
                            PV Amount
                        </th>
                        <th style="width:6%; min-width:50px;">
                            Payment Batch No
                        </th>
                        <th style="width:10%; min-width:50px;">
                            Beneficiary Name
                        </th>
                        <th style="width:9%; min-width:50px;" class="colDate">
                            ChqDate
                        </th>
                        <th style="width:5%; min-width:50px;">
                            Chq Amount
                        </th>
                        <th style="width:9%; min-width:50px;" class="colDate">
                            Despatch Date
                        </th>
                        <th style="width:10%; min-width:50px;">
                            Courier Name
                        </th>
                        <th style="width:6%; min-width:50px;">
                            AWB No
                        </th>
                    </tr>
                </thead>
                <tbody id="contentChequePrinting" data-bind="foreach:{ data: ChqDespatchAwbUpdArray }, visible: false">
                    <tr>
                        <td align="center">
                            <span data-bind="text: SlNo"></span>
                        </td>
                        <td>
                            <span data-bind="text: PvNo"></span>
                        </td>
                        <td>
                            <span data-bind="text:PvDate"></span>
                        </td>
                        <td>
                            <span data-bind="text: PvAmount"></span>
                        </td>
                        <td>
                            <span data-bind="text:PaymentBatchNo"></span>
                        </td>
                        <td>
                            <span data-bind="text: BeneficiaryName"></span>
                        </td>
                        <td>
                            <span data-bind="text: ChqDate"></span>
                        </td>
                        <td>
                            <span data-bind="text: ChqAmount"></span>
                        </td>
                        <td>
                            <span data-bind="text:DespatchDate"></span>
                        </td>
                        <td>
                            <span data-bind="text:CourierName"></span>
                        </td>
                        <td>
                            <span data-bind="text:AwbNo"></span>
                        </td>

                    </tr>
                </tbody>
            </table>

            <iframe id="txtArea1" style="display:none;"></iframe>
        </div>
        @*<table class="myTableStyleTabNew" style="width:100%;">
                <tr>
                    <td width="20%" style="padding: 0px 10px;"></td>
                    <td width="20%" style="padding: 0px 10px 0px 3px;"></td>
                    <td width="20%" style="padding: 0px 10px"></td>
                    <td width="20%" style="padding: 0px 10px;text-align:right;"></td>
                    <td style="width:20%; padding:0px; vertical-align:bottom;">

                        <table class="myTableStyleTabNew" style="width:100%;" data-bind="visible: ChqDespatchAwbUpdArray().length > 0">
                            <tr>
                                <td>

                                    <div style="width:20%; padding:0px; vertical-align:bottom;">
                                        <button class="btn btn-primary" id="btnExporExcel" onclick="fnExcelExport();" style="margin-top:10px;  color:white;">
                                            <span style="color:white; font-size:12px;" class="glyphicon glyphicon-export"></span>
                                            Export to Excel
                                        </button>

                                        <button class="btn btn-success" id="btnSaveUpdate" data-bind="click: $root.Update" type="button" style="margin-top:10px;  color:white;">
                                            <span style="color:white;" class="glyphicon glyphicon-upload"></span>
                                            Update
                                        </button>
                                        <button class="btn btn-warning" id="btnSaveCancel" type="button" data-bind="click: $root.Cancel" style="margin-top:10px;  color:white;">
                                            <span style="color:white;" class="glyphicon glyphicon-remove"></span>
                                            Cancel
                                        </button>
                                    </div>

                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>*@
    </div>
</div>


<div style="display:none" id="AddShowDialog">
    <table class="myTableStyleTabNew tblstyles" style="width:100%;">
        <tr>
            <td style="width:40%; padding:0px 5px;">
                <span>FileName</span>
                <br />
                <form id="uploaderForm">
                    <input type="file" style="width: 95%;padding-top: 5px;" id="attUploader" class="attUploader" name="UploadFile" />
                </form>
            </td>
            <td style="width:25%; padding:0px 5px; text-align:center;">
                <br />
                <button type="button" id="btnSubmitUpload" class="btn btn-primary" accesskey="u" data-bind="click: $root.Xlupload">
                    <span class="glyphicon glyphicon-upload" style="color:white;"></span>
                    Upload
                </button>
                <button type="button" class="btn btn-primary" value="Cancel" accesskey="c" id="clear" data-bind="click: $root.ClearSearchExcel" >
                    <span class=" glyphicon glyphicon-refresh" style="color:white;">
                    </span>
                    Clear
                </button>
            </td>
            <td style="width:35%; padding:0px 5px; text-align:center;"></td>
        </tr>
    </table>

    <div style="width:100%; overflow:auto; margin-top: 15px;">
        <table class="tableSmall table-bordered table-hover table-responsive" id="gvXLBulkUpdate" data-bind="visible: ChqDespatchAwbXLArray().length > 0">
            <thead>
                <tr>
                    <th style="width:3%; min-width:40px;" class="nosort">
                        SlNo
                    </th>

                    <th style="width:10%; min-width:100px;" class="nosort">
                        PV No
                    </th>
                    <th style="width:9%; min-width:50px;" class="nosort">
                        Pv Date
                    </th>
                    <th style="width:10%; min-width:50px;" class="nosort">
                        PV Amount
                    </th>
                    <th style="width:10%; min-width:50px;" class="nosort">
                        Payment BatchNo
                    </th>

                    <th style="width:10%; min-width:50px;" class="nosort">
                        Beneficiary Name
                    </th>
                    <th style="width:9%; min-width:50px;" class="nosort">
                        Chq Date
                    </th>
                    <th style="width:10%; min-width:50px;" class="nosort">
                        Chq Amount
                    </th>
                    <th style="width:9%; min-width:50px;" class="nosort">
                        Despatch Date
                    </th>
                    <th style="width:10%; min-width:50px;" class="nosort">
                        Courier Name
                    </th>
                    <th style="width:10%; min-width:50px;" class="nosort">
                        AWB No
                    </th>
                </tr>
            </thead>
            <tbody id="contentChequePrinting" data-bind="foreach:{ data: ChqDespatchAwbXLArray, afterRender: DatatableCallExcel }, visible: ChqDespatchAwbXLArray().length > 0">
                <tr>
                    <td align="center">
                        <span data-bind="text: SlNo"></span>
                    </td>
                    <td>
                        <span data-bind="text: PvNo"></span>
                    </td>
                    <td>
                        <span data-bind="text:PvDate"></span>
                    </td>
                    <td>
                        <span data-bind="text:PvAmount"></span>
                    </td>
                    <td>
                        <span data-bind="text:PaymentBatchNo"></span>
                    </td>
                    <td>
                        <span data-bind="text:BeneficiaryName"></span>
                    </td>
                    <td>
                        <span data-bind="text:ChqDate"></span>
                    </td>
                    <td>
                        <span data-bind="text:ChqAmount"></span>
                    </td>
                    <td>
                        <span data-bind="text:DespatchDate"></span>
                    </td>
                    <td>
                        <span data-bind="text:CourierName"></span>
                    </td>
                    <td>
                        <span data-bind="text:AwbNo"></span>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    var UrlDet = "@Url.Action("GetChequeDespatchAwbUpdation", "ChqDespatchAWBUpdation")"
    var UrlHelper = "@Url.Action("GetAutoCompleteCourier", "Helper")"
   
    //function ClearSearchExcel() {
    //    $("#attUploader").val("");
    //    $("#attUploader").val('');
    //    var control = $("#attUploader"),
    //        clearBn = $("#clear");
    //    control.replaceWith(control.val('').clone(true));
    //    $("#gvChequeDespathAWBUpdation").DataTable({
    //        "autoWidth": false,
    //        "destroy": true,
    //        "bFilter": false,
    //        "bLengthChange": false,
    //        "bPaginate": false,
    //        "bInfo": false
    //    }).destroy();
    //}
</script>

<script src="@Url.Content("~/Areas/FLEXISPEND/FS_UserScript/jsChqDespatchAwbUpdation.js")" type="text/javascript"></script>
